(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory);}else{factory(jQuery);}}(function($){$.ui=$.ui||{};$.extend($.ui,{version:"@VERSION",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});$.fn.extend({scrollParent:function(includeHidden){var position=this.css("position"),excludeStaticParent=position==="absolute",overflowRegex=includeHidden?/(auto|scroll|hidden)/:/(auto|scroll)/,scrollParent=this.parents().filter(function(){var parent=$(this);if(excludeStaticParent&&parent.css("position")==="static"){return false;}
return overflowRegex.test(parent.css("overflow")+parent.css("overflow-y")+parent.css("overflow-x"));}).eq(0);return position==="fixed"||!scrollParent.length?$(this[0].ownerDocument||document):scrollParent;},uniqueId:(function(){var uuid=0;return function(){return this.each(function(){if(!this.id){this.id="ui-id-"+(++uuid);}});};})(),removeUniqueId:function(){return this.each(function(){if(/^ui-id-\d+$/.test(this.id)){$(this).removeAttr("id");}});}});function focusable(element,isTabIndexNotNaN){var map,mapName,img,nodeName=element.nodeName.toLowerCase();if("area"===nodeName){map=element.parentNode;mapName=map.name;if(!element.href||!mapName||map.nodeName.toLowerCase()!=="map"){return false;}
img=$("img[usemap='#"+mapName+"']")[0];return!!img&&visible(img);}
return(/input|select|textarea|button|object/.test(nodeName)?!element.disabled:"a"===nodeName?element.href||isTabIndexNotNaN:isTabIndexNotNaN)&&visible(element);}
function visible(element){return $.expr.filters.visible(element)&&!$(element).parents().addBack().filter(function(){return $.css(this,"visibility")==="hidden";}).length;}
$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName);};}):function(elem,i,match){return!!$.data(elem,match[3]);},focusable:function(element){return focusable(element,!isNaN($.attr(element,"tabindex")));},tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),isTabIndexNaN=isNaN(tabIndex);return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN);}});if(!$("<a>").outerWidth(1).jquery){$.each(["Width","Height"],function(i,name){var side=name==="Width"?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};function reduce(elem,size,border,margin){$.each(side,function(){size-=parseFloat($.css(elem,"padding"+this))||0;if(border){size-=parseFloat($.css(elem,"border"+this+"Width"))||0;}
if(margin){size-=parseFloat($.css(elem,"margin"+this))||0;}});return size;}
$.fn["inner"+name]=function(size){if(size===undefined){return orig["inner"+name].call(this);}
return this.each(function(){$(this).css(type,reduce(this,size)+"px");});};$.fn["outer"+name]=function(size,margin){if(typeof size!=="number"){return orig["outer"+name].call(this,size);}
return this.each(function(){$(this).css(type,reduce(this,size,true,margin)+"px");});};});}
if(!$.fn.addBack){$.fn.addBack=function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector));};}
if($("<a>").data("a-b","a").removeData("a-b").data("a-b")){$.fn.removeData=(function(removeData){return function(key){if(arguments.length){return removeData.call(this,$.camelCase(key));}else{return removeData.call(this);}};})($.fn.removeData);}
$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());$.fn.extend({focus:(function(orig){return function(delay,fn){return typeof delay==="number"?this.each(function(){var elem=this;setTimeout(function(){$(elem).focus();if(fn){fn.call(elem);}},delay);}):orig.apply(this,arguments);};})($.fn.focus),disableSelection:(function(){var eventType="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(eventType+".ui-disableSelection",function(event){event.preventDefault();});};})(),enableSelection:function(){return this.unbind(".ui-disableSelection");},zIndex:function(zIndex){if(zIndex!==undefined){return this.css("zIndex",zIndex);}
if(this.length){var elem=$(this[0]),position,value;while(elem.length&&elem[0]!==document){position=elem.css("position");if(position==="absolute"||position==="relative"||position==="fixed"){value=parseInt(elem.css("zIndex"),10);if(!isNaN(value)&&value!==0){return value;}}
elem=elem.parent();}}
return 0;}});$.ui.plugin={add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set){proto.plugins[i]=proto.plugins[i]||[];proto.plugins[i].push([option,set[i]]);}},call:function(instance,name,args,allowDisconnected){var i,set=instance.plugins[name];if(!set){return;}
if(!allowDisconnected&&(!instance.element[0].parentNode||instance.element[0].parentNode.nodeType===11)){return;}
for(i=0;i<set.length;i++){if(instance.options[set[i][0]]){set[i][1].apply(instance.element,args);}}}};}));(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory);}else{factory(jQuery);}}(function($){var widget_uuid=0,widget_slice=Array.prototype.slice;$.cleanData=(function(orig){return function(elems){var events,elem,i;for(i=0;(elem=elems[i])!=null;i++){try{events=$._data(elem,"events");if(events&&events.remove){$(elem).triggerHandler("remove");}}catch(e){}}
orig(elems);};})($.cleanData);$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1];fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget;}
$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName);};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget){return new constructor(options,element);}
if(arguments.length){this._createWidget(options,element);}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base();basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return;}
proxiedPrototype[prop]=(function(){var _super=function(){return base.prototype[prop].apply(this,arguments);},_superApply=function(args){return base.prototype[prop].apply(this,args);};return function(){var __super=this._super,__superApply=this._superApply,returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue;};})();});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?(basePrototype.widgetEventPrefix||name):name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto);});delete existingConstructor._childConstructors;}else{base._childConstructors.push(constructor);}
$.widget.bridge(name,constructor);return constructor;};$.widget.extend=function(target){var input=widget_slice.call(arguments,1),inputIndex=0,inputLength=input.length,key,value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value);}else{target[key]=value;}}}}
return target;};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options==="string",args=widget_slice.call(arguments,1),returnValue=this;options=!isMethodCall&&args.length?$.widget.extend.apply(null,[options].concat(args)):options;if(isMethodCall){this.each(function(){var methodValue,instance=$.data(this,fullName);if(options==="instance"){returnValue=instance;return false;}
if(!instance){return $.error("cannot call methods on "+name+" prior to initialization; "+"attempted to call method '"+options+"'");}
if(!$.isFunction(instance[options])||options.charAt(0)==="_"){return $.error("no such method '"+options+"' for "+name+" widget instance");}
methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false;}});}else{this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{});if(instance._init){instance._init();}}else{$.data(this,fullName,new object(options,this));}});}
return returnValue;};};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=widget_uuid++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=$();this.hoverable=$();this.focusable=$();if(element!==this){$.data(element,this.widgetFullName,this);this._on(true,this.element,{remove:function(event){if(event.target===element){this.destroy();}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow);}
this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this._create();this._trigger("create",null,this._getCreateEventData());this._init();},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus");},_destroy:$.noop,widget:function(){return this.element;},option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.widget.extend({},this.options);}
if(typeof key==="string"){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]];}
key=parts.pop();if(arguments.length===1){return curOption[key]===undefined?null:curOption[key];}
curOption[key]=value;}else{if(arguments.length===1){return this.options[key]===undefined?null:this.options[key];}
options[key]=value;}}
this._setOptions(options);return this;},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key]);}
return this;},_setOption:function(key,value){this.options[key]=value;if(key==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled",!!value);if(value){this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus");}}
return this;},enable:function(){return this._setOptions({disabled:false});},disable:function(){return this._setOptions({disabled:true});},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;if(typeof suppressDisabledCheck!=="boolean"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=false;}
if(!handlers){handlers=element;element=this.element;delegateElement=this.widget();}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element);}
$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===true||$(this).hasClass("ui-state-disabled"))){return;}
return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
if(typeof handler!=="string"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++;}
var match=event.match(/^([\w:-]*)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];if(selector){delegateElement.delegate(selector,eventName,handlerProxy);}else{element.bind(eventName,handlerProxy);}});},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+
this.eventNamespace;element.unbind(eventName).undelegate(eventName);this.bindings=$(this.bindings.not(element).get());this.focusable=$(this.focusable.not(element).get());this.hoverable=$(this.hoverable.not(element).get());},_delay:function(handler,delay){function handlerProxy(){return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
var instance=this;return setTimeout(handlerProxy,delay||0);},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover");},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover");}});},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus");},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus");}});},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop];}}}
this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===false||event.isDefaultPrevented());}};$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){if(typeof options==="string"){options={effect:options};}
var hasOptions,effectName=!options?method:options===true||typeof options==="number"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options==="number"){options={duration:options};}
hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay);}
if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options);}else if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback);}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0]);}
next();});}};});return $.widget;}));(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory);}else{factory(jQuery);}}(function($){(function(){$.ui=$.ui||{};var cachedScrollbarWidth,supportsOffsetFractions,max=Math.max,abs=Math.abs,round=Math.round,rhorizontal=/left|center|right/,rvertical=/top|center|bottom/,roffset=/[\+\-]\d+(\.[\d]+)?%?/,rposition=/^\w+/,rpercent=/%$/,_position=$.fn.position;function getOffsets(offsets,width,height){return[parseFloat(offsets[0])*(rpercent.test(offsets[0])?width/100:1),parseFloat(offsets[1])*(rpercent.test(offsets[1])?height/100:1)];}
function parseCss(element,property){return parseInt($.css(element,property),10)||0;}
function getDimensions(elem){var raw=elem[0];if(raw.nodeType===9){return{width:elem.width(),height:elem.height(),offset:{top:0,left:0}};}
if($.isWindow(raw)){return{width:elem.width(),height:elem.height(),offset:{top:elem.scrollTop(),left:elem.scrollLeft()}};}
if(raw.preventDefault){return{width:0,height:0,offset:{top:raw.pageY,left:raw.pageX}};}
return{width:elem.outerWidth(),height:elem.outerHeight(),offset:elem.offset()};}
$.position={scrollbarWidth:function(){if(cachedScrollbarWidth!==undefined){return cachedScrollbarWidth;}
var w1,w2,div=$("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),innerDiv=div.children()[0];$("body").append(div);w1=innerDiv.offsetWidth;div.css("overflow","scroll");w2=innerDiv.offsetWidth;if(w1===w2){w2=div[0].clientWidth;}
div.remove();return(cachedScrollbarWidth=w1-w2);},getScrollInfo:function(within){var overflowX=within.isWindow||within.isDocument?"":within.element.css("overflow-x"),overflowY=within.isWindow||within.isDocument?"":within.element.css("overflow-y"),hasOverflowX=overflowX==="scroll"||(overflowX==="auto"&&within.width<within.element[0].scrollWidth),hasOverflowY=overflowY==="scroll"||(overflowY==="auto"&&within.height<within.element[0].scrollHeight);return{width:hasOverflowY?$.position.scrollbarWidth():0,height:hasOverflowX?$.position.scrollbarWidth():0};},getWithinInfo:function(element){var withinElement=$(element||window),isWindow=$.isWindow(withinElement[0]),isDocument=!!withinElement[0]&&withinElement[0].nodeType===9;return{element:withinElement,isWindow:isWindow,isDocument:isDocument,offset:withinElement.offset()||{left:0,top:0},scrollLeft:withinElement.scrollLeft(),scrollTop:withinElement.scrollTop(),width:isWindow||isDocument?withinElement.width():withinElement.outerWidth(),height:isWindow||isDocument?withinElement.height():withinElement.outerHeight()};}};$.fn.position=function(options){if(!options||!options.of){return _position.apply(this,arguments);}
options=$.extend({},options);var atOffset,targetWidth,targetHeight,targetOffset,basePosition,dimensions,target=$(options.of),within=$.position.getWithinInfo(options.within),scrollInfo=$.position.getScrollInfo(within),collision=(options.collision||"flip").split(" "),offsets={};dimensions=getDimensions(target);if(target[0].preventDefault){options.at="left top";}
targetWidth=dimensions.width;targetHeight=dimensions.height;targetOffset=dimensions.offset;basePosition=$.extend({},targetOffset);$.each(["my","at"],function(){var pos=(options[this]||"").split(" "),horizontalOffset,verticalOffset;if(pos.length===1){pos=rhorizontal.test(pos[0])?pos.concat(["center"]):rvertical.test(pos[0])?["center"].concat(pos):["center","center"];}
pos[0]=rhorizontal.test(pos[0])?pos[0]:"center";pos[1]=rvertical.test(pos[1])?pos[1]:"center";horizontalOffset=roffset.exec(pos[0]);verticalOffset=roffset.exec(pos[1]);offsets[this]=[horizontalOffset?horizontalOffset[0]:0,verticalOffset?verticalOffset[0]:0];options[this]=[rposition.exec(pos[0])[0],rposition.exec(pos[1])[0]];});if(collision.length===1){collision[1]=collision[0];}
if(options.at[0]==="right"){basePosition.left+=targetWidth;}else if(options.at[0]==="center"){basePosition.left+=targetWidth/2;}
if(options.at[1]==="bottom"){basePosition.top+=targetHeight;}else if(options.at[1]==="center"){basePosition.top+=targetHeight/2;}
atOffset=getOffsets(offsets.at,targetWidth,targetHeight);basePosition.left+=atOffset[0];basePosition.top+=atOffset[1];return this.each(function(){var collisionPosition,using,elem=$(this),elemWidth=elem.outerWidth(),elemHeight=elem.outerHeight(),marginLeft=parseCss(this,"marginLeft"),marginTop=parseCss(this,"marginTop"),collisionWidth=elemWidth+marginLeft+parseCss(this,"marginRight")+scrollInfo.width,collisionHeight=elemHeight+marginTop+parseCss(this,"marginBottom")+scrollInfo.height,position=$.extend({},basePosition),myOffset=getOffsets(offsets.my,elem.outerWidth(),elem.outerHeight());if(options.my[0]==="right"){position.left-=elemWidth;}else if(options.my[0]==="center"){position.left-=elemWidth/2;}
if(options.my[1]==="bottom"){position.top-=elemHeight;}else if(options.my[1]==="center"){position.top-=elemHeight/2;}
position.left+=myOffset[0];position.top+=myOffset[1];if(!supportsOffsetFractions){position.left=round(position.left);position.top=round(position.top);}
collisionPosition={marginLeft:marginLeft,marginTop:marginTop};$.each(["left","top"],function(i,dir){if($.ui.position[collision[i]]){$.ui.position[collision[i]][dir](position,{targetWidth:targetWidth,targetHeight:targetHeight,elemWidth:elemWidth,elemHeight:elemHeight,collisionPosition:collisionPosition,collisionWidth:collisionWidth,collisionHeight:collisionHeight,offset:[atOffset[0]+myOffset[0],atOffset[1]+myOffset[1]],my:options.my,at:options.at,within:within,elem:elem});}});if(options.using){using=function(props){var left=targetOffset.left-position.left,right=left+targetWidth-elemWidth,top=targetOffset.top-position.top,bottom=top+targetHeight-elemHeight,feedback={target:{element:target,left:targetOffset.left,top:targetOffset.top,width:targetWidth,height:targetHeight},element:{element:elem,left:position.left,top:position.top,width:elemWidth,height:elemHeight},horizontal:right<0?"left":left>0?"right":"center",vertical:bottom<0?"top":top>0?"bottom":"middle"};if(targetWidth<elemWidth&&abs(left+right)<targetWidth){feedback.horizontal="center";}
if(targetHeight<elemHeight&&abs(top+bottom)<targetHeight){feedback.vertical="middle";}
if(max(abs(left),abs(right))>max(abs(top),abs(bottom))){feedback.important="horizontal";}else{feedback.important="vertical";}
options.using.call(this,props,feedback);};}
elem.offset($.extend(position,{using:using}));});};$.ui.position={fit:{left:function(position,data){var within=data.within,withinOffset=within.isWindow?within.scrollLeft:within.offset.left,outerWidth=within.width,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=withinOffset-collisionPosLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-withinOffset,newOverRight;if(data.collisionWidth>outerWidth){if(overLeft>0&&overRight<=0){newOverRight=position.left+overLeft+data.collisionWidth-outerWidth-withinOffset;position.left+=overLeft-newOverRight;}else if(overRight>0&&overLeft<=0){position.left=withinOffset;}else{if(overLeft>overRight){position.left=withinOffset+outerWidth-data.collisionWidth;}else{position.left=withinOffset;}}}else if(overLeft>0){position.left+=overLeft;}else if(overRight>0){position.left-=overRight;}else{position.left=max(position.left-collisionPosLeft,position.left);}},top:function(position,data){var within=data.within,withinOffset=within.isWindow?within.scrollTop:within.offset.top,outerHeight=data.within.height,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=withinOffset-collisionPosTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-withinOffset,newOverBottom;if(data.collisionHeight>outerHeight){if(overTop>0&&overBottom<=0){newOverBottom=position.top+overTop+data.collisionHeight-outerHeight-withinOffset;position.top+=overTop-newOverBottom;}else if(overBottom>0&&overTop<=0){position.top=withinOffset;}else{if(overTop>overBottom){position.top=withinOffset+outerHeight-data.collisionHeight;}else{position.top=withinOffset;}}}else if(overTop>0){position.top+=overTop;}else if(overBottom>0){position.top-=overBottom;}else{position.top=max(position.top-collisionPosTop,position.top);}}},flip:{left:function(position,data){var within=data.within,withinOffset=within.offset.left+within.scrollLeft,outerWidth=within.width,offsetLeft=within.isWindow?within.scrollLeft:within.offset.left,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=collisionPosLeft-offsetLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-offsetLeft,myOffset=data.my[0]==="left"?-data.elemWidth:data.my[0]==="right"?data.elemWidth:0,atOffset=data.at[0]==="left"?data.targetWidth:data.at[0]==="right"?-data.targetWidth:0,offset=-2*data.offset[0],newOverRight,newOverLeft;if(overLeft<0){newOverRight=position.left+myOffset+atOffset+offset+data.collisionWidth-outerWidth-withinOffset;if(newOverRight<0||newOverRight<abs(overLeft)){position.left+=myOffset+atOffset+offset;}}else if(overRight>0){newOverLeft=position.left-data.collisionPosition.marginLeft+myOffset+atOffset+offset-offsetLeft;if(newOverLeft>0||abs(newOverLeft)<overRight){position.left+=myOffset+atOffset+offset;}}},top:function(position,data){var within=data.within,withinOffset=within.offset.top+within.scrollTop,outerHeight=within.height,offsetTop=within.isWindow?within.scrollTop:within.offset.top,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=collisionPosTop-offsetTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-offsetTop,top=data.my[1]==="top",myOffset=top?-data.elemHeight:data.my[1]==="bottom"?data.elemHeight:0,atOffset=data.at[1]==="top"?data.targetHeight:data.at[1]==="bottom"?-data.targetHeight:0,offset=-2*data.offset[1],newOverTop,newOverBottom;if(overTop<0){newOverBottom=position.top+myOffset+atOffset+offset+data.collisionHeight-outerHeight-withinOffset;if((position.top+myOffset+atOffset+offset)>overTop&&(newOverBottom<0||newOverBottom<abs(overTop))){position.top+=myOffset+atOffset+offset;}}else if(overBottom>0){newOverTop=position.top-data.collisionPosition.marginTop+myOffset+atOffset+offset-offsetTop;if((position.top+myOffset+atOffset+offset)>overBottom&&(newOverTop>0||abs(newOverTop)<overBottom)){position.top+=myOffset+atOffset+offset;}}}},flipfit:{left:function(){$.ui.position.flip.left.apply(this,arguments);$.ui.position.fit.left.apply(this,arguments);},top:function(){$.ui.position.flip.top.apply(this,arguments);$.ui.position.fit.top.apply(this,arguments);}}};(function(){var testElement,testElementParent,testElementStyle,offsetLeft,i,body=document.getElementsByTagName("body")[0],div=document.createElement("div");testElement=document.createElement(body?"div":"body");testElementStyle={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(body){$.extend(testElementStyle,{position:"absolute",left:"-1000px",top:"-1000px"});}
for(i in testElementStyle){testElement.style[i]=testElementStyle[i];}
testElement.appendChild(div);testElementParent=body||document.documentElement;testElementParent.insertBefore(testElement,testElementParent.firstChild);div.style.cssText="position: absolute; left: 10.7432222px;";offsetLeft=$(div).offset().left;supportsOffsetFractions=offsetLeft>10&&offsetLeft<11;testElement.innerHTML="";testElementParent.removeChild(testElement);})();})();return $.ui.position;}));(function(factory){if(typeof define==="function"&&define.amd){define(["jquery","./widget"],factory);}else{factory(jQuery);}}(function($){var mouseHandled=false;$(document).mouseup(function(){mouseHandled=false;});return $.widget("ui.mouse",{version:"@VERSION",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.bind("mousedown."+this.widgetName,function(event){return that._mouseDown(event);}).bind("click."+this.widgetName,function(event){if(true===$.data(event.target,that.widgetName+".preventClickEvent")){$.removeData(event.target,that.widgetName+".preventClickEvent");event.stopImmediatePropagation();return false;}});this.started=false;},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);if(this._mouseMoveDelegate){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);}},_mouseDown:function(event){if(mouseHandled){return;}
this._mouseMoved=false;(this._mouseStarted&&this._mouseUp(event));this._mouseDownEvent=event;var that=this,btnIsLeft=(event.which===1),elIsCancel=(typeof this.options.cancel==="string"&&event.target.nodeName?$(event.target).closest(this.options.cancel).length:false);if(!btnIsLeft||elIsCancel||!this._mouseCapture(event)){return true;}
this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=true;},this.options.delay);}
if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=(this._mouseStart(event)!==false);if(!this._mouseStarted){event.preventDefault();return true;}}
if(true===$.data(event.target,this.widgetName+".preventClickEvent")){$.removeData(event.target,this.widgetName+".preventClickEvent");}
this._mouseMoveDelegate=function(event){return that._mouseMove(event);};this._mouseUpDelegate=function(event){return that._mouseUp(event);};this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);event.preventDefault();mouseHandled=true;return true;},_mouseMove:function(event){if(this._mouseMoved){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button){return this._mouseUp(event);}else if(!event.which){return this._mouseUp(event);}}
if(event.which||event.button){this._mouseMoved=true;}
if(this._mouseStarted){this._mouseDrag(event);return event.preventDefault();}
if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,event)!==false);(this._mouseStarted?this._mouseDrag(event):this._mouseUp(event));}
return!this._mouseStarted;},_mouseUp:function(event){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(event.target===this._mouseDownEvent.target){$.data(event.target,this.widgetName+".preventClickEvent",true);}
this._mouseStop(event);}
mouseHandled=false;return false;},_mouseDistanceMet:function(event){return(Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance);},_mouseDelayMet:function(){return this.mouseDelayMet;},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true;}});}));(function(factory){if(typeof define==="function"&&define.amd){define(["jquery","./core","./widget"],factory);}else{factory(jQuery);}}(function($){return $.widget("ui.tabs",{version:"@VERSION",delay:300,options:{active:null,collapsible:false,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:(function(){var rhash=/#.*$/;return function(anchor){var anchorUrl,locationUrl;anchor=anchor.cloneNode(false);anchorUrl=anchor.href.replace(rhash,"");locationUrl=location.href.replace(rhash,"");try{anchorUrl=decodeURIComponent(anchorUrl);}catch(error){}
try{locationUrl=decodeURIComponent(locationUrl);}catch(error){}
return anchor.hash.length>1&&anchorUrl===locationUrl;};})(),_create:function(){var that=this,options=this.options;this.running=false;this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",options.collapsible);this._processTabs();options.active=this._initialActive();if($.isArray(options.disabled)){options.disabled=$.unique(options.disabled.concat($.map(this.tabs.filter(".ui-state-disabled"),function(li){return that.tabs.index(li);}))).sort();}
if(this.options.active!==false&&this.anchors.length){this.active=this._findActive(options.active);}else{this.active=$();}
this._refresh();if(this.active.length){this.load(options.active);}},_initialActive:function(){var active=this.options.active,collapsible=this.options.collapsible,locationHash=location.hash.substring(1);if(active===null){if(locationHash){this.tabs.each(function(i,tab){if($(tab).attr("aria-controls")===locationHash){active=i;return false;}});}
if(active===null){active=this.tabs.index(this.tabs.filter(".ui-tabs-active"));}
if(active===null||active===-1){active=this.tabs.length?0:false;}}
if(active!==false){active=this.tabs.index(this.tabs.eq(active));if(active===-1){active=collapsible?false:0;}}
if(!collapsible&&active===false&&this.anchors.length){active=0;}
return active;},_getCreateEventData:function(){return{tab:this.active,panel:!this.active.length?$():this._getPanelForTab(this.active)};},_tabKeydown:function(event){var focusedTab=$(this.document[0].activeElement).closest("li"),selectedIndex=this.tabs.index(focusedTab),goingForward=true;if(this._handlePageNav(event)){return;}
switch(event.keyCode){case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:selectedIndex++;break;case $.ui.keyCode.UP:case $.ui.keyCode.LEFT:goingForward=false;selectedIndex--;break;case $.ui.keyCode.END:selectedIndex=this.anchors.length-1;break;case $.ui.keyCode.HOME:selectedIndex=0;break;case $.ui.keyCode.SPACE:event.preventDefault();clearTimeout(this.activating);this._activate(selectedIndex);return;case $.ui.keyCode.ENTER:event.preventDefault();clearTimeout(this.activating);this._activate(selectedIndex===this.options.active?false:selectedIndex);return;default:return;}
event.preventDefault();clearTimeout(this.activating);selectedIndex=this._focusNextTab(selectedIndex,goingForward);if(!event.ctrlKey){focusedTab.attr("aria-selected","false");this.tabs.eq(selectedIndex).attr("aria-selected","true");this.activating=this._delay(function(){this.option("active",selectedIndex);},this.delay);}},_panelKeydown:function(event){if(this._handlePageNav(event)){return;}
if(event.ctrlKey&&event.keyCode===$.ui.keyCode.UP){event.preventDefault();this.active.focus();}},_handlePageNav:function(event){if(event.altKey&&event.keyCode===$.ui.keyCode.PAGE_UP){this._activate(this._focusNextTab(this.options.active-1,false));return true;}
if(event.altKey&&event.keyCode===$.ui.keyCode.PAGE_DOWN){this._activate(this._focusNextTab(this.options.active+1,true));return true;}},_findNextTab:function(index,goingForward){var lastTabIndex=this.tabs.length-1;function constrain(){if(index>lastTabIndex){index=0;}
if(index<0){index=lastTabIndex;}
return index;}
while($.inArray(constrain(),this.options.disabled)!==-1){index=goingForward?index+1:index-1;}
return index;},_focusNextTab:function(index,goingForward){index=this._findNextTab(index,goingForward);this.tabs.eq(index).focus();return index;},_setOption:function(key,value){if(key==="active"){this._activate(value);return;}
if(key==="disabled"){this._setupDisabled(value);return;}
this._super(key,value);if(key==="collapsible"){this.element.toggleClass("ui-tabs-collapsible",value);if(!value&&this.options.active===false){this._activate(0);}}
if(key==="event"){this._setupEvents(value);}
if(key==="heightStyle"){this._setupHeightStyle(value);}},_sanitizeSelector:function(hash){return hash?hash.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):"";},refresh:function(){var options=this.options,lis=this.tablist.children(":has(a[href])");options.disabled=$.map(lis.filter(".ui-state-disabled"),function(tab){return lis.index(tab);});this._processTabs();if(options.active===false||!this.anchors.length){options.active=false;this.active=$();}else if(this.active.length&&!$.contains(this.tablist[0],this.active[0])){if(this.tabs.length===options.disabled.length){options.active=false;this.active=$();}else{this._activate(this._findNextTab(Math.max(0,options.active-1),false));}}else{options.active=this.tabs.index(this.active);}
this._refresh();},_refresh:function(){this._setupDisabled(this.options.disabled);this._setupEvents(this.options.event);this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"});if(!this.active.length){this.tabs.eq(0).attr("tabIndex",0);}else{this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0});this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"});}},_processTabs:function(){var that=this,prevTabs=this.tabs,prevAnchors=this.anchors,prevPanels=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(event){if($(this).is(".ui-state-disabled")){event.preventDefault();}}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){if($(this).closest("li").is(".ui-state-disabled")){this.blur();}});this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1});this.anchors=this.tabs.map(function(){return $("a",this)[0];}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1});this.panels=$();this.anchors.each(function(i,anchor){var selector,panel,panelId,anchorId=$(anchor).uniqueId().attr("id"),tab=$(anchor).closest("li"),originalAriaControls=tab.attr("aria-controls");if(that._isLocal(anchor)){selector=anchor.hash;panelId=selector.substring(1);panel=that.element.find(that._sanitizeSelector(selector));}else{panelId=tab.attr("aria-controls")||$({}).uniqueId()[0].id;selector="#"+panelId;panel=that.element.find(selector);if(!panel.length){panel=that._createPanel(panelId);panel.insertAfter(that.panels[i-1]||that.tablist);}
panel.attr("aria-live","polite");}
if(panel.length){that.panels=that.panels.add(panel);}
if(originalAriaControls){tab.data("ui-tabs-aria-controls",originalAriaControls);}
tab.attr({"aria-controls":panelId,"aria-labelledby":anchorId});panel.attr("aria-labelledby",anchorId);});this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel");if(prevTabs){this._off(prevTabs.not(this.tabs));this._off(prevAnchors.not(this.anchors));this._off(prevPanels.not(this.panels));}},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0);},_createPanel:function(id){return $("<div>").attr("id",id).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",true);},_setupDisabled:function(disabled){if($.isArray(disabled)){if(!disabled.length){disabled=false;}else if(disabled.length===this.anchors.length){disabled=true;}}
for(var i=0,li;(li=this.tabs[i]);i++){if(disabled===true||$.inArray(i,disabled)!==-1){$(li).addClass("ui-state-disabled").attr("aria-disabled","true");}else{$(li).removeClass("ui-state-disabled").removeAttr("aria-disabled");}}
this.options.disabled=disabled;},_setupEvents:function(event){var events={};if(event){$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler";});}
this._off(this.anchors.add(this.tabs).add(this.panels));this._on(true,this.anchors,{click:function(event){event.preventDefault();}});this._on(this.anchors,events);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs);},_setupHeightStyle:function(heightStyle){var maxHeight,parent=this.element.parent();if(heightStyle==="fill"){maxHeight=parent.height();maxHeight-=this.element.outerHeight()-this.element.height();this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");if(position==="absolute"||position==="fixed"){return;}
maxHeight-=elem.outerHeight(true);});this.element.children().not(this.panels).each(function(){maxHeight-=$(this).outerHeight(true);});this.panels.each(function(){$(this).height(Math.max(0,maxHeight-
$(this).innerHeight()+$(this).height()));}).css("overflow","auto");}else if(heightStyle==="auto"){maxHeight=0;this.panels.each(function(){maxHeight=Math.max(maxHeight,$(this).height("").height());}).height(maxHeight);}},_eventHandler:function(event){var options=this.options,active=this.active,anchor=$(event.currentTarget),tab=anchor.closest("li"),clickedIsActive=tab[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():this._getPanelForTab(tab),toHide=!active.length?$():this._getPanelForTab(active),eventData={oldTab:active,oldPanel:toHide,newTab:collapsing?$():tab,newPanel:toShow};event.preventDefault();if(tab.hasClass("ui-state-disabled")||tab.hasClass("ui-tabs-loading")||this.running||(clickedIsActive&&!options.collapsible)||(this._trigger("beforeActivate",event,eventData)===false)){return;}
options.active=collapsing?false:this.tabs.index(tab);this.active=clickedIsActive?$():tab;if(this.xhr){this.xhr.abort();}
if(!toHide.length&&!toShow.length){$.error("jQuery UI Tabs: Mismatching fragment identifier.");}
if(toShow.length){this.load(this.tabs.index(tab),event);}
this._toggle(event,eventData);},_toggle:function(event,eventData){var that=this,toShow=eventData.newPanel,toHide=eventData.oldPanel;this.running=true;function complete(){that.running=false;that._trigger("activate",event,eventData);}
function show(){eventData.newTab.closest("li").addClass("ui-tabs-active ui-state-active");if(toShow.length&&that.options.show){that._show(toShow,that.options.show,complete);}else{toShow.show();complete();}}
if(toHide.length&&this.options.hide){this._hide(toHide,this.options.hide,function(){eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");show();});}else{eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");toHide.hide();show();}
toHide.attr("aria-hidden","true");eventData.oldTab.attr({"aria-selected":"false","aria-expanded":"false"});if(toShow.length&&toHide.length){eventData.oldTab.attr("tabIndex",-1);}else if(toShow.length){this.tabs.filter(function(){return $(this).attr("tabIndex")===0;}).attr("tabIndex",-1);}
toShow.attr("aria-hidden","false");eventData.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0});},_activate:function(index){var anchor,active=this._findActive(index);if(active[0]===this.active[0]){return;}
if(!active.length){active=this.active;}
anchor=active.find(".ui-tabs-anchor")[0];this._eventHandler({target:anchor,currentTarget:anchor,preventDefault:$.noop});},_findActive:function(index){return index===false?$():this.tabs.eq(index);},_getIndex:function(index){if(typeof index==="string"){index=this.anchors.index(this.anchors.filter("[href$='"+index+"']"));}
return index;},_destroy:function(){if(this.xhr){this.xhr.abort();}
this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role");this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId();this.tablist.unbind(this.eventNamespace);this.tabs.add(this.panels).each(function(){if($.data(this,"ui-tabs-destroy")){$(this).remove();}else{$(this).removeClass("ui-state-default ui-state-active ui-state-disabled "+"ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role");}});this.tabs.each(function(){var li=$(this),prev=li.data("ui-tabs-aria-controls");if(prev){li.attr("aria-controls",prev).removeData("ui-tabs-aria-controls");}else{li.removeAttr("aria-controls");}});this.panels.show();if(this.options.heightStyle!=="content"){this.panels.css("height","");}},enable:function(index){var disabled=this.options.disabled;if(disabled===false){return;}
if(index===undefined){disabled=false;}else{index=this._getIndex(index);if($.isArray(disabled)){disabled=$.map(disabled,function(num){return num!==index?num:null;});}else{disabled=$.map(this.tabs,function(li,num){return num!==index?num:null;});}}
this._setupDisabled(disabled);},disable:function(index){var disabled=this.options.disabled;if(disabled===true){return;}
if(index===undefined){disabled=true;}else{index=this._getIndex(index);if($.inArray(index,disabled)!==-1){return;}
if($.isArray(disabled)){disabled=$.merge([index],disabled).sort();}else{disabled=[index];}}
this._setupDisabled(disabled);},load:function(index,event){index=this._getIndex(index);var that=this,tab=this.tabs.eq(index),anchor=tab.find(".ui-tabs-anchor"),panel=this._getPanelForTab(tab),eventData={tab:tab,panel:panel};if(this._isLocal(anchor[0])){return;}
this.xhr=$.ajax(this._ajaxSettings(anchor,event,eventData));if(this.xhr&&this.xhr.statusText!=="canceled"){tab.addClass("ui-tabs-loading");panel.attr("aria-busy","true");this.xhr.success(function(response){setTimeout(function(){panel.html(response);that._trigger("load",event,eventData);},1);}).complete(function(jqXHR,status){setTimeout(function(){if(status==="abort"){that.panels.stop(false,true);}
tab.removeClass("ui-tabs-loading");panel.removeAttr("aria-busy");if(jqXHR===that.xhr){delete that.xhr;}},1);});}},_ajaxSettings:function(anchor,event,eventData){var that=this;return{url:anchor.attr("href"),beforeSend:function(jqXHR,settings){return that._trigger("beforeLoad",event,$.extend({jqXHR:jqXHR,ajaxSettings:settings},eventData));}};},_getPanelForTab:function(tab){var id=$(tab).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+id));}});}));(function(factory){if(typeof define==="function"&&define.amd){define(["jquery","./core"],factory);}else{factory(jQuery);}}(function($){$.extend($.ui,{datepicker:{version:"@VERSION"}});var datepicker_instActive;function datepicker_getZindex(elem){var position,value;while(elem.length&&elem[0]!==document){position=elem.css("position");if(position==="absolute"||position==="relative"||position==="fixed"){value=parseInt(elem.css("zIndex"),10);if(!isNaN(value)&&value!==0){return value;}}
elem=elem.parent();}
return 0;}
function Datepicker(){this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};$.extend(this._defaults,this.regional[""]);this.regional.en=$.extend(true,{},this.regional[""]);this.regional["en-US"]=$.extend(true,{},this.regional.en);this.dpDiv=datepicker_bindHover($("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"));}
$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv;},setDefaults:function(settings){datepicker_extendRemove(this._defaults,settings||{});return this;},_attachDatepicker:function(target,settings){var nodeName,inline,inst;nodeName=target.nodeName.toLowerCase();inline=(nodeName==="div"||nodeName==="span");if(!target.id){this.uuid+=1;target.id="dp"+this.uuid;}
inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{});if(nodeName==="input"){this._connectDatepicker(target,inst);}else if(inline){this._inlineDatepicker(target,inst);}},_newInst:function(target,inline){var id=target[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:id,input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:(!inline?this.dpDiv:datepicker_bindHover($("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")))};},_connectDatepicker:function(target,inst){var input=$(target);inst.append=$([]);inst.trigger=$([]);if(input.hasClass(this.markerClassName)){return;}
this._attachments(input,inst);input.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp);this._autoSize(inst);$.data(target,"datepicker",inst);if(inst.settings.disabled){this._disableDatepicker(target);}},_attachments:function(input,inst){var showOn,buttonText,buttonImage,appendText=this._get(inst,"appendText"),isRTL=this._get(inst,"isRTL");if(inst.append){inst.append.remove();}
if(appendText){inst.append=$("<span class='"+this._appendClass+"'>"+appendText+"</span>");input[isRTL?"before":"after"](inst.append);}
input.unbind("focus",this._showDatepicker);if(inst.trigger){inst.trigger.remove();}
showOn=this._get(inst,"showOn");if(showOn==="focus"||showOn==="both"){input.focus(this._showDatepicker);}
if(showOn==="button"||showOn==="both"){buttonText=this._get(inst,"buttonText");buttonImage=this._get(inst,"buttonImage");inst.trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:buttonImage,alt:buttonText,title:buttonText}):$("<button type='button'></button>").addClass(this._triggerClass).html(!buttonImage?buttonText:$("<img/>").attr({src:buttonImage,alt:buttonText,title:buttonText})));input[isRTL?"before":"after"](inst.trigger);inst.trigger.click(function(){if($.datepicker._datepickerShowing&&$.datepicker._lastInput===input[0]){$.datepicker._hideDatepicker();}else if($.datepicker._datepickerShowing&&$.datepicker._lastInput!==input[0]){$.datepicker._hideDatepicker();$.datepicker._showDatepicker(input[0]);}else{$.datepicker._showDatepicker(input[0]);}
return false;});}},_autoSize:function(inst){if(this._get(inst,"autoSize")&&!inst.inline){var findMax,max,maxI,i,date=new Date(2009,12-1,20),dateFormat=this._get(inst,"dateFormat");if(dateFormat.match(/[DM]/)){findMax=function(names){max=0;maxI=0;for(i=0;i<names.length;i++){if(names[i].length>max){max=names[i].length;maxI=i;}}
return maxI;};date.setMonth(findMax(this._get(inst,(dateFormat.match(/MM/)?"monthNames":"monthNamesShort"))));date.setDate(findMax(this._get(inst,(dateFormat.match(/DD/)?"dayNames":"dayNamesShort")))+20-date.getDay());}
inst.input.attr("size",this._formatDate(inst,date).length);}},_inlineDatepicker:function(target,inst){var divSpan=$(target);if(divSpan.hasClass(this.markerClassName)){return;}
divSpan.addClass(this.markerClassName).append(inst.dpDiv);$.data(target,"datepicker",inst);this._setDate(inst,this._getDefaultDate(inst),true);this._updateDatepicker(inst);this._updateAlternate(inst);if(inst.settings.disabled){this._disableDatepicker(target);}
inst.dpDiv.css("display","block");},_dialogDatepicker:function(input,date,onSelect,settings,pos){var id,browserWidth,browserHeight,scrollX,scrollY,inst=this._dialogInst;if(!inst){this.uuid+=1;id="dp"+this.uuid;this._dialogInput=$("<input type='text' id='"+id+"' style='position: absolute; top: -100px; width: 0px;'/>");this._dialogInput.keydown(this._doKeyDown);$("body").append(this._dialogInput);inst=this._dialogInst=this._newInst(this._dialogInput,false);inst.settings={};$.data(this._dialogInput[0],"datepicker",inst);}
datepicker_extendRemove(inst.settings,settings||{});date=(date&&date.constructor===Date?this._formatDate(inst,date):date);this._dialogInput.val(date);this._pos=(pos?(pos.length?pos:[pos.pageX,pos.pageY]):null);if(!this._pos){browserWidth=document.documentElement.clientWidth;browserHeight=document.documentElement.clientHeight;scrollX=document.documentElement.scrollLeft||document.body.scrollLeft;scrollY=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[(browserWidth/2)-100+scrollX,(browserHeight/2)-150+scrollY];}
this._dialogInput.css("left",(this._pos[0]+20)+"px").css("top",this._pos[1]+"px");inst.settings.onSelect=onSelect;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if($.blockUI){$.blockUI(this.dpDiv);}
$.data(this._dialogInput[0],"datepicker",inst);return this;},_destroyDatepicker:function(target){var nodeName,$target=$(target),inst=$.data(target,"datepicker");if(!$target.hasClass(this.markerClassName)){return;}
nodeName=target.nodeName.toLowerCase();$.removeData(target,"datepicker");if(nodeName==="input"){inst.append.remove();inst.trigger.remove();$target.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp);}else if(nodeName==="div"||nodeName==="span"){$target.removeClass(this.markerClassName).empty();}},_enableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,"datepicker");if(!$target.hasClass(this.markerClassName)){return;}
nodeName=target.nodeName.toLowerCase();if(nodeName==="input"){target.disabled=false;inst.trigger.filter("button").each(function(){this.disabled=false;}).end().filter("img").css({opacity:"1.0",cursor:""});}else if(nodeName==="div"||nodeName==="span"){inline=$target.children("."+this._inlineClass);inline.children().removeClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",false);}
this._disabledInputs=$.map(this._disabledInputs,function(value){return(value===target?null:value);});},_disableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,"datepicker");if(!$target.hasClass(this.markerClassName)){return;}
nodeName=target.nodeName.toLowerCase();if(nodeName==="input"){target.disabled=true;inst.trigger.filter("button").each(function(){this.disabled=true;}).end().filter("img").css({opacity:"0.5",cursor:"default"});}else if(nodeName==="div"||nodeName==="span"){inline=$target.children("."+this._inlineClass);inline.children().addClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",true);}
this._disabledInputs=$.map(this._disabledInputs,function(value){return(value===target?null:value);});this._disabledInputs[this._disabledInputs.length]=target;},_isDisabledDatepicker:function(target){if(!target){return false;}
for(var i=0;i<this._disabledInputs.length;i++){if(this._disabledInputs[i]===target){return true;}}
return false;},_getInst:function(target){try{return $.data(target,"datepicker");}
catch(err){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(target,name,value){var settings,date,minDate,maxDate,inst=this._getInst(target);if(arguments.length===2&&typeof name==="string"){return(name==="defaults"?$.extend({},$.datepicker._defaults):(inst?(name==="all"?$.extend({},inst.settings):this._get(inst,name)):null));}
settings=name||{};if(typeof name==="string"){settings={};settings[name]=value;}
if(inst){if(this._curInst===inst){this._hideDatepicker();}
date=this._getDateDatepicker(target,true);minDate=this._getMinMaxDate(inst,"min");maxDate=this._getMinMaxDate(inst,"max");datepicker_extendRemove(inst.settings,settings);if(minDate!==null&&settings.dateFormat!==undefined&&settings.minDate===undefined){inst.settings.minDate=this._formatDate(inst,minDate);}
if(maxDate!==null&&settings.dateFormat!==undefined&&settings.maxDate===undefined){inst.settings.maxDate=this._formatDate(inst,maxDate);}
if("disabled"in settings){if(settings.disabled){this._disableDatepicker(target);}else{this._enableDatepicker(target);}}
this._attachments($(target),inst);this._autoSize(inst);this._setDate(inst,date);this._updateAlternate(inst);this._updateDatepicker(inst);}},_changeDatepicker:function(target,name,value){this._optionDatepicker(target,name,value);},_refreshDatepicker:function(target){var inst=this._getInst(target);if(inst){this._updateDatepicker(inst);}},_setDateDatepicker:function(target,date){var inst=this._getInst(target);if(inst){this._setDate(inst,date);this._updateDatepicker(inst);this._updateAlternate(inst);}},_getDateDatepicker:function(target,noDefault){var inst=this._getInst(target);if(inst&&!inst.inline){this._setDateFromField(inst,noDefault);}
return(inst?this._getDate(inst):null);},_doKeyDown:function(event){var onSelect,dateStr,sel,inst=$.datepicker._getInst(event.target),handled=true,isRTL=inst.dpDiv.is(".ui-datepicker-rtl");inst._keyEvent=true;if($.datepicker._datepickerShowing){switch(event.keyCode){case 9:$.datepicker._hideDatepicker();handled=false;break;case 13:sel=$("td."+$.datepicker._dayOverClass+":not(."+
$.datepicker._currentClass+")",inst.dpDiv);if(sel[0]){$.datepicker._selectDay(event.target,inst.selectedMonth,inst.selectedYear,sel[0]);}
onSelect=$.datepicker._get(inst,"onSelect");if(onSelect){dateStr=$.datepicker._formatDate(inst);onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst]);}else{$.datepicker._hideDatepicker();}
return false;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M");break;case 34:$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M");break;case 35:if(event.ctrlKey||event.metaKey){$.datepicker._clearDate(event.target);}
handled=event.ctrlKey||event.metaKey;break;case 36:if(event.ctrlKey||event.metaKey){$.datepicker._gotoToday(event.target);}
handled=event.ctrlKey||event.metaKey;break;case 37:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?+1:-1),"D");}
handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M");}
break;case 38:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,-7,"D");}
handled=event.ctrlKey||event.metaKey;break;case 39:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?-1:+1),"D");}
handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M");}
break;case 40:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,+7,"D");}
handled=event.ctrlKey||event.metaKey;break;default:handled=false;}}else if(event.keyCode===36&&event.ctrlKey){$.datepicker._showDatepicker(this);}else{handled=false;}
if(handled){event.preventDefault();event.stopPropagation();}},_doKeyPress:function(event){var chars,chr,inst=$.datepicker._getInst(event.target);if($.datepicker._get(inst,"constrainInput")){chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat"));chr=String.fromCharCode(event.charCode==null?event.keyCode:event.charCode);return event.ctrlKey||event.metaKey||(chr<" "||!chars||chars.indexOf(chr)>-1);}},_doKeyUp:function(event){var date,inst=$.datepicker._getInst(event.target);if(inst.input.val()!==inst.lastVal){try{date=$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),(inst.input?inst.input.val():null),$.datepicker._getFormatConfig(inst));if(date){$.datepicker._setDateFromField(inst);$.datepicker._updateAlternate(inst);$.datepicker._updateDatepicker(inst);}}
catch(err){}}
return true;},_showDatepicker:function(input){input=input.target||input;if(input.nodeName.toLowerCase()!=="input"){input=$("input",input.parentNode)[0];}
if($.datepicker._isDisabledDatepicker(input)||$.datepicker._lastInput===input){return;}
var inst,beforeShow,beforeShowSettings,isFixed,offset,showAnim,duration;inst=$.datepicker._getInst(input);if($.datepicker._curInst&&$.datepicker._curInst!==inst){$.datepicker._curInst.dpDiv.stop(true,true);if(inst&&$.datepicker._datepickerShowing){$.datepicker._hideDatepicker($.datepicker._curInst.input[0]);}}
beforeShow=$.datepicker._get(inst,"beforeShow");beforeShowSettings=beforeShow?beforeShow.apply(input,[input,inst]):{};if(beforeShowSettings===false){return;}
datepicker_extendRemove(inst.settings,beforeShowSettings);inst.lastVal=null;$.datepicker._lastInput=input;$.datepicker._setDateFromField(inst);if($.datepicker._inDialog){input.value="";}
if(!$.datepicker._pos){$.datepicker._pos=$.datepicker._findPos(input);$.datepicker._pos[1]+=input.offsetHeight;}
isFixed=false;$(input).parents().each(function(){isFixed|=$(this).css("position")==="fixed";return!isFixed;});offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null;inst.dpDiv.empty();inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});$.datepicker._updateDatepicker(inst);offset=$.datepicker._checkOffset(inst,offset,isFixed);inst.dpDiv.css({position:($.datepicker._inDialog&&$.blockUI?"static":(isFixed?"fixed":"absolute")),display:"none",left:offset.left+"px",top:offset.top+"px"});if(!inst.inline){showAnim=$.datepicker._get(inst,"showAnim");duration=$.datepicker._get(inst,"duration");inst.dpDiv.css("z-index",datepicker_getZindex($(input))+1);$.datepicker._datepickerShowing=true;if($.effects&&$.effects.effect[showAnim]){inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration);}else{inst.dpDiv[showAnim||"show"](showAnim?duration:null);}
if($.datepicker._shouldFocusInput(inst)){inst.input.focus();}
$.datepicker._curInst=inst;}},_updateDatepicker:function(inst){this.maxRows=4;datepicker_instActive=inst;inst.dpDiv.empty().append(this._generateHTML(inst));this._attachHandlers(inst);var origyearshtml,numMonths=this._getNumberOfMonths(inst),cols=numMonths[1],width=17,activeCell=inst.dpDiv.find("."+this._dayOverClass+" a");if(activeCell.length>0){datepicker_handleMouseover.apply(activeCell.get(0));}
inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(cols>1){inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",(width*cols)+"em");}
inst.dpDiv[(numMonths[0]!==1||numMonths[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi");inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(inst===$.datepicker._curInst&&$.datepicker._datepickerShowing&&$.datepicker._shouldFocusInput(inst)){inst.input.focus();}
if(inst.yearshtml){origyearshtml=inst.yearshtml;setTimeout(function(){if(origyearshtml===inst.yearshtml&&inst.yearshtml){inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml);}
origyearshtml=inst.yearshtml=null;},0);}},_shouldFocusInput:function(inst){return inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&!inst.input.is(":focus");},_checkOffset:function(inst,offset,isFixed){var dpWidth=inst.dpDiv.outerWidth(),dpHeight=inst.dpDiv.outerHeight(),inputWidth=inst.input?inst.input.outerWidth():0,inputHeight=inst.input?inst.input.outerHeight():0,viewWidth=document.documentElement.clientWidth+(isFixed?0:$(document).scrollLeft()),viewHeight=document.documentElement.clientHeight+(isFixed?0:$(document).scrollTop());offset.left-=(this._get(inst,"isRTL")?(dpWidth-inputWidth):0);offset.left-=(isFixed&&offset.left===inst.input.offset().left)?$(document).scrollLeft():0;offset.top-=(isFixed&&offset.top===(inst.input.offset().top+inputHeight))?$(document).scrollTop():0;offset.left-=Math.min(offset.left,(offset.left+dpWidth>viewWidth&&viewWidth>dpWidth)?Math.abs(offset.left+dpWidth-viewWidth):0);offset.top-=Math.min(offset.top,(offset.top+dpHeight>viewHeight&&viewHeight>dpHeight)?Math.abs(dpHeight+inputHeight):0);return offset;},_findPos:function(obj){var position,inst=this._getInst(obj),isRTL=this._get(inst,"isRTL");while(obj&&(obj.type==="hidden"||obj.nodeType!==1||$.expr.filters.hidden(obj))){obj=obj[isRTL?"previousSibling":"nextSibling"];}
position=$(obj).offset();return[position.left,position.top];},_hideDatepicker:function(input){var showAnim,duration,postProcess,onClose,inst=this._curInst;if(!inst||(input&&inst!==$.data(input,"datepicker"))){return;}
if(this._datepickerShowing){showAnim=this._get(inst,"showAnim");duration=this._get(inst,"duration");postProcess=function(){$.datepicker._tidyDialog(inst);};if($.effects&&($.effects.effect[showAnim]||$.effects[showAnim])){inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess);}else{inst.dpDiv[(showAnim==="slideDown"?"slideUp":(showAnim==="fadeIn"?"fadeOut":"hide"))]((showAnim?duration:null),postProcess);}
if(!showAnim){postProcess();}
this._datepickerShowing=false;onClose=this._get(inst,"onClose");if(onClose){onClose.apply((inst.input?inst.input[0]:null),[(inst.input?inst.input.val():""),inst]);}
this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if($.blockUI){$.unblockUI();$("body").append(this.dpDiv);}}
this._inDialog=false;}},_tidyDialog:function(inst){inst.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar");},_checkExternalClick:function(event){if(!$.datepicker._curInst){return;}
var $target=$(event.target),inst=$.datepicker._getInst($target[0]);if((($target[0].id!==$.datepicker._mainDivId&&$target.parents("#"+$.datepicker._mainDivId).length===0&&!$target.hasClass($.datepicker.markerClassName)&&!$target.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&!($.datepicker._inDialog&&$.blockUI)))||($target.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!==inst)){$.datepicker._hideDatepicker();}},_adjustDate:function(id,offset,period){var target=$(id),inst=this._getInst(target[0]);if(this._isDisabledDatepicker(target[0])){return;}
this._adjustInstDate(inst,offset+
(period==="M"?this._get(inst,"showCurrentAtPos"):0),period);this._updateDatepicker(inst);},_gotoToday:function(id){var date,target=$(id),inst=this._getInst(target[0]);if(this._get(inst,"gotoCurrent")&&inst.currentDay){inst.selectedDay=inst.currentDay;inst.drawMonth=inst.selectedMonth=inst.currentMonth;inst.drawYear=inst.selectedYear=inst.currentYear;}else{date=new Date();inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();}
this._notifyChange(inst);this._adjustDate(target);},_selectMonthYear:function(id,select,period){var target=$(id),inst=this._getInst(target[0]);inst["selected"+(period==="M"?"Month":"Year")]=inst["draw"+(period==="M"?"Month":"Year")]=parseInt(select.options[select.selectedIndex].value,10);this._notifyChange(inst);this._adjustDate(target);},_selectDay:function(id,month,year,td){var inst,target=$(id);if($(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(target[0])){return;}
inst=this._getInst(target[0]);inst.selectedDay=inst.currentDay=$("a",td).html();inst.selectedMonth=inst.currentMonth=month;inst.selectedYear=inst.currentYear=year;this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear));},_clearDate:function(id){var target=$(id);this._selectDate(target,"");},_selectDate:function(id,dateStr){var onSelect,target=$(id),inst=this._getInst(target[0]);dateStr=(dateStr!=null?dateStr:this._formatDate(inst));if(inst.input){inst.input.val(dateStr);}
this._updateAlternate(inst);onSelect=this._get(inst,"onSelect");if(onSelect){onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst]);}else if(inst.input){inst.input.trigger("change");}
if(inst.inline){this._updateDatepicker(inst);}else{this._hideDatepicker();this._lastInput=inst.input[0];if(typeof(inst.input[0])!=="object"){inst.input.focus();}
this._lastInput=null;}},_updateAlternate:function(inst){var altFormat,date,dateStr,altField=this._get(inst,"altField");if(altField){altFormat=this._get(inst,"altFormat")||this._get(inst,"dateFormat");date=this._getDate(inst);dateStr=this.formatDate(altFormat,date,this._getFormatConfig(inst));$(altField).each(function(){$(this).val(dateStr);});}},noWeekends:function(date){var day=date.getDay();return[(day>0&&day<6),""];},iso8601Week:function(date){var time,checkDate=new Date(date.getTime());checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));time=checkDate.getTime();checkDate.setMonth(0);checkDate.setDate(1);return Math.floor(Math.round((time-checkDate)/86400000)/7)+1;},parseDate:function(format,value,settings){if(format==null||value==null){throw"Invalid arguments";}
value=(typeof value==="object"?value.toString():value+"");if(value===""){return null;}
var iFormat,dim,extra,iValue=0,shortYearCutoffTemp=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff,shortYearCutoff=(typeof shortYearCutoffTemp!=="string"?shortYearCutoffTemp:new Date().getFullYear()%100+parseInt(shortYearCutoffTemp,10)),dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,year=-1,month=-1,day=-1,doy=-1,literal=false,date,lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)===match);if(matches){iFormat++;}
return matches;},getNumber=function(match){var isDoubled=lookAhead(match),size=(match==="@"?14:(match==="!"?20:(match==="y"&&isDoubled?4:(match==="o"?3:2)))),minSize=(match==="y"?size:1),digits=new RegExp("^\\d{"+minSize+","+size+"}"),num=value.substring(iValue).match(digits);if(!num){throw"Missing number at position "+iValue;}
iValue+=num[0].length;return parseInt(num[0],10);},getName=function(match,shortNames,longNames){var index=-1,names=$.map(lookAhead(match)?longNames:shortNames,function(v,k){return[[k,v]];}).sort(function(a,b){return-(a[1].length-b[1].length);});$.each(names,function(i,pair){var name=pair[1];if(value.substr(iValue,name.length).toLowerCase()===name.toLowerCase()){index=pair[0];iValue+=name.length;return false;}});if(index!==-1){return index+1;}else{throw"Unknown name at position "+iValue;}},checkLiteral=function(){if(value.charAt(iValue)!==format.charAt(iFormat)){throw"Unexpected literal at position "+iValue;}
iValue++;};for(iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)==="'"&&!lookAhead("'")){literal=false;}else{checkLiteral();}}else{switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":year=getNumber("y");break;case"@":date=new Date(getNumber("@"));year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"!":date=new Date((getNumber("!")-this._ticksTo1970)/10000);year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"'":if(lookAhead("'")){checkLiteral();}else{literal=true;}
break;default:checkLiteral();}}}
if(iValue<value.length){extra=value.substr(iValue);if(!/^\s+/.test(extra)){throw"Extra/unparsed characters found in date: "+extra;}}
if(year===-1){year=new Date().getFullYear();}else if(year<100){year+=new Date().getFullYear()-new Date().getFullYear()%100+
(year<=shortYearCutoff?0:-100);}
if(doy>-1){month=1;day=doy;do{dim=this._getDaysInMonth(year,month-1);if(day<=dim){break;}
month++;day-=dim;}while(true);}
date=this._daylightSavingAdjust(new Date(year,month-1,day));if(date.getFullYear()!==year||date.getMonth()+1!==month||date.getDate()!==day){throw"Invalid date";}
return date;},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+
Math.floor(1970/400))*24*60*60*10000000),formatDate:function(format,date,settings){if(!date){return"";}
var iFormat,dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)===match);if(matches){iFormat++;}
return matches;},formatNumber=function(match,value,len){var num=""+value;if(lookAhead(match)){while(num.length<len){num="0"+num;}}
return num;},formatName=function(match,value,shortNames,longNames){return(lookAhead(match)?longNames[value]:shortNames[value]);},output="",literal=false;if(date){for(iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)==="'"&&!lookAhead("'")){literal=false;}else{output+=format.charAt(iFormat);}}else{switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":output+=formatNumber("o",Math.round((new Date(date.getFullYear(),date.getMonth(),date.getDate()).getTime()-new Date(date.getFullYear(),0,0).getTime())/86400000),3);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=(lookAhead("y")?date.getFullYear():(date.getYear()%100<10?"0":"")+date.getYear()%100);break;case"@":output+=date.getTime();break;case"!":output+=date.getTime()*10000+this._ticksTo1970;break;case"'":if(lookAhead("'")){output+="'";}else{literal=true;}
break;default:output+=format.charAt(iFormat);}}}}
return output;},_possibleChars:function(format){var iFormat,chars="",literal=false,lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)===match);if(matches){iFormat++;}
return matches;};for(iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)==="'"&&!lookAhead("'")){literal=false;}else{chars+=format.charAt(iFormat);}}else{switch(format.charAt(iFormat)){case"d":case"m":case"y":case"@":chars+="0123456789";break;case"D":case"M":return null;case"'":if(lookAhead("'")){chars+="'";}else{literal=true;}
break;default:chars+=format.charAt(iFormat);}}}
return chars;},_get:function(inst,name){return inst.settings[name]!==undefined?inst.settings[name]:this._defaults[name];},_setDateFromField:function(inst,noDefault){if(inst.input.val()===inst.lastVal){return;}
var dateFormat=this._get(inst,"dateFormat"),dates=inst.lastVal=inst.input?inst.input.val():null,defaultDate=this._getDefaultDate(inst),date=defaultDate,settings=this._getFormatConfig(inst);try{date=this.parseDate(dateFormat,dates,settings)||defaultDate;}catch(event){dates=(noDefault?"":dates);}
inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();inst.currentDay=(dates?date.getDate():0);inst.currentMonth=(dates?date.getMonth():0);inst.currentYear=(dates?date.getFullYear():0);this._adjustInstDate(inst);},_getDefaultDate:function(inst){return this._restrictMinMax(inst,this._determineDate(inst,this._get(inst,"defaultDate"),new Date()));},_determineDate:function(inst,date,defaultDate){var offsetNumeric=function(offset){var date=new Date();date.setDate(date.getDate()+offset);return date;},offsetString=function(offset){try{return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),offset,$.datepicker._getFormatConfig(inst));}
catch(e){}
var date=(offset.toLowerCase().match(/^c/)?$.datepicker._getDate(inst):null)||new Date(),year=date.getFullYear(),month=date.getMonth(),day=date.getDate(),pattern=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,matches=pattern.exec(offset);while(matches){switch(matches[2]||"d"){case"d":case"D":day+=parseInt(matches[1],10);break;case"w":case"W":day+=parseInt(matches[1],10)*7;break;case"m":case"M":month+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;case"y":case"Y":year+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;}
matches=pattern.exec(offset);}
return new Date(year,month,day);},newDate=(date==null||date===""?defaultDate:(typeof date==="string"?offsetString(date):(typeof date==="number"?(isNaN(date)?defaultDate:offsetNumeric(date)):new Date(date.getTime()))));newDate=(newDate&&newDate.toString()==="Invalid Date"?defaultDate:newDate);if(newDate){newDate.setHours(0);newDate.setMinutes(0);newDate.setSeconds(0);newDate.setMilliseconds(0);}
return this._daylightSavingAdjust(newDate);},_daylightSavingAdjust:function(date){if(!date){return null;}
date.setHours(date.getHours()>12?date.getHours()+2:0);return date;},_setDate:function(inst,date,noChange){var clear=!date,origMonth=inst.selectedMonth,origYear=inst.selectedYear,newDate=this._restrictMinMax(inst,this._determineDate(inst,date,new Date()));inst.selectedDay=inst.currentDay=newDate.getDate();inst.drawMonth=inst.selectedMonth=inst.currentMonth=newDate.getMonth();inst.drawYear=inst.selectedYear=inst.currentYear=newDate.getFullYear();if((origMonth!==inst.selectedMonth||origYear!==inst.selectedYear)&&!noChange){this._notifyChange(inst);}
this._adjustInstDate(inst);if(inst.input){inst.input.val(clear?"":this._formatDate(inst));}},_getDate:function(inst){var startDate=(!inst.currentYear||(inst.input&&inst.input.val()==="")?null:this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return startDate;},_attachHandlers:function(inst){var stepMonths=this._get(inst,"stepMonths"),id="#"+inst.id.replace(/\\\\/g,"\\");inst.dpDiv.find("[data-handler]").map(function(){var handler={prev:function(){$.datepicker._adjustDate(id,-stepMonths,"M");},next:function(){$.datepicker._adjustDate(id,+stepMonths,"M");},hide:function(){$.datepicker._hideDatepicker();},today:function(){$.datepicker._gotoToday(id);},selectDay:function(){$.datepicker._selectDay(id,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return false;},selectMonth:function(){$.datepicker._selectMonthYear(id,this,"M");return false;},selectYear:function(){$.datepicker._selectMonthYear(id,this,"Y");return false;}};$(this).bind(this.getAttribute("data-event"),handler[this.getAttribute("data-handler")]);});},_generateHTML:function(inst){var maxDraw,prevText,prev,nextText,next,currentText,gotoDate,controls,buttonPanel,firstDay,showWeek,dayNames,dayNamesMin,monthNames,monthNamesShort,beforeShowDay,showOtherMonths,selectOtherMonths,defaultDate,html,dow,row,group,col,selectedDate,cornerClass,calender,thead,day,daysInMonth,leadDays,curRows,numRows,printDate,dRow,tbody,daySettings,otherMonth,unselectable,tempDate=new Date(),today=this._daylightSavingAdjust(new Date(tempDate.getFullYear(),tempDate.getMonth(),tempDate.getDate())),isRTL=this._get(inst,"isRTL"),showButtonPanel=this._get(inst,"showButtonPanel"),hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext"),navigationAsDateFormat=this._get(inst,"navigationAsDateFormat"),numMonths=this._getNumberOfMonths(inst),showCurrentAtPos=this._get(inst,"showCurrentAtPos"),stepMonths=this._get(inst,"stepMonths"),isMultiMonth=(numMonths[0]!==1||numMonths[1]!==1),currentDate=this._daylightSavingAdjust((!inst.currentDay?new Date(9999,9,9):new Date(inst.currentYear,inst.currentMonth,inst.currentDay))),minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),drawMonth=inst.drawMonth-showCurrentAtPos,drawYear=inst.drawYear;if(drawMonth<0){drawMonth+=12;drawYear--;}
if(maxDate){maxDraw=this._daylightSavingAdjust(new Date(maxDate.getFullYear(),maxDate.getMonth()-(numMonths[0]*numMonths[1])+1,maxDate.getDate()));maxDraw=(minDate&&maxDraw<minDate?minDate:maxDraw);while(this._daylightSavingAdjust(new Date(drawYear,drawMonth,1))>maxDraw){drawMonth--;if(drawMonth<0){drawMonth=11;drawYear--;}}}
inst.drawMonth=drawMonth;inst.drawYear=drawYear;prevText=this._get(inst,"prevText");prevText=(!navigationAsDateFormat?prevText:this.formatDate(prevText,this._daylightSavingAdjust(new Date(drawYear,drawMonth-stepMonths,1)),this._getFormatConfig(inst)));prev=(this._canAdjustMonth(inst,-1,drawYear,drawMonth)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click'"+" title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>":(hideIfNoPrevNext?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>"));nextText=this._get(inst,"nextText");nextText=(!navigationAsDateFormat?nextText:this.formatDate(nextText,this._daylightSavingAdjust(new Date(drawYear,drawMonth+stepMonths,1)),this._getFormatConfig(inst)));next=(this._canAdjustMonth(inst,+1,drawYear,drawMonth)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click'"+" title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>":(hideIfNoPrevNext?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>"));currentText=this._get(inst,"currentText");gotoDate=(this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today);currentText=(!navigationAsDateFormat?currentText:this.formatDate(currentText,gotoDate,this._getFormatConfig(inst)));controls=(!inst.inline?"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+
this._get(inst,"closeText")+"</button>":"");buttonPanel=(showButtonPanel)?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(isRTL?controls:"")+
(this._isInRange(inst,gotoDate)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'"+">"+currentText+"</button>":"")+(isRTL?"":controls)+"</div>":"";firstDay=parseInt(this._get(inst,"firstDay"),10);firstDay=(isNaN(firstDay)?0:firstDay);showWeek=this._get(inst,"showWeek");dayNames=this._get(inst,"dayNames");dayNamesMin=this._get(inst,"dayNamesMin");monthNames=this._get(inst,"monthNames");monthNamesShort=this._get(inst,"monthNamesShort");beforeShowDay=this._get(inst,"beforeShowDay");showOtherMonths=this._get(inst,"showOtherMonths");selectOtherMonths=this._get(inst,"selectOtherMonths");defaultDate=this._getDefaultDate(inst);html="";dow;for(row=0;row<numMonths[0];row++){group="";this.maxRows=4;for(col=0;col<numMonths[1];col++){selectedDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,inst.selectedDay));cornerClass=" ui-corner-all";calender="";if(isMultiMonth){calender+="<div class='ui-datepicker-group";if(numMonths[1]>1){switch(col){case 0:calender+=" ui-datepicker-group-first";cornerClass=" ui-corner-"+(isRTL?"right":"left");break;case numMonths[1]-1:calender+=" ui-datepicker-group-last";cornerClass=" ui-corner-"+(isRTL?"left":"right");break;default:calender+=" ui-datepicker-group-middle";cornerClass="";break;}}
calender+="'>";}
calender+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+cornerClass+"'>"+
(/all|left/.test(cornerClass)&&row===0?(isRTL?next:prev):"")+
(/all|right/.test(cornerClass)&&row===0?(isRTL?prev:next):"")+
this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,row>0||col>0,monthNames,monthNamesShort)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>";thead=(showWeek?"<th class='ui-datepicker-week-col'>"+this._get(inst,"weekHeader")+"</th>":"");for(dow=0;dow<7;dow++){day=(dow+firstDay)%7;thead+="<th scope='col'"+((dow+firstDay+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+dayNames[day]+"'>"+dayNamesMin[day]+"</span></th>";}
calender+=thead+"</tr></thead><tbody>";daysInMonth=this._getDaysInMonth(drawYear,drawMonth);if(drawYear===inst.selectedYear&&drawMonth===inst.selectedMonth){inst.selectedDay=Math.min(inst.selectedDay,daysInMonth);}
leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7;curRows=Math.ceil((leadDays+daysInMonth)/7);numRows=(isMultiMonth?this.maxRows>curRows?this.maxRows:curRows:curRows);this.maxRows=numRows;printDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,1-leadDays));for(dRow=0;dRow<numRows;dRow++){calender+="<tr>";tbody=(!showWeek?"":"<td class='ui-datepicker-week-col'>"+
this._get(inst,"calculateWeek")(printDate)+"</td>");for(dow=0;dow<7;dow++){daySettings=(beforeShowDay?beforeShowDay.apply((inst.input?inst.input[0]:null),[printDate]):[true,""]);otherMonth=(printDate.getMonth()!==drawMonth);unselectable=(otherMonth&&!selectOtherMonths)||!daySettings[0]||(minDate&&printDate<minDate)||(maxDate&&printDate>maxDate);tbody+="<td class='"+
((dow+firstDay+6)%7>=5?" ui-datepicker-week-end":"")+
(otherMonth?" ui-datepicker-other-month":"")+
((printDate.getTime()===selectedDate.getTime()&&drawMonth===inst.selectedMonth&&inst._keyEvent)||(defaultDate.getTime()===printDate.getTime()&&defaultDate.getTime()===selectedDate.getTime())?" "+this._dayOverClass:"")+
(unselectable?" "+this._unselectableClass+" ui-state-disabled":"")+
(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+
(printDate.getTime()===currentDate.getTime()?" "+this._currentClass:"")+
(printDate.getTime()===today.getTime()?" ui-datepicker-today":""))+"'"+
((!otherMonth||showOtherMonths)&&daySettings[2]?" title='"+daySettings[2].replace(/'/g,"&#39;")+"'":"")+
(unselectable?"":" data-handler='selectDay' data-event='click' data-month='"+printDate.getMonth()+"' data-year='"+printDate.getFullYear()+"'")+">"+
(otherMonth&&!showOtherMonths?"&#xa0;":(unselectable?"<span class='ui-state-default'>"+printDate.getDate()+"</span>":"<a class='ui-state-default"+
(printDate.getTime()===today.getTime()?" ui-state-highlight":"")+
(printDate.getTime()===currentDate.getTime()?" ui-state-active":"")+
(otherMonth?" ui-priority-secondary":"")+"' href='#'>"+printDate.getDate()+"</a>"))+"</td>";printDate.setDate(printDate.getDate()+1);printDate=this._daylightSavingAdjust(printDate);}
calender+=tbody+"</tr>";}
drawMonth++;if(drawMonth>11){drawMonth=0;drawYear++;}
calender+="</tbody></table>"+(isMultiMonth?"</div>"+
((numMonths[0]>0&&col===numMonths[1]-1)?"<div class='ui-datepicker-row-break'></div>":""):"");group+=calender;}
html+=group;}
html+=buttonPanel;inst._keyEvent=false;return html;},_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,secondary,monthNames,monthNamesShort){var inMinYear,inMaxYear,month,years,thisYear,determineYear,year,endYear,changeMonth=this._get(inst,"changeMonth"),changeYear=this._get(inst,"changeYear"),showMonthAfterYear=this._get(inst,"showMonthAfterYear"),html="<div class='ui-datepicker-title'>",monthHtml="";if(secondary||!changeMonth){monthHtml+="<span class='ui-datepicker-month'>"+monthNames[drawMonth]+"</span>";}else{inMinYear=(minDate&&minDate.getFullYear()===drawYear);inMaxYear=(maxDate&&maxDate.getFullYear()===drawYear);monthHtml+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(month=0;month<12;month++){if((!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth())){monthHtml+="<option value='"+month+"'"+
(month===drawMonth?" selected='selected'":"")+">"+monthNamesShort[month]+"</option>";}}
monthHtml+="</select>";}
if(!showMonthAfterYear){html+=monthHtml+(secondary||!(changeMonth&&changeYear)?"&#xa0;":"");}
if(!inst.yearshtml){inst.yearshtml="";if(secondary||!changeYear){html+="<span class='ui-datepicker-year'>"+drawYear+"</span>";}else{years=this._get(inst,"yearRange").split(":");thisYear=new Date().getFullYear();determineYear=function(value){var year=(value.match(/c[+\-].*/)?drawYear+parseInt(value.substring(1),10):(value.match(/[+\-].*/)?thisYear+parseInt(value,10):parseInt(value,10)));return(isNaN(year)?thisYear:year);};year=determineYear(years[0]);endYear=Math.max(year,determineYear(years[1]||""));year=(minDate?Math.max(year,minDate.getFullYear()):year);endYear=(maxDate?Math.min(endYear,maxDate.getFullYear()):endYear);inst.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";for(;year<=endYear;year++){inst.yearshtml+="<option value='"+year+"'"+
(year===drawYear?" selected='selected'":"")+">"+year+"</option>";}
inst.yearshtml+="</select>";html+=inst.yearshtml;inst.yearshtml=null;}}
html+=this._get(inst,"yearSuffix");if(showMonthAfterYear){html+=(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")+monthHtml;}
html+="</div>";return html;},_adjustInstDate:function(inst,offset,period){var year=inst.drawYear+(period==="Y"?offset:0),month=inst.drawMonth+(period==="M"?offset:0),day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+(period==="D"?offset:0),date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,month,day)));inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();if(period==="M"||period==="Y"){this._notifyChange(inst);}},_restrictMinMax:function(inst,date){var minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),newDate=(minDate&&date<minDate?minDate:date);return(maxDate&&newDate>maxDate?maxDate:newDate);},_notifyChange:function(inst){var onChange=this._get(inst,"onChangeMonthYear");if(onChange){onChange.apply((inst.input?inst.input[0]:null),[inst.selectedYear,inst.selectedMonth+1,inst]);}},_getNumberOfMonths:function(inst){var numMonths=this._get(inst,"numberOfMonths");return(numMonths==null?[1,1]:(typeof numMonths==="number"?[1,numMonths]:numMonths));},_getMinMaxDate:function(inst,minMax){return this._determineDate(inst,this._get(inst,minMax+"Date"),null);},_getDaysInMonth:function(year,month){return 32-this._daylightSavingAdjust(new Date(year,month,32)).getDate();},_getFirstDayOfMonth:function(year,month){return new Date(year,month,1).getDay();},_canAdjustMonth:function(inst,offset,curYear,curMonth){var numMonths=this._getNumberOfMonths(inst),date=this._daylightSavingAdjust(new Date(curYear,curMonth+(offset<0?offset:numMonths[0]*numMonths[1]),1));if(offset<0){date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth()));}
return this._isInRange(inst,date);},_isInRange:function(inst,date){var yearSplit,currentYear,minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),minYear=null,maxYear=null,years=this._get(inst,"yearRange");if(years){yearSplit=years.split(":");currentYear=new Date().getFullYear();minYear=parseInt(yearSplit[0],10);maxYear=parseInt(yearSplit[1],10);if(yearSplit[0].match(/[+\-].*/)){minYear+=currentYear;}
if(yearSplit[1].match(/[+\-].*/)){maxYear+=currentYear;}}
return((!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime())&&(!minYear||date.getFullYear()>=minYear)&&(!maxYear||date.getFullYear()<=maxYear));},_getFormatConfig:function(inst){var shortYearCutoff=this._get(inst,"shortYearCutoff");shortYearCutoff=(typeof shortYearCutoff!=="string"?shortYearCutoff:new Date().getFullYear()%100+parseInt(shortYearCutoff,10));return{shortYearCutoff:shortYearCutoff,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")};},_formatDate:function(inst,day,month,year){if(!day){inst.currentDay=inst.selectedDay;inst.currentMonth=inst.selectedMonth;inst.currentYear=inst.selectedYear;}
var date=(day?(typeof day==="object"?day:this._daylightSavingAdjust(new Date(year,month,day))):this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst));}});function datepicker_bindHover(dpDiv){var selector="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return dpDiv.delegate(selector,"mouseout",function(){$(this).removeClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){$(this).removeClass("ui-datepicker-prev-hover");}
if(this.className.indexOf("ui-datepicker-next")!==-1){$(this).removeClass("ui-datepicker-next-hover");}}).delegate(selector,"mouseover",datepicker_handleMouseover);}
function datepicker_handleMouseover(){if(!$.datepicker._isDisabledDatepicker(datepicker_instActive.inline?datepicker_instActive.dpDiv.parent()[0]:datepicker_instActive.input[0])){$(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");$(this).addClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){$(this).addClass("ui-datepicker-prev-hover");}
if(this.className.indexOf("ui-datepicker-next")!==-1){$(this).addClass("ui-datepicker-next-hover");}}}
function datepicker_extendRemove(target,props){$.extend(target,props);for(var name in props){if(props[name]==null){target[name]=props[name];}}
return target;}
$.fn.datepicker=function(options){if(!this.length){return this;}
if(!$.datepicker.initialized){$(document).mousedown($.datepicker._checkExternalClick);$.datepicker.initialized=true;}
if($("#"+$.datepicker._mainDivId).length===0){$("body").append($.datepicker.dpDiv);}
var otherArgs=Array.prototype.slice.call(arguments,1);if(typeof options==="string"&&(options==="isDisabled"||options==="getDate"||options==="widget")){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs));}
if(options==="option"&&arguments.length===2&&typeof arguments[1]==="string"){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs));}
return this.each(function(){typeof options==="string"?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this].concat(otherArgs)):$.datepicker._attachDatepicker(this,options);});};$.datepicker=new Datepicker();$.datepicker.initialized=false;$.datepicker.uuid=new Date().getTime();$.datepicker.version="@VERSION";return $.datepicker;}));(function(factory){if(typeof define==="function"&&define.amd){define(["jquery","./core","./widget","./position"],factory);}else{factory(jQuery);}}(function($){return $.widget("ui.menu",{version:"@VERSION",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.mouseHandled=false;this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0});if(this.options.disabled){this.element.addClass("ui-state-disabled").attr("aria-disabled","true");}
this._on({"mousedown .ui-menu-item":function(event){event.preventDefault();},"click .ui-menu-item":function(event){var target=$(event.target);if(!this.mouseHandled&&target.not(".ui-state-disabled").length){this.select(event);if(!event.isPropagationStopped()){this.mouseHandled=true;}
if(target.has(".ui-menu").length){this.expand(event);}else if(!this.element.is(":focus")&&$(this.document[0].activeElement).closest(".ui-menu").length){this.element.trigger("focus",[true]);if(this.active&&this.active.parents(".ui-menu").length===1){clearTimeout(this.timer);}}}},"mouseenter .ui-menu-item":function(event){if(this.previousFilter){return;}
var target=$(event.currentTarget);target.siblings(".ui-state-active").removeClass("ui-state-active");this.focus(event,target);},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(event,keepActiveItem){var item=this.active||this.element.find(this.options.items).eq(0);if(!keepActiveItem){this.focus(event,item);}},blur:function(event){this._delay(function(){if(!$.contains(this.element[0],this.document[0].activeElement)){this.collapseAll(event);}});},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(event){if(this._closeOnDocumentClick(event)){this.collapseAll(event);}
this.mouseHandled=false;}});},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show();this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var elem=$(this);if(elem.data("ui-menu-submenu-carat")){elem.remove();}});this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content");},_keydown:function(event){var match,prev,character,skip,regex,preventDefault=true;function escape(value){return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");}
switch(event.keyCode){case $.ui.keyCode.PAGE_UP:this.previousPage(event);break;case $.ui.keyCode.PAGE_DOWN:this.nextPage(event);break;case $.ui.keyCode.HOME:this._move("first","first",event);break;case $.ui.keyCode.END:this._move("last","last",event);break;case $.ui.keyCode.UP:this.previous(event);break;case $.ui.keyCode.DOWN:this.next(event);break;case $.ui.keyCode.LEFT:this.collapse(event);break;case $.ui.keyCode.RIGHT:if(this.active&&!this.active.is(".ui-state-disabled")){this.expand(event);}
break;case $.ui.keyCode.ENTER:case $.ui.keyCode.SPACE:this._activate(event);break;case $.ui.keyCode.ESCAPE:this.collapse(event);break;default:preventDefault=false;prev=this.previousFilter||"";character=String.fromCharCode(event.keyCode);skip=false;clearTimeout(this.filterTimer);if(character===prev){skip=true;}else{character=prev+character;}
regex=new RegExp("^"+escape(character),"i");match=this.activeMenu.find(this.options.items).filter(function(){return regex.test($(this).text());});match=skip&&match.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):match;if(!match.length){character=String.fromCharCode(event.keyCode);regex=new RegExp("^"+escape(character),"i");match=this.activeMenu.find(this.options.items).filter(function(){return regex.test($(this).text());});}
if(match.length){this.focus(event,match);if(match.length>1){this.previousFilter=character;this.filterTimer=this._delay(function(){delete this.previousFilter;},1000);}else{delete this.previousFilter;}}else{delete this.previousFilter;}}
if(preventDefault){event.preventDefault();}},_activate:function(event){if(!this.active.is(".ui-state-disabled")){if(this.active.is("[aria-haspopup='true']")){this.expand(event);}else{this.select(event);}}},refresh:function(){var menus,items,that=this,icon=this.options.icons.submenu,submenus=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length);submenus.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var menu=$(this),item=menu.parent(),submenuCarat=$("<span>").addClass("ui-menu-icon ui-icon "+icon).data("ui-menu-submenu-carat",true);item.attr("aria-haspopup","true").prepend(submenuCarat);menu.attr("aria-labelledby",item.attr("id"));});menus=submenus.add(this.element);items=menus.find(this.options.items);items.not(".ui-menu-item").each(function(){var item=$(this);if(that._isDivider(item)){item.addClass("ui-widget-content ui-menu-divider");}});items.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()});items.filter(".ui-state-disabled").attr("aria-disabled","true");if(this.active&&!$.contains(this.element[0],this.active[0])){this.blur();}},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role];},_setOption:function(key,value){if(key==="icons"){this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(value.submenu);}
if(key==="disabled"){this.element.toggleClass("ui-state-disabled",!!value).attr("aria-disabled",value);}
this._super(key,value);},focus:function(event,item){var nested,focused;this.blur(event,event&&event.type==="focus");this._scrollIntoView(item);this.active=item.first();focused=this.active.addClass("ui-state-focus").removeClass("ui-state-active");if(this.options.role){this.element.attr("aria-activedescendant",focused.attr("id"));}
this.active.parent().closest(".ui-menu-item").addClass("ui-state-active");if(event&&event.type==="keydown"){this._close();}else{this.timer=this._delay(function(){this._close();},this.delay);}
nested=item.children(".ui-menu");if(nested.length&&event&&(/^mouse/.test(event.type))){this._startOpening(nested);}
this.activeMenu=item.parent();this._trigger("focus",event,{item:item});},_scrollIntoView:function(item){var borderTop,paddingTop,offset,scroll,elementHeight,itemHeight;if(this._hasScroll()){borderTop=parseFloat($.css(this.activeMenu[0],"borderTopWidth"))||0;paddingTop=parseFloat($.css(this.activeMenu[0],"paddingTop"))||0;offset=item.offset().top-this.activeMenu.offset().top-borderTop-paddingTop;scroll=this.activeMenu.scrollTop();elementHeight=this.activeMenu.height();itemHeight=item.outerHeight();if(offset<0){this.activeMenu.scrollTop(scroll+offset);}else if(offset+itemHeight>elementHeight){this.activeMenu.scrollTop(scroll+offset-elementHeight+itemHeight);}}},blur:function(event,fromFocus){if(!fromFocus){clearTimeout(this.timer);}
if(!this.active){return;}
this.active.removeClass("ui-state-focus");this.active=null;this._trigger("blur",event,{item:this.active});},_startOpening:function(submenu){clearTimeout(this.timer);if(submenu.attr("aria-hidden")!=="true"){return;}
this.timer=this._delay(function(){this._close();this._open(submenu);},this.delay);},_open:function(submenu){var position=$.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".ui-menu").not(submenu.parents(".ui-menu")).hide().attr("aria-hidden","true");submenu.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(position);},collapseAll:function(event,all){clearTimeout(this.timer);this.timer=this._delay(function(){var currentMenu=all?this.element:$(event&&event.target).closest(this.element.find(".ui-menu"));if(!currentMenu.length){currentMenu=this.element;}
this._close(currentMenu);this.blur(event);this.activeMenu=currentMenu;},this.delay);},_close:function(startMenu){if(!startMenu){startMenu=this.active?this.active.parent():this.element;}
startMenu.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active");},_closeOnDocumentClick:function(event){return!$(event.target).closest(".ui-menu").length;},_isDivider:function(item){return!/[^\-\u2014\u2013\s]/.test(item.text());},collapse:function(event){var newItem=this.active&&this.active.parent().closest(".ui-menu-item",this.element);if(newItem&&newItem.length){this._close();this.focus(event,newItem);}},expand:function(event){var newItem=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();if(newItem&&newItem.length){this._open(newItem.parent());this._delay(function(){this.focus(event,newItem);});}},next:function(event){this._move("next","first",event);},previous:function(event){this._move("prev","last",event);},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length;},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length;},_move:function(direction,filter,event){var next;if(this.active){if(direction==="first"||direction==="last"){next=this.active
[direction==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1);}else{next=this.active
[direction+"All"](".ui-menu-item").eq(0);}}
if(!next||!next.length||!this.active){next=this.activeMenu.find(this.options.items)[filter]();}
this.focus(event,next);},nextPage:function(event){var item,base,height;if(!this.active){this.next(event);return;}
if(this.isLastItem()){return;}
if(this._hasScroll()){base=this.active.offset().top;height=this.element.height();this.active.nextAll(".ui-menu-item").each(function(){item=$(this);return item.offset().top-base-height<0;});this.focus(event,item);}else{this.focus(event,this.activeMenu.find(this.options.items)
[!this.active?"first":"last"]());}},previousPage:function(event){var item,base,height;if(!this.active){this.next(event);return;}
if(this.isFirstItem()){return;}
if(this._hasScroll()){base=this.active.offset().top;height=this.element.height();this.active.prevAll(".ui-menu-item").each(function(){item=$(this);return item.offset().top-base+height>0;});this.focus(event,item);}else{this.focus(event,this.activeMenu.find(this.options.items).first());}},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight");},select:function(event){this.active=this.active||$(event.target).closest(".ui-menu-item");var ui={item:this.active};if(!this.active.has(".ui-menu").length){this.collapseAll(event,true);}
this._trigger("select",event,ui);}});}));(function(factory){if(typeof define==="function"&&define.amd){define(["jquery","./core","./mouse","./widget"],factory);}else{factory(jQuery);}}(function($){$.widget("ui.draggable",$.ui.mouse,{version:"@VERSION",widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false,drag:null,start:null,stop:null},_create:function(){if(this.options.helper==="original"){this._setPositionRelative();}
if(this.options.addClasses){this.element.addClass("ui-draggable");}
if(this.options.disabled){this.element.addClass("ui-draggable-disabled");}
this._setHandleClassName();this._mouseInit();},_setOption:function(key,value){this._super(key,value);if(key==="handle"){this._removeHandleClassName();this._setHandleClassName();}},_destroy:function(){if((this.helper||this.element).is(".ui-draggable-dragging")){this.destroyOnClear=true;return;}
this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._removeHandleClassName();this._mouseDestroy();},_mouseCapture:function(event){var o=this.options;this._blurActiveElement(event);if(this.helper||o.disabled||$(event.target).closest(".ui-resizable-handle").length>0){return false;}
this.handle=this._getHandle(event);if(!this.handle){return false;}
this._blockFrames(o.iframeFix===true?"iframe":o.iframeFix);return true;},_blockFrames:function(selector){this.iframeBlocks=this.document.find(selector).map(function(){var iframe=$(this);return $("<div>").css("position","absolute").appendTo(iframe.parent()).outerWidth(iframe.outerWidth()).outerHeight(iframe.outerHeight()).offset(iframe.offset())[0];});},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks;}},_blurActiveElement:function(event){var document=this.document[0];if(!this.handleElement.is(event.target)){return;}
try{if(document.activeElement&&document.activeElement.nodeName.toLowerCase()!=="body"){$(document.activeElement).blur();}}catch(error){}},_mouseStart:function(event){var o=this.options;this.helper=this._createHelper(event);this.helper.addClass("ui-draggable-dragging");this._cacheHelperProportions();if($.ui.ddmanager){$.ui.ddmanager.current=this;}
this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent(true);this.offsetParent=this.helper.offsetParent();this.hasFixedAncestor=this.helper.parents().filter(function(){return $(this).css("position")==="fixed";}).length>0;this.positionAbs=this.element.offset();this._refreshOffsets(event);this.originalPosition=this.position=this._generatePosition(event,false);this.originalPageX=event.pageX;this.originalPageY=event.pageY;(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));this._setContainment();if(this._trigger("start",event)===false){this._clear();return false;}
this._cacheHelperProportions();if($.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event);}
this._normalizeRightBottom();this._mouseDrag(event,true);if($.ui.ddmanager){$.ui.ddmanager.dragStart(this,event);}
return true;},_refreshOffsets:function(event){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:false,parent:this._getParentOffset(),relative:this._getRelativeOffset()};this.offset.click={left:event.pageX-this.offset.left,top:event.pageY-this.offset.top};},_mouseDrag:function(event,noPropagation){if(this.hasFixedAncestor){this.offset.parent=this._getParentOffset();}
this.position=this._generatePosition(event,true);this.positionAbs=this._convertPositionTo("absolute");if(!noPropagation){var ui=this._uiHash();if(this._trigger("drag",event,ui)===false){this._mouseUp({});return false;}
this.position=ui.position;}
this.helper[0].style.left=this.position.left+"px";this.helper[0].style.top=this.position.top+"px";if($.ui.ddmanager){$.ui.ddmanager.drag(this,event);}
return false;},_mouseStop:function(event){var that=this,dropped=false;if($.ui.ddmanager&&!this.options.dropBehaviour){dropped=$.ui.ddmanager.drop(this,event);}
if(this.dropped){dropped=this.dropped;this.dropped=false;}
if((this.options.revert==="invalid"&&!dropped)||(this.options.revert==="valid"&&dropped)||this.options.revert===true||($.isFunction(this.options.revert)&&this.options.revert.call(this.element,dropped))){$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(that._trigger("stop",event)!==false){that._clear();}});}else{if(this._trigger("stop",event)!==false){this._clear();}}
return false;},_mouseUp:function(event){this._unblockFrames();if($.ui.ddmanager){$.ui.ddmanager.dragStop(this,event);}
if(this.handleElement.is(event.target)){this.element.focus();}
return $.ui.mouse.prototype._mouseUp.call(this,event);},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({});}else{this._clear();}
return this;},_getHandle:function(event){return this.options.handle?!!$(event.target).closest(this.element.find(this.options.handle)).length:true;},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element;this.handleElement.addClass("ui-draggable-handle");},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle");},_createHelper:function(event){var o=this.options,helperIsFunction=$.isFunction(o.helper),helper=helperIsFunction?$(o.helper.apply(this.element[0],[event])):(o.helper==="clone"?this.element.clone().removeAttr("id"):this.element);if(!helper.parents("body").length){helper.appendTo((o.appendTo==="parent"?this.element[0].parentNode:o.appendTo));}
if(helperIsFunction&&helper[0]===this.element[0]){this._setPositionRelative();}
if(helper[0]!==this.element[0]&&!(/(fixed|absolute)/).test(helper.css("position"))){helper.css("position","absolute");}
return helper;},_setPositionRelative:function(){if(!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative";}},_adjustOffsetFromHelper:function(obj){if(typeof obj==="string"){obj=obj.split(" ");}
if($.isArray(obj)){obj={left:+obj[0],top:+obj[1]||0};}
if("left"in obj){this.offset.click.left=obj.left+this.margins.left;}
if("right"in obj){this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left;}
if("top"in obj){this.offset.click.top=obj.top+this.margins.top;}
if("bottom"in obj){this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top;}},_isRootNode:function(element){return(/(html|body)/i).test(element.tagName)||element===this.document[0];},_getParentOffset:function(){var po=this.offsetParent.offset(),document=this.document[0];if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])){po.left+=this.scrollParent.scrollLeft();po.top+=this.scrollParent.scrollTop();}
if(this._isRootNode(this.offsetParent[0])){po={top:0,left:0};}
return{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)};},_getRelativeOffset:function(){if(this.cssPosition!=="relative"){return{top:0,left:0};}
var p=this.element.position(),scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+(!scrollIsRootNode?this.scrollParent.scrollTop():0),left:p.left-(parseInt(this.helper.css("left"),10)||0)+(!scrollIsRootNode?this.scrollParent.scrollLeft():0)};},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)};},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};},_setContainment:function(){var isUserScrollable,c,ce,o=this.options,document=this.document[0];this.relativeContainer=null;if(!o.containment){this.containment=null;return;}
if(o.containment==="window"){this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,$(window).scrollTop()+($(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return;}
if(o.containment==="document"){this.containment=[0,0,$(document).width()-this.helperProportions.width-this.margins.left,($(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return;}
if(o.containment.constructor===Array){this.containment=o.containment;return;}
if(o.containment==="parent"){o.containment=this.helper[0].parentNode;}
c=$(o.containment);ce=c[0];if(!ce){return;}
isUserScrollable=/(scroll|auto)/.test(c.css("overflow"));this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(isUserScrollable?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-
(parseInt(c.css("borderRightWidth"),10)||0)-
(parseInt(c.css("paddingRight"),10)||0)-
this.helperProportions.width-
this.margins.left-
this.margins.right,(isUserScrollable?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-
(parseInt(c.css("borderBottomWidth"),10)||0)-
(parseInt(c.css("paddingBottom"),10)||0)-
this.helperProportions.height-
this.margins.top-
this.margins.bottom];this.relativeContainer=c;},_convertPositionTo:function(d,pos){if(!pos){pos=this.position;}
var mod=d==="absolute"?1:-1,scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:(pos.top+
this.offset.relative.top*mod+
this.offset.parent.top*mod-
((this.cssPosition==="fixed"?-this.offset.scroll.top:(scrollIsRootNode?0:this.offset.scroll.top))*mod)),left:(pos.left+
this.offset.relative.left*mod+
this.offset.parent.left*mod-
((this.cssPosition==="fixed"?-this.offset.scroll.left:(scrollIsRootNode?0:this.offset.scroll.left))*mod))};},_generatePosition:function(event,constrainPosition){var containment,co,top,left,o=this.options,scrollIsRootNode=this._isRootNode(this.scrollParent[0]),pageX=event.pageX,pageY=event.pageY;if(!scrollIsRootNode||!this.offset.scroll){this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()};}
if(constrainPosition){if(this.containment){if(this.relativeContainer){co=this.relativeContainer.offset();containment=[this.containment[0]+co.left,this.containment[1]+co.top,this.containment[2]+co.left,this.containment[3]+co.top];}else{containment=this.containment;}
if(event.pageX-this.offset.click.left<containment[0]){pageX=containment[0]+this.offset.click.left;}
if(event.pageY-this.offset.click.top<containment[1]){pageY=containment[1]+this.offset.click.top;}
if(event.pageX-this.offset.click.left>containment[2]){pageX=containment[2]+this.offset.click.left;}
if(event.pageY-this.offset.click.top>containment[3]){pageY=containment[3]+this.offset.click.top;}}
if(o.grid){top=o.grid[1]?this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY;pageY=containment?((top-this.offset.click.top>=containment[1]||top-this.offset.click.top>containment[3])?top:((top-this.offset.click.top>=containment[1])?top-o.grid[1]:top+o.grid[1])):top;left=o.grid[0]?this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX;pageX=containment?((left-this.offset.click.left>=containment[0]||left-this.offset.click.left>containment[2])?left:((left-this.offset.click.left>=containment[0])?left-o.grid[0]:left+o.grid[0])):left;}
if(o.axis==="y"){pageX=this.originalPageX;}
if(o.axis==="x"){pageY=this.originalPageY;}}
return{top:(pageY-
this.offset.click.top-
this.offset.relative.top-
this.offset.parent.top+
(this.cssPosition==="fixed"?-this.offset.scroll.top:(scrollIsRootNode?0:this.offset.scroll.top))),left:(pageX-
this.offset.click.left-
this.offset.relative.left-
this.offset.parent.left+
(this.cssPosition==="fixed"?-this.offset.scroll.left:(scrollIsRootNode?0:this.offset.scroll.left)))};},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval){this.helper.remove();}
this.helper=null;this.cancelHelperRemoval=false;if(this.destroyOnClear){this.destroy();}},_normalizeRightBottom:function(){if(this.options.axis!=="y"&&this.helper.css("right")!=="auto"){this.helper.width(this.helper.width());this.helper.css("right","auto");}
if(this.options.axis!=="x"&&this.helper.css("bottom")!=="auto"){this.helper.height(this.helper.height());this.helper.css("bottom","auto");}},_trigger:function(type,event,ui){ui=ui||this._uiHash();$.ui.plugin.call(this,type,[event,ui,this],true);if(/^(drag|start|stop)/.test(type)){this.positionAbs=this._convertPositionTo("absolute");ui.offset=this.positionAbs;}
return $.Widget.prototype._trigger.call(this,type,event,ui);},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs};}});$.ui.plugin.add("draggable","connectToSortable",{start:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.sortables=[];$(draggable.options.connectToSortable).each(function(){var sortable=$(this).sortable("instance");if(sortable&&!sortable.options.disabled){draggable.sortables.push(sortable);sortable.refreshPositions();sortable._trigger("activate",event,uiSortable);}});},stop:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.cancelHelperRemoval=false;$.each(draggable.sortables,function(){var sortable=this;if(sortable.isOver){sortable.isOver=0;draggable.cancelHelperRemoval=true;sortable.cancelHelperRemoval=false;sortable._storedCSS={position:sortable.placeholder.css("position"),top:sortable.placeholder.css("top"),left:sortable.placeholder.css("left")};sortable._mouseStop(event);sortable.options.helper=sortable.options._helper;}else{sortable.cancelHelperRemoval=true;sortable._trigger("deactivate",event,uiSortable);}});},drag:function(event,ui,draggable){$.each(draggable.sortables,function(){var innermostIntersecting=false,sortable=this;sortable.positionAbs=draggable.positionAbs;sortable.helperProportions=draggable.helperProportions;sortable.offset.click=draggable.offset.click;if(sortable._intersectsWith(sortable.containerCache)){innermostIntersecting=true;$.each(draggable.sortables,function(){this.positionAbs=draggable.positionAbs;this.helperProportions=draggable.helperProportions;this.offset.click=draggable.offset.click;if(this!==sortable&&this._intersectsWith(this.containerCache)&&$.contains(sortable.element[0],this.element[0])){innermostIntersecting=false;}
return innermostIntersecting;});}
if(innermostIntersecting){if(!sortable.isOver){sortable.isOver=1;sortable.currentItem=ui.helper.appendTo(sortable.element).data("ui-sortable-item",true);sortable.options._helper=sortable.options.helper;sortable.options.helper=function(){return ui.helper[0];};event.target=sortable.currentItem[0];sortable._mouseCapture(event,true);sortable._mouseStart(event,true,true);sortable.offset.click.top=draggable.offset.click.top;sortable.offset.click.left=draggable.offset.click.left;sortable.offset.parent.left-=draggable.offset.parent.left-
sortable.offset.parent.left;sortable.offset.parent.top-=draggable.offset.parent.top-
sortable.offset.parent.top;draggable._trigger("toSortable",event);draggable.dropped=sortable.element;$.each(draggable.sortables,function(){this.refreshPositions();});draggable.currentItem=draggable.element;sortable.fromOutside=draggable;}
if(sortable.currentItem){sortable._mouseDrag(event);ui.position=sortable.position;}}else{if(sortable.isOver){sortable.isOver=0;sortable.cancelHelperRemoval=true;sortable.options._revert=sortable.options.revert;sortable.options.revert=false;sortable._trigger("out",event,sortable._uiHash(sortable));sortable._mouseStop(event,true);sortable.options.revert=sortable.options._revert;sortable.options.helper=sortable.options._helper;if(sortable.placeholder){sortable.placeholder.remove();}
draggable._refreshOffsets(event);ui.position=draggable._generatePosition(event,true);draggable._trigger("fromSortable",event);draggable.dropped=false;$.each(draggable.sortables,function(){this.refreshPositions();});}}});}});$.ui.plugin.add("draggable","cursor",{start:function(event,ui,instance){var t=$("body"),o=instance.options;if(t.css("cursor")){o._cursor=t.css("cursor");}
t.css("cursor",o.cursor);},stop:function(event,ui,instance){var o=instance.options;if(o._cursor){$("body").css("cursor",o._cursor);}}});$.ui.plugin.add("draggable","opacity",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;if(t.css("opacity")){o._opacity=t.css("opacity");}
t.css("opacity",o.opacity);},stop:function(event,ui,instance){var o=instance.options;if(o._opacity){$(ui.helper).css("opacity",o._opacity);}}});$.ui.plugin.add("draggable","scroll",{start:function(event,ui,i){if(!i.scrollParentNotHidden){i.scrollParentNotHidden=i.helper.scrollParent(false);}
if(i.scrollParentNotHidden[0]!==i.document[0]&&i.scrollParentNotHidden[0].tagName!=="HTML"){i.overflowOffset=i.scrollParentNotHidden.offset();}},drag:function(event,ui,i){var o=i.options,scrolled=false,scrollParent=i.scrollParentNotHidden[0],document=i.document[0];if(scrollParent!==document&&scrollParent.tagName!=="HTML"){if(!o.axis||o.axis!=="x"){if((i.overflowOffset.top+scrollParent.offsetHeight)-event.pageY<o.scrollSensitivity){scrollParent.scrollTop=scrolled=scrollParent.scrollTop+o.scrollSpeed;}else if(event.pageY-i.overflowOffset.top<o.scrollSensitivity){scrollParent.scrollTop=scrolled=scrollParent.scrollTop-o.scrollSpeed;}}
if(!o.axis||o.axis!=="y"){if((i.overflowOffset.left+scrollParent.offsetWidth)-event.pageX<o.scrollSensitivity){scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft+o.scrollSpeed;}else if(event.pageX-i.overflowOffset.left<o.scrollSensitivity){scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft-o.scrollSpeed;}}}else{if(!o.axis||o.axis!=="x"){if(event.pageY-$(document).scrollTop()<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed);}else if($(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed);}}
if(!o.axis||o.axis!=="y"){if(event.pageX-$(document).scrollLeft()<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed);}else if($(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed);}}}
if(scrolled!==false&&$.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(i,event);}}});$.ui.plugin.add("draggable","snap",{start:function(event,ui,i){var o=i.options;i.snapElements=[];$(o.snap.constructor!==String?(o.snap.items||":data(ui-draggable)"):o.snap).each(function(){var $t=$(this),$o=$t.offset();if(this!==i.element[0]){i.snapElements.push({item:this,width:$t.outerWidth(),height:$t.outerHeight(),top:$o.top,left:$o.left});}});},drag:function(event,ui,inst){var ts,bs,ls,rs,l,r,t,b,i,first,o=inst.options,d=o.snapTolerance,x1=ui.offset.left,x2=x1+inst.helperProportions.width,y1=ui.offset.top,y2=y1+inst.helperProportions.height;for(i=inst.snapElements.length-1;i>=0;i--){l=inst.snapElements[i].left-inst.margins.left;r=l+inst.snapElements[i].width;t=inst.snapElements[i].top-inst.margins.top;b=t+inst.snapElements[i].height;if(x2<l-d||x1>r+d||y2<t-d||y1>b+d||!$.contains(inst.snapElements[i].item.ownerDocument,inst.snapElements[i].item)){if(inst.snapElements[i].snapping){(inst.options.snap.release&&inst.options.snap.release.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})));}
inst.snapElements[i].snapping=false;continue;}
if(o.snapMode!=="inner"){ts=Math.abs(t-y2)<=d;bs=Math.abs(b-y1)<=d;ls=Math.abs(l-x2)<=d;rs=Math.abs(r-x1)<=d;if(ts){ui.position.top=inst._convertPositionTo("relative",{top:t-inst.helperProportions.height,left:0}).top;}
if(bs){ui.position.top=inst._convertPositionTo("relative",{top:b,left:0}).top;}
if(ls){ui.position.left=inst._convertPositionTo("relative",{top:0,left:l-inst.helperProportions.width}).left;}
if(rs){ui.position.left=inst._convertPositionTo("relative",{top:0,left:r}).left;}}
first=(ts||bs||ls||rs);if(o.snapMode!=="outer"){ts=Math.abs(t-y1)<=d;bs=Math.abs(b-y2)<=d;ls=Math.abs(l-x1)<=d;rs=Math.abs(r-x2)<=d;if(ts){ui.position.top=inst._convertPositionTo("relative",{top:t,left:0}).top;}
if(bs){ui.position.top=inst._convertPositionTo("relative",{top:b-inst.helperProportions.height,left:0}).top;}
if(ls){ui.position.left=inst._convertPositionTo("relative",{top:0,left:l}).left;}
if(rs){ui.position.left=inst._convertPositionTo("relative",{top:0,left:r-inst.helperProportions.width}).left;}}
if(!inst.snapElements[i].snapping&&(ts||bs||ls||rs||first)){(inst.options.snap.snap&&inst.options.snap.snap.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})));}
inst.snapElements[i].snapping=(ts||bs||ls||rs||first);}}});$.ui.plugin.add("draggable","stack",{start:function(event,ui,instance){var min,o=instance.options,group=$.makeArray($(o.stack)).sort(function(a,b){return(parseInt($(a).css("zIndex"),10)||0)-(parseInt($(b).css("zIndex"),10)||0);});if(!group.length){return;}
min=parseInt($(group[0]).css("zIndex"),10)||0;$(group).each(function(i){$(this).css("zIndex",min+i);});this.css("zIndex",(min+group.length));}});$.ui.plugin.add("draggable","zIndex",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;if(t.css("zIndex")){o._zIndex=t.css("zIndex");}
t.css("zIndex",o.zIndex);},stop:function(event,ui,instance){var o=instance.options;if(o._zIndex){$(ui.helper).css("zIndex",o._zIndex);}}});return $.ui.draggable;}));(function(factory){if(typeof define==="function"&&define.amd){define(["jquery","./core","./widget","./mouse","./draggable"],factory);}else{factory(jQuery);}}(function($){$.widget("ui.droppable",{version:"@VERSION",widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var proportions,o=this.options,accept=o.accept;this.isover=false;this.isout=true;this.accept=$.isFunction(accept)?accept:function(d){return d.is(accept);};this.proportions=function(){if(arguments.length){proportions=arguments[0];}else{return proportions?proportions:proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};}};this._addToManager(o.scope);o.addClasses&&this.element.addClass("ui-droppable");},_addToManager:function(scope){$.ui.ddmanager.droppables[scope]=$.ui.ddmanager.droppables[scope]||[];$.ui.ddmanager.droppables[scope].push(this);},_splice:function(drop){var i=0;for(;i<drop.length;i++){if(drop[i]===this){drop.splice(i,1);}}},_destroy:function(){var drop=$.ui.ddmanager.droppables[this.options.scope];this._splice(drop);this.element.removeClass("ui-droppable ui-droppable-disabled");},_setOption:function(key,value){if(key==="accept"){this.accept=$.isFunction(value)?value:function(d){return d.is(value);};}else if(key==="scope"){var drop=$.ui.ddmanager.droppables[this.options.scope];this._splice(drop);this._addToManager(value);}
this._super(key,value);},_activate:function(event){var draggable=$.ui.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass);}
if(draggable){this._trigger("activate",event,this.ui(draggable));}},_deactivate:function(event){var draggable=$.ui.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass);}
if(draggable){this._trigger("deactivate",event,this.ui(draggable));}},_over:function(event){var draggable=$.ui.ddmanager.current;if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){return;}
if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass);}
this._trigger("over",event,this.ui(draggable));}},_out:function(event){var draggable=$.ui.ddmanager.current;if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){return;}
if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass);}
this._trigger("out",event,this.ui(draggable));}},_drop:function(event,custom){var draggable=custom||$.ui.ddmanager.current,childrenIntersection=false;if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){return false;}
this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var inst=$(this).droppable("instance");if(inst.options.greedy&&!inst.options.disabled&&inst.options.scope===draggable.options.scope&&inst.accept.call(inst.element[0],(draggable.currentItem||draggable.element))&&$.ui.intersect(draggable,$.extend(inst,{offset:inst.element.offset()}),inst.options.tolerance,event)){childrenIntersection=true;return false;}});if(childrenIntersection){return false;}
if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){if(this.options.activeClass){this.element.removeClass(this.options.activeClass);}
if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass);}
this._trigger("drop",event,this.ui(draggable));return this.element;}
return false;},ui:function(c){return{draggable:(c.currentItem||c.element),helper:c.helper,position:c.position,offset:c.positionAbs};}});$.ui.intersect=(function(){function isOverAxis(x,reference,size){return(x>=reference)&&(x<(reference+size));}
return function(draggable,droppable,toleranceMode,event){if(!droppable.offset){return false;}
var x1=(draggable.positionAbs||draggable.position.absolute).left+draggable.margins.left,y1=(draggable.positionAbs||draggable.position.absolute).top+draggable.margins.top,x2=x1+draggable.helperProportions.width,y2=y1+draggable.helperProportions.height,l=droppable.offset.left,t=droppable.offset.top,r=l+droppable.proportions().width,b=t+droppable.proportions().height;switch(toleranceMode){case"fit":return(l<=x1&&x2<=r&&t<=y1&&y2<=b);case"intersect":return(l<x1+(draggable.helperProportions.width/2)&&x2-(draggable.helperProportions.width/2)<r&&t<y1+(draggable.helperProportions.height/2)&&y2-(draggable.helperProportions.height/2)<b);case"pointer":return isOverAxis(event.pageY,t,droppable.proportions().height)&&isOverAxis(event.pageX,l,droppable.proportions().width);case"touch":return((y1>=t&&y1<=b)||(y2>=t&&y2<=b)||(y1<t&&y2>b))&&((x1>=l&&x1<=r)||(x2>=l&&x2<=r)||(x1<l&&x2>r));default:return false;}};})();$.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,event){var i,j,m=$.ui.ddmanager.droppables[t.options.scope]||[],type=event?event.type:null,list=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();droppablesLoop:for(i=0;i<m.length;i++){if(m[i].options.disabled||(t&&!m[i].accept.call(m[i].element[0],(t.currentItem||t.element)))){continue;}
for(j=0;j<list.length;j++){if(list[j]===m[i].element[0]){m[i].proportions().height=0;continue droppablesLoop;}}
m[i].visible=m[i].element.css("display")!=="none";if(!m[i].visible){continue;}
if(type==="mousedown"){m[i]._activate.call(m[i],event);}
m[i].offset=m[i].element.offset();m[i].proportions({width:m[i].element[0].offsetWidth,height:m[i].element[0].offsetHeight});}},drop:function(draggable,event){var dropped=false;$.each(($.ui.ddmanager.droppables[draggable.options.scope]||[]).slice(),function(){if(!this.options){return;}
if(!this.options.disabled&&this.visible&&$.ui.intersect(draggable,this,this.options.tolerance,event)){dropped=this._drop.call(this,event)||dropped;}
if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){this.isout=true;this.isover=false;this._deactivate.call(this,event);}});return dropped;},dragStart:function(draggable,event){draggable.element.parentsUntil("body").bind("scroll.droppable",function(){if(!draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event);}});},drag:function(draggable,event){if(draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event);}
$.each($.ui.ddmanager.droppables[draggable.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return;}
var parentInstance,scope,parent,intersects=$.ui.intersect(draggable,this,this.options.tolerance,event),c=!intersects&&this.isover?"isout":(intersects&&!this.isover?"isover":null);if(!c){return;}
if(this.options.greedy){scope=this.options.scope;parent=this.element.parents(":data(ui-droppable)").filter(function(){return $(this).droppable("instance").options.scope===scope;});if(parent.length){parentInstance=$(parent[0]).droppable("instance");parentInstance.greedyChild=(c==="isover");}}
if(parentInstance&&c==="isover"){parentInstance.isover=false;parentInstance.isout=true;parentInstance._out.call(parentInstance,event);}
this[c]=true;this[c==="isout"?"isover":"isout"]=false;this[c==="isover"?"_over":"_out"].call(this,event);if(parentInstance&&c==="isout"){parentInstance.isout=false;parentInstance.isover=true;parentInstance._over.call(parentInstance,event);}});},dragStop:function(draggable,event){draggable.element.parentsUntil("body").unbind("scroll.droppable");if(!draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event);}}};return $.ui.droppable;}));(function(factory){if(typeof define==="function"&&define.amd){define(["jquery","./core","./mouse","./widget"],factory);}else{factory(jQuery);}}(function($){$.widget("ui.resizable",$.ui.mouse,{version:"@VERSION",widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(value){return parseInt(value,10)||0;},_isNumber:function(value){return!isNaN(parseInt(value,10));},_hasScroll:function(el,a){if($(el).css("overflow")==="hidden"){return false;}
var scroll=(a&&a==="left")?"scrollLeft":"scrollTop",has=false;if(el[scroll]>0){return true;}
el[scroll]=1;has=(el[scroll]>0);el[scroll]=0;return has;},_create:function(){var n,i,handle,axis,hname,that=this,o=this.options;this.element.addClass("ui-resizable");$.extend(this,{_aspectRatio:!!(o.aspectRatio),aspectRatio:o.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:o.helper||o.ghost||o.animate?o.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){this.element.wrap($("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize();}
this.handles=o.handles||(!$(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor===String){if(this.handles==="all"){this.handles="n,e,s,w,se,sw,ne,nw";}
n=this.handles.split(",");this.handles={};for(i=0;i<n.length;i++){handle=$.trim(n[i]);hname="ui-resizable-"+handle;axis=$("<div class='ui-resizable-handle "+hname+"'></div>");axis.css({zIndex:o.zIndex});if("se"===handle){axis.addClass("ui-icon ui-icon-gripsmall-diagonal-se");}
this.handles[handle]=".ui-resizable-"+handle;this.element.append(axis);}}
this._renderAxis=function(target){var i,axis,padPos,padWrapper;target=target||this.element;for(i in this.handles){if(this.handles[i].constructor===String){this.handles[i]=this.element.children(this.handles[i]).first().show();}
if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){axis=$(this.handles[i],this.element);padWrapper=/sw|ne|nw|se|n|s/.test(i)?axis.outerHeight():axis.outerWidth();padPos=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join("");target.css(padPos,padWrapper);this._proportionallyResize();}
if(!$(this.handles[i]).length){continue;}}};this._renderAxis(this.element);this._handles=$(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!that.resizing){if(this.className){axis=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);}
that.axis=axis&&axis[1]?axis[1]:"se";}});if(o.autoHide){this._handles.hide();$(this.element).addClass("ui-resizable-autohide").mouseenter(function(){if(o.disabled){return;}
$(this).removeClass("ui-resizable-autohide");that._handles.show();}).mouseleave(function(){if(o.disabled){return;}
if(!that.resizing){$(this).addClass("ui-resizable-autohide");that._handles.hide();}});}
this._mouseInit();},_destroy:function(){this._mouseDestroy();var wrapper,_destroy=function(exp){$(exp).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove();};if(this.elementIsWrapper){_destroy(this.element);wrapper=this.element;this.originalElement.css({position:wrapper.css("position"),width:wrapper.outerWidth(),height:wrapper.outerHeight(),top:wrapper.css("top"),left:wrapper.css("left")}).insertAfter(wrapper);wrapper.remove();}
this.originalElement.css("resize",this.originalResizeStyle);_destroy(this.originalElement);return this;},_mouseCapture:function(event){var i,handle,capture=false;for(i in this.handles){handle=$(this.handles[i])[0];if(handle===event.target||$.contains(handle,event.target)){capture=true;}}
return!this.options.disabled&&capture;},_mouseStart:function(event){var curleft,curtop,cursor,o=this.options,el=this.element;this.resizing=true;this._renderProxy();curleft=this._num(this.helper.css("left"));curtop=this._num(this.helper.css("top"));if(o.containment){curleft+=$(o.containment).scrollLeft()||0;curtop+=$(o.containment).scrollTop()||0;}
this.offset=this.helper.offset();this.position={left:curleft,top:curtop};this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:el.width(),height:el.height()};this.originalSize=this._helper?{width:el.outerWidth(),height:el.outerHeight()}:{width:el.width(),height:el.height()};this.sizeDiff={width:el.outerWidth()-el.width(),height:el.outerHeight()-el.height()};this.originalPosition={left:curleft,top:curtop};this.originalMousePosition={left:event.pageX,top:event.pageY};this.aspectRatio=(typeof o.aspectRatio==="number")?o.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);cursor=$(".ui-resizable-"+this.axis).css("cursor");$("body").css("cursor",cursor==="auto"?this.axis+"-resize":cursor);el.addClass("ui-resizable-resizing");this._propagate("start",event);return true;},_mouseDrag:function(event){var data,props,smp=this.originalMousePosition,a=this.axis,dx=(event.pageX-smp.left)||0,dy=(event.pageY-smp.top)||0,trigger=this._change[a];this._updatePrevProperties();if(!trigger){return false;}
data=trigger.apply(this,[event,dx,dy]);this._updateVirtualBoundaries(event.shiftKey);if(this._aspectRatio||event.shiftKey){data=this._updateRatio(data,event);}
data=this._respectSize(data,event);this._updateCache(data);this._propagate("resize",event);props=this._applyChanges();if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize();}
if(!$.isEmptyObject(props)){this._updatePrevProperties();this._trigger("resize",event,this.ui());this._applyChanges();}
return false;},_mouseStop:function(event){this.resizing=false;var pr,ista,soffseth,soffsetw,s,left,top,o=this.options,that=this;if(this._helper){pr=this._proportionallyResizeElements;ista=pr.length&&(/textarea/i).test(pr[0].nodeName);soffseth=ista&&this._hasScroll(pr[0],"left")?0:that.sizeDiff.height;soffsetw=ista?0:that.sizeDiff.width;s={width:(that.helper.width()-soffsetw),height:(that.helper.height()-soffseth)};left=(parseInt(that.element.css("left"),10)+
(that.position.left-that.originalPosition.left))||null;top=(parseInt(that.element.css("top"),10)+
(that.position.top-that.originalPosition.top))||null;if(!o.animate){this.element.css($.extend(s,{top:top,left:left}));}
that.helper.height(that.size.height);that.helper.width(that.size.width);if(this._helper&&!o.animate){this._proportionallyResize();}}
$("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",event);if(this._helper){this.helper.remove();}
return false;},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left};this.prevSize={width:this.size.width,height:this.size.height};},_applyChanges:function(){var props={};if(this.position.top!==this.prevPosition.top){props.top=this.position.top+"px";}
if(this.position.left!==this.prevPosition.left){props.left=this.position.left+"px";}
if(this.size.width!==this.prevSize.width){props.width=this.size.width+"px";}
if(this.size.height!==this.prevSize.height){props.height=this.size.height+"px";}
this.helper.css(props);return props;},_updateVirtualBoundaries:function(forceAspectRatio){var pMinWidth,pMaxWidth,pMinHeight,pMaxHeight,b,o=this.options;b={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:Infinity,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:Infinity};if(this._aspectRatio||forceAspectRatio){pMinWidth=b.minHeight*this.aspectRatio;pMinHeight=b.minWidth/this.aspectRatio;pMaxWidth=b.maxHeight*this.aspectRatio;pMaxHeight=b.maxWidth/this.aspectRatio;if(pMinWidth>b.minWidth){b.minWidth=pMinWidth;}
if(pMinHeight>b.minHeight){b.minHeight=pMinHeight;}
if(pMaxWidth<b.maxWidth){b.maxWidth=pMaxWidth;}
if(pMaxHeight<b.maxHeight){b.maxHeight=pMaxHeight;}}
this._vBoundaries=b;},_updateCache:function(data){this.offset=this.helper.offset();if(this._isNumber(data.left)){this.position.left=data.left;}
if(this._isNumber(data.top)){this.position.top=data.top;}
if(this._isNumber(data.height)){this.size.height=data.height;}
if(this._isNumber(data.width)){this.size.width=data.width;}},_updateRatio:function(data){var cpos=this.position,csize=this.size,a=this.axis;if(this._isNumber(data.height)){data.width=(data.height*this.aspectRatio);}else if(this._isNumber(data.width)){data.height=(data.width/this.aspectRatio);}
if(a==="sw"){data.left=cpos.left+(csize.width-data.width);data.top=null;}
if(a==="nw"){data.top=cpos.top+(csize.height-data.height);data.left=cpos.left+(csize.width-data.width);}
return data;},_respectSize:function(data){var o=this._vBoundaries,a=this.axis,ismaxw=this._isNumber(data.width)&&o.maxWidth&&(o.maxWidth<data.width),ismaxh=this._isNumber(data.height)&&o.maxHeight&&(o.maxHeight<data.height),isminw=this._isNumber(data.width)&&o.minWidth&&(o.minWidth>data.width),isminh=this._isNumber(data.height)&&o.minHeight&&(o.minHeight>data.height),dw=this.originalPosition.left+this.originalSize.width,dh=this.position.top+this.size.height,cw=/sw|nw|w/.test(a),ch=/nw|ne|n/.test(a);if(isminw){data.width=o.minWidth;}
if(isminh){data.height=o.minHeight;}
if(ismaxw){data.width=o.maxWidth;}
if(ismaxh){data.height=o.maxHeight;}
if(isminw&&cw){data.left=dw-o.minWidth;}
if(ismaxw&&cw){data.left=dw-o.maxWidth;}
if(isminh&&ch){data.top=dh-o.minHeight;}
if(ismaxh&&ch){data.top=dh-o.maxHeight;}
if(!data.width&&!data.height&&!data.left&&data.top){data.top=null;}else if(!data.width&&!data.height&&!data.top&&data.left){data.left=null;}
return data;},_getPaddingPlusBorderDimensions:function(element){var i=0,widths=[],borders=[element.css("borderTopWidth"),element.css("borderRightWidth"),element.css("borderBottomWidth"),element.css("borderLeftWidth")],paddings=[element.css("paddingTop"),element.css("paddingRight"),element.css("paddingBottom"),element.css("paddingLeft")];for(;i<4;i++){widths[i]=(parseInt(borders[i],10)||0);widths[i]+=(parseInt(paddings[i],10)||0);}
return{height:widths[0]+widths[2],width:widths[1]+widths[3]};},_proportionallyResize:function(){if(!this._proportionallyResizeElements.length){return;}
var prel,i=0,element=this.helper||this.element;for(;i<this._proportionallyResizeElements.length;i++){prel=this._proportionallyResizeElements[i];if(!this.outerDimensions){this.outerDimensions=this._getPaddingPlusBorderDimensions(prel);}
prel.css({height:(element.height()-this.outerDimensions.height)||0,width:(element.width()-this.outerDimensions.width)||0});}},_renderProxy:function(){var el=this.element,o=this.options;this.elementOffset=el.offset();if(this._helper){this.helper=this.helper||$("<div style='overflow:hidden;'></div>");this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++o.zIndex});this.helper.appendTo("body").disableSelection();}else{this.helper=this.element;}},_change:{e:function(event,dx){return{width:this.originalSize.width+dx};},w:function(event,dx){var cs=this.originalSize,sp=this.originalPosition;return{left:sp.left+dx,width:cs.width-dx};},n:function(event,dx,dy){var cs=this.originalSize,sp=this.originalPosition;return{top:sp.top+dy,height:cs.height-dy};},s:function(event,dx,dy){return{height:this.originalSize.height+dy};},se:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]));},sw:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]));},ne:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]));},nw:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]));}},_propagate:function(n,event){$.ui.plugin.call(this,n,[event,this.ui()]);(n!=="resize"&&this._trigger(n,event,this.ui()));},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition};}});$.ui.plugin.add("resizable","animate",{stop:function(event){var that=$(this).resizable("instance"),o=that.options,pr=that._proportionallyResizeElements,ista=pr.length&&(/textarea/i).test(pr[0].nodeName),soffseth=ista&&that._hasScroll(pr[0],"left")?0:that.sizeDiff.height,soffsetw=ista?0:that.sizeDiff.width,style={width:(that.size.width-soffsetw),height:(that.size.height-soffseth)},left=(parseInt(that.element.css("left"),10)+
(that.position.left-that.originalPosition.left))||null,top=(parseInt(that.element.css("top"),10)+
(that.position.top-that.originalPosition.top))||null;that.element.animate($.extend(style,top&&left?{top:top,left:left}:{}),{duration:o.animateDuration,easing:o.animateEasing,step:function(){var data={width:parseInt(that.element.css("width"),10),height:parseInt(that.element.css("height"),10),top:parseInt(that.element.css("top"),10),left:parseInt(that.element.css("left"),10)};if(pr&&pr.length){$(pr[0]).css({width:data.width,height:data.height});}
that._updateCache(data);that._propagate("resize",event);}});}});$.ui.plugin.add("resizable","containment",{start:function(){var element,p,co,ch,cw,width,height,that=$(this).resizable("instance"),o=that.options,el=that.element,oc=o.containment,ce=(oc instanceof $)?oc.get(0):(/parent/.test(oc))?el.parent().get(0):oc;if(!ce){return;}
that.containerElement=$(ce);if(/document/.test(oc)||oc===document){that.containerOffset={left:0,top:0};that.containerPosition={left:0,top:0};that.parentData={element:$(document),left:0,top:0,width:$(document).width(),height:$(document).height()||document.body.parentNode.scrollHeight};}else{element=$(ce);p=[];$(["Top","Right","Left","Bottom"]).each(function(i,name){p[i]=that._num(element.css("padding"+name));});that.containerOffset=element.offset();that.containerPosition=element.position();that.containerSize={height:(element.innerHeight()-p[3]),width:(element.innerWidth()-p[1])};co=that.containerOffset;ch=that.containerSize.height;cw=that.containerSize.width;width=(that._hasScroll(ce,"left")?ce.scrollWidth:cw);height=(that._hasScroll(ce)?ce.scrollHeight:ch);that.parentData={element:ce,left:co.left,top:co.top,width:width,height:height};}},resize:function(event){var woset,hoset,isParent,isOffsetRelative,that=$(this).resizable("instance"),o=that.options,co=that.containerOffset,cp=that.position,pRatio=that._aspectRatio||event.shiftKey,cop={top:0,left:0},ce=that.containerElement,continueResize=true;if(ce[0]!==document&&(/static/).test(ce.css("position"))){cop=co;}
if(cp.left<(that._helper?co.left:0)){that.size.width=that.size.width+
(that._helper?(that.position.left-co.left):(that.position.left-cop.left));if(pRatio){that.size.height=that.size.width/that.aspectRatio;continueResize=false;}
that.position.left=o.helper?co.left:0;}
if(cp.top<(that._helper?co.top:0)){that.size.height=that.size.height+
(that._helper?(that.position.top-co.top):that.position.top);if(pRatio){that.size.width=that.size.height*that.aspectRatio;continueResize=false;}
that.position.top=that._helper?co.top:0;}
isParent=that.containerElement.get(0)===that.element.parent().get(0);isOffsetRelative=/relative|absolute/.test(that.containerElement.css("position"));if(isParent&&isOffsetRelative){that.offset.left=that.parentData.left+that.position.left;that.offset.top=that.parentData.top+that.position.top;}else{that.offset.left=that.element.offset().left;that.offset.top=that.element.offset().top;}
woset=Math.abs(that.sizeDiff.width+
(that._helper?that.offset.left-cop.left:(that.offset.left-co.left)));hoset=Math.abs(that.sizeDiff.height+
(that._helper?that.offset.top-cop.top:(that.offset.top-co.top)));if(woset+that.size.width>=that.parentData.width){that.size.width=that.parentData.width-woset;if(pRatio){that.size.height=that.size.width/that.aspectRatio;continueResize=false;}}
if(hoset+that.size.height>=that.parentData.height){that.size.height=that.parentData.height-hoset;if(pRatio){that.size.width=that.size.height*that.aspectRatio;continueResize=false;}}
if(!continueResize){that.position.left=that.prevPosition.left;that.position.top=that.prevPosition.top;that.size.width=that.prevSize.width;that.size.height=that.prevSize.height;}},stop:function(){var that=$(this).resizable("instance"),o=that.options,co=that.containerOffset,cop=that.containerPosition,ce=that.containerElement,helper=$(that.helper),ho=helper.offset(),w=helper.outerWidth()-that.sizeDiff.width,h=helper.outerHeight()-that.sizeDiff.height;if(that._helper&&!o.animate&&(/relative/).test(ce.css("position"))){$(this).css({left:ho.left-cop.left-co.left,width:w,height:h});}
if(that._helper&&!o.animate&&(/static/).test(ce.css("position"))){$(this).css({left:ho.left-cop.left-co.left,width:w,height:h});}}});$.ui.plugin.add("resizable","alsoResize",{start:function(){var that=$(this).resizable("instance"),o=that.options,_store=function(exp){$(exp).each(function(){var el=$(this);el.data("ui-resizable-alsoresize",{width:parseInt(el.width(),10),height:parseInt(el.height(),10),left:parseInt(el.css("left"),10),top:parseInt(el.css("top"),10)});});};if(typeof(o.alsoResize)==="object"&&!o.alsoResize.parentNode){if(o.alsoResize.length){o.alsoResize=o.alsoResize[0];_store(o.alsoResize);}else{$.each(o.alsoResize,function(exp){_store(exp);});}}else{_store(o.alsoResize);}},resize:function(event,ui){var that=$(this).resizable("instance"),o=that.options,os=that.originalSize,op=that.originalPosition,delta={height:(that.size.height-os.height)||0,width:(that.size.width-os.width)||0,top:(that.position.top-op.top)||0,left:(that.position.left-op.left)||0},_alsoResize=function(exp,c){$(exp).each(function(){var el=$(this),start=$(this).data("ui-resizable-alsoresize"),style={},css=c&&c.length?c:el.parents(ui.originalElement[0]).length?["width","height"]:["width","height","top","left"];$.each(css,function(i,prop){var sum=(start[prop]||0)+(delta[prop]||0);if(sum&&sum>=0){style[prop]=sum||null;}});el.css(style);});};if(typeof(o.alsoResize)==="object"&&!o.alsoResize.nodeType){$.each(o.alsoResize,function(exp,c){_alsoResize(exp,c);});}else{_alsoResize(o.alsoResize);}},stop:function(){$(this).removeData("resizable-alsoresize");}});$.ui.plugin.add("resizable","ghost",{start:function(){var that=$(this).resizable("instance"),o=that.options,cs=that.size;that.ghost=that.originalElement.clone();that.ghost.css({opacity:0.25,display:"block",position:"relative",height:cs.height,width:cs.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof o.ghost==="string"?o.ghost:"");that.ghost.appendTo(that.helper);},resize:function(){var that=$(this).resizable("instance");if(that.ghost){that.ghost.css({position:"relative",height:that.size.height,width:that.size.width});}},stop:function(){var that=$(this).resizable("instance");if(that.ghost&&that.helper){that.helper.get(0).removeChild(that.ghost.get(0));}}});$.ui.plugin.add("resizable","grid",{resize:function(){var outerDimensions,that=$(this).resizable("instance"),o=that.options,cs=that.size,os=that.originalSize,op=that.originalPosition,a=that.axis,grid=typeof o.grid==="number"?[o.grid,o.grid]:o.grid,gridX=(grid[0]||1),gridY=(grid[1]||1),ox=Math.round((cs.width-os.width)/gridX)*gridX,oy=Math.round((cs.height-os.height)/gridY)*gridY,newWidth=os.width+ox,newHeight=os.height+oy,isMaxWidth=o.maxWidth&&(o.maxWidth<newWidth),isMaxHeight=o.maxHeight&&(o.maxHeight<newHeight),isMinWidth=o.minWidth&&(o.minWidth>newWidth),isMinHeight=o.minHeight&&(o.minHeight>newHeight);o.grid=grid;if(isMinWidth){newWidth+=gridX;}
if(isMinHeight){newHeight+=gridY;}
if(isMaxWidth){newWidth-=gridX;}
if(isMaxHeight){newHeight-=gridY;}
if(/^(se|s|e)$/.test(a)){that.size.width=newWidth;that.size.height=newHeight;}else if(/^(ne)$/.test(a)){that.size.width=newWidth;that.size.height=newHeight;that.position.top=op.top-oy;}else if(/^(sw)$/.test(a)){that.size.width=newWidth;that.size.height=newHeight;that.position.left=op.left-ox;}else{if(newHeight-gridY<=0||newWidth-gridX<=0){outerDimensions=that._getPaddingPlusBorderDimensions(this);}
if(newHeight-gridY>0){that.size.height=newHeight;that.position.top=op.top-oy;}else{newHeight=gridY-outerDimensions.height;that.size.height=newHeight;that.position.top=op.top+os.height-newHeight;}
if(newWidth-gridX>0){that.size.width=newWidth;that.position.left=op.left-ox;}else{newWidth=gridY-outerDimensions.height;that.size.width=newWidth;that.position.left=op.left+os.width-newWidth;}}}});return $.ui.resizable;}));(function(factory){if(typeof define==="function"&&define.amd){define(["jquery","./core","./widget"],factory);}else{factory(jQuery);}}(function($){var lastActive,baseClasses="ui-button ui-widget ui-state-default ui-corner-all",typeClasses="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",formResetHandler=function(){var form=$(this);setTimeout(function(){form.find(":ui-button").button("refresh");},1);},radioGroup=function(radio){var name=radio.name,form=radio.form,radios=$([]);if(name){name=name.replace(/'/g,"\\'");if(form){radios=$(form).find("[name='"+name+"'][type=radio]");}else{radios=$("[name='"+name+"'][type=radio]",radio.ownerDocument).filter(function(){return!this.form;});}}
return radios;};$.widget("ui.button",{version:"@VERSION",defaultElement:"<button>",options:{disabled:null,text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,formResetHandler);if(typeof this.options.disabled!=="boolean"){this.options.disabled=!!this.element.prop("disabled");}else{this.element.prop("disabled",this.options.disabled);}
this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var that=this,options=this.options,toggleButton=this.type==="checkbox"||this.type==="radio",activeClass=!toggleButton?"ui-state-active":"";if(options.label===null){options.label=(this.type==="input"?this.buttonElement.val():this.buttonElement.html());}
this._hoverable(this.buttonElement);this.buttonElement.addClass(baseClasses).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){if(options.disabled){return;}
if(this===lastActive){$(this).addClass("ui-state-active");}}).bind("mouseleave"+this.eventNamespace,function(){if(options.disabled){return;}
$(this).removeClass(activeClass);}).bind("click"+this.eventNamespace,function(event){if(options.disabled){event.preventDefault();event.stopImmediatePropagation();}});this._on({focus:function(){this.buttonElement.addClass("ui-state-focus");},blur:function(){this.buttonElement.removeClass("ui-state-focus");}});if(toggleButton){this.element.bind("change"+this.eventNamespace,function(){that.refresh();});}
if(this.type==="checkbox"){this.buttonElement.bind("click"+this.eventNamespace,function(){if(options.disabled){return false;}});}else if(this.type==="radio"){this.buttonElement.bind("click"+this.eventNamespace,function(){if(options.disabled){return false;}
$(this).addClass("ui-state-active");that.buttonElement.attr("aria-pressed","true");var radio=that.element[0];radioGroup(radio).not(radio).map(function(){return $(this).button("widget")[0];}).removeClass("ui-state-active").attr("aria-pressed","false");});}else{this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(options.disabled){return false;}
$(this).addClass("ui-state-active");lastActive=this;that.document.one("mouseup",function(){lastActive=null;});}).bind("mouseup"+this.eventNamespace,function(){if(options.disabled){return false;}
$(this).removeClass("ui-state-active");}).bind("keydown"+this.eventNamespace,function(event){if(options.disabled){return false;}
if(event.keyCode===$.ui.keyCode.SPACE||event.keyCode===$.ui.keyCode.ENTER){$(this).addClass("ui-state-active");}}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){$(this).removeClass("ui-state-active");});if(this.buttonElement.is("a")){this.buttonElement.keyup(function(event){if(event.keyCode===$.ui.keyCode.SPACE){$(this).click();}});}}
this._setOption("disabled",options.disabled);this._resetButton();},_determineButtonType:function(){var ancestor,labelSelector,checked;if(this.element.is("[type=checkbox]")){this.type="checkbox";}else if(this.element.is("[type=radio]")){this.type="radio";}else if(this.element.is("input")){this.type="input";}else{this.type="button";}
if(this.type==="checkbox"||this.type==="radio"){ancestor=this.element.parents().last();labelSelector="label[for='"+this.element.attr("id")+"']";this.buttonElement=ancestor.find(labelSelector);if(!this.buttonElement.length){ancestor=ancestor.length?ancestor.siblings():this.element.siblings();this.buttonElement=ancestor.filter(labelSelector);if(!this.buttonElement.length){this.buttonElement=ancestor.find(labelSelector);}}
this.element.addClass("ui-helper-hidden-accessible");checked=this.element.is(":checked");if(checked){this.buttonElement.addClass("ui-state-active");}
this.buttonElement.prop("aria-pressed",checked);}else{this.buttonElement=this.element;}},widget:function(){return this.buttonElement;},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass(baseClasses+" ui-state-active "+typeClasses).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());if(!this.hasTitle){this.buttonElement.removeAttr("title");}},_setOption:function(key,value){this._super(key,value);if(key==="disabled"){this.widget().toggleClass("ui-state-disabled",!!value);this.element.prop("disabled",!!value);if(value){if(this.type==="checkbox"||this.type==="radio"){this.buttonElement.removeClass("ui-state-focus");}else{this.buttonElement.removeClass("ui-state-focus ui-state-active");}}
return;}
this._resetButton();},refresh:function(){var isDisabled=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");if(isDisabled!==this.options.disabled){this._setOption("disabled",isDisabled);}
if(this.type==="radio"){radioGroup(this.element[0]).each(function(){if($(this).is(":checked")){$(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true");}else{$(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false");}});}else if(this.type==="checkbox"){if(this.element.is(":checked")){this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true");}else{this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false");}}},_resetButton:function(){if(this.type==="input"){if(this.options.label){this.element.val(this.options.label);}
return;}
var buttonElement=this.buttonElement.removeClass(typeClasses),buttonText=$("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(buttonElement.empty()).text(),icons=this.options.icons,multipleIcons=icons.primary&&icons.secondary,buttonClasses=[];if(icons.primary||icons.secondary){if(this.options.text){buttonClasses.push("ui-button-text-icon"+(multipleIcons?"s":(icons.primary?"-primary":"-secondary")));}
if(icons.primary){buttonElement.prepend("<span class='ui-button-icon-primary ui-icon "+icons.primary+"'></span>");}
if(icons.secondary){buttonElement.append("<span class='ui-button-icon-secondary ui-icon "+icons.secondary+"'></span>");}
if(!this.options.text){buttonClasses.push(multipleIcons?"ui-button-icons-only":"ui-button-icon-only");if(!this.hasTitle){buttonElement.attr("title",$.trim(buttonText));}}}else{buttonClasses.push("ui-button-text-only");}
buttonElement.addClass(buttonClasses.join(" "));}});$.widget("ui.buttonset",{version:"@VERSION",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset");},_init:function(){this.refresh();},_setOption:function(key,value){if(key==="disabled"){this.buttons.button("option",key,value);}
this._super(key,value);},refresh:function(){var rtl=this.element.css("direction")==="rtl",allButtons=this.element.find(this.options.items),existingButtons=allButtons.filter(":ui-button");allButtons.not(":ui-button").button();existingButtons.button("refresh");this.buttons=allButtons.map(function(){return $(this).button("widget")[0];}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(rtl?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(rtl?"ui-corner-left":"ui-corner-right").end().end();},_destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return $(this).button("widget")[0];}).removeClass("ui-corner-left ui-corner-right").end().button("destroy");}});return $.ui.button;}));(function(factory){if(typeof define==="function"&&define.amd){define(["jquery","./core","./widget","./button","./draggable","./mouse","./position","./resizable"],factory);}else{factory(jQuery);}}(function($){return $.widget("ui.dialog",{version:"@VERSION",options:{appendTo:"body",autoOpen:true,buttons:[],closeOnEscape:true,closeText:"Close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",of:window,collision:"fit",using:function(pos){var topOffset=$(this).css(pos).offset().top;if(topOffset<0){$(this).css("top",pos.top-topOffset);}}},resizable:true,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},resizableRelatedOptions:{maxHeight:true,maxWidth:true,minHeight:true,minWidth:true},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height};this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};this.originalTitle=this.element.attr("title");this.options.title=this.options.title||this.originalTitle;this._createWrapper();this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog);this._createTitlebar();this._createButtonPane();if(this.options.draggable&&$.fn.draggable){this._makeDraggable();}
if(this.options.resizable&&$.fn.resizable){this._makeResizable();}
this._isOpen=false;this._trackFocus();},_init:function(){if(this.options.autoOpen){this.open();}},_appendTo:function(){var element=this.options.appendTo;if(element&&(element.jquery||element.nodeType)){return $(element);}
return this.document.find(element||"body").eq(0);},_destroy:function(){var next,originalPosition=this.originalPosition;this._destroyOverlay();this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach();this.uiDialog.stop(true,true).remove();if(this.originalTitle){this.element.attr("title",this.originalTitle);}
next=originalPosition.parent.children().eq(originalPosition.index);if(next.length&&next[0]!==this.element[0]){next.before(this.element);}else{originalPosition.parent.append(this.element);}},widget:function(){return this.uiDialog;},disable:$.noop,enable:$.noop,close:function(event){var activeElement,that=this;if(!this._isOpen||this._trigger("beforeClose",event)===false){return;}
this._isOpen=false;this._focusedElement=null;this._destroyOverlay();this._untrackInstance();if(!this.opener.filter(":focusable").focus().length){try{activeElement=this.document[0].activeElement;if(activeElement&&activeElement.nodeName.toLowerCase()!=="body"){$(activeElement).blur();}}catch(error){}}
this._hide(this.uiDialog,this.options.hide,function(){that._trigger("close",event);});},isOpen:function(){return this._isOpen;},moveToTop:function(){this._moveToTop();},_moveToTop:function(event,silent){var moved=false,zIndicies=this.uiDialog.siblings(".ui-front:visible").map(function(){return+$(this).css("z-index");}).get(),zIndexMax=Math.max.apply(null,zIndicies);if(zIndexMax>=+this.uiDialog.css("z-index")){this.uiDialog.css("z-index",zIndexMax+1);moved=true;}
if(moved&&!silent){this._trigger("focus",event);}
return moved;},open:function(){var that=this;if(this._isOpen){if(this._moveToTop()){this._focusTabbable();}
return;}
this._isOpen=true;this.opener=$(this.document[0].activeElement);this._size();this._position();this._createOverlay();this._moveToTop(null,true);if(this.overlay){this.overlay.css("z-index",this.uiDialog.css("z-index")-1);}
this._show(this.uiDialog,this.options.show,function(){that._focusTabbable();that._trigger("focus");});this._makeFocusTarget();this._trigger("open");},_focusTabbable:function(){var hasFocus=this._focusedElement;if(!hasFocus){hasFocus=this.element.find("[autofocus]");}
if(!hasFocus.length){hasFocus=this.element.find(":tabbable");}
if(!hasFocus.length){hasFocus=this.uiDialogButtonPane.find(":tabbable");}
if(!hasFocus.length){hasFocus=this.uiDialogTitlebarClose.filter(":tabbable");}
if(!hasFocus.length){hasFocus=this.uiDialog;}
hasFocus.eq(0).focus();},_keepFocus:function(event){function checkFocus(){var activeElement=this.document[0].activeElement,isActive=this.uiDialog[0]===activeElement||$.contains(this.uiDialog[0],activeElement);if(!isActive){this._focusTabbable();}}
event.preventDefault();checkFocus.call(this);this._delay(checkFocus);},_createWrapper:function(){this.uiDialog=$("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+
this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo());this._on(this.uiDialog,{keydown:function(event){if(this.options.closeOnEscape&&!event.isDefaultPrevented()&&event.keyCode&&event.keyCode===$.ui.keyCode.ESCAPE){event.preventDefault();this.close(event);return;}
if(event.keyCode!==$.ui.keyCode.TAB||event.isDefaultPrevented()){return;}
var tabbables=this.uiDialog.find(":tabbable"),first=tabbables.filter(":first"),last=tabbables.filter(":last");if((event.target===last[0]||event.target===this.uiDialog[0])&&!event.shiftKey){this._delay(function(){first.focus();});event.preventDefault();}else if((event.target===first[0]||event.target===this.uiDialog[0])&&event.shiftKey){this._delay(function(){last.focus();});event.preventDefault();}},mousedown:function(event){if(this._moveToTop(event)){this._focusTabbable();}}});if(!this.element.find("[aria-describedby]").length){this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")});}},_createTitlebar:function(){var uiDialogTitle;this.uiDialogTitlebar=$("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog);this._on(this.uiDialogTitlebar,{mousedown:function(event){if(!$(event.target).closest(".ui-dialog-titlebar-close")){this.uiDialog.focus();}}});this.uiDialogTitlebarClose=$("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:false}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar);this._on(this.uiDialogTitlebarClose,{click:function(event){event.preventDefault();this.close(event);}});uiDialogTitle=$("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar);this._title(uiDialogTitle);this.uiDialog.attr({"aria-labelledby":uiDialogTitle.attr("id")});},_title:function(title){if(!this.options.title){title.html("&#160;");}
title.text(this.options.title);},_createButtonPane:function(){this.uiDialogButtonPane=$("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");this.uiButtonSet=$("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane);this._createButtons();},_createButtons:function(){var that=this,buttons=this.options.buttons;this.uiDialogButtonPane.remove();this.uiButtonSet.empty();if($.isEmptyObject(buttons)||($.isArray(buttons)&&!buttons.length)){this.uiDialog.removeClass("ui-dialog-buttons");return;}
$.each(buttons,function(name,props){var click,buttonOptions;props=$.isFunction(props)?{click:props,text:name}:props;props=$.extend({type:"button"},props);click=props.click;props.click=function(){click.apply(that.element[0],arguments);};buttonOptions={icons:props.icons,text:props.showText};delete props.icons;delete props.showText;$("<button></button>",props).button(buttonOptions).appendTo(that.uiButtonSet);});this.uiDialog.addClass("ui-dialog-buttons");this.uiDialogButtonPane.appendTo(this.uiDialog);},_makeDraggable:function(){var that=this,options=this.options;function filteredUi(ui){return{position:ui.position,offset:ui.offset};}
this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(event,ui){$(this).addClass("ui-dialog-dragging");that._blockFrames();that._trigger("dragStart",event,filteredUi(ui));},drag:function(event,ui){that._trigger("drag",event,filteredUi(ui));},stop:function(event,ui){var left=ui.offset.left-that.document.scrollLeft(),top=ui.offset.top-that.document.scrollTop();options.position={my:"left top",at:"left"+(left>=0?"+":"")+left+" "+"top"+(top>=0?"+":"")+top,of:that.window};$(this).removeClass("ui-dialog-dragging");that._unblockFrames();that._trigger("dragStop",event,filteredUi(ui));}});},_makeResizable:function(){var that=this,options=this.options,handles=options.resizable,position=this.uiDialog.css("position"),resizeHandles=typeof handles==="string"?handles:"n,e,s,w,se,sw,ne,nw";function filteredUi(ui){return{originalPosition:ui.originalPosition,originalSize:ui.originalSize,position:ui.position,size:ui.size};}
this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:options.maxWidth,maxHeight:options.maxHeight,minWidth:options.minWidth,minHeight:this._minHeight(),handles:resizeHandles,start:function(event,ui){$(this).addClass("ui-dialog-resizing");that._blockFrames();that._trigger("resizeStart",event,filteredUi(ui));},resize:function(event,ui){that._trigger("resize",event,filteredUi(ui));},stop:function(event,ui){var offset=that.uiDialog.offset(),left=offset.left-that.document.scrollLeft(),top=offset.top-that.document.scrollTop();options.height=that.uiDialog.height();options.width=that.uiDialog.width();options.position={my:"left top",at:"left"+(left>=0?"+":"")+left+" "+"top"+(top>=0?"+":"")+top,of:that.window};$(this).removeClass("ui-dialog-resizing");that._unblockFrames();that._trigger("resizeStop",event,filteredUi(ui));}}).css("position",position);},_trackFocus:function(){this._on(this.widget(),{focusin:function(event){this._makeFocusTarget();this._focusedElement=$(event.target);}});},_makeFocusTarget:function(){this._untrackInstance();this._trackingInstances().unshift(this);},_untrackInstance:function(){var instances=this._trackingInstances(),exists=$.inArray(this,instances);if(exists!==-1){instances.splice(exists,1);}},_trackingInstances:function(){var instances=this.document.data("ui-dialog-instances");if(!instances){instances=[];this.document.data("ui-dialog-instances",instances);}
return instances;},_minHeight:function(){var options=this.options;return options.height==="auto"?options.minHeight:Math.min(options.minHeight,options.height);},_position:function(){var isVisible=this.uiDialog.is(":visible");if(!isVisible){this.uiDialog.show();}
this.uiDialog.position(this.options.position);if(!isVisible){this.uiDialog.hide();}},_setOptions:function(options){var that=this,resize=false,resizableOptions={};$.each(options,function(key,value){that._setOption(key,value);if(key in that.sizeRelatedOptions){resize=true;}
if(key in that.resizableRelatedOptions){resizableOptions[key]=value;}});if(resize){this._size();this._position();}
if(this.uiDialog.is(":data(ui-resizable)")){this.uiDialog.resizable("option",resizableOptions);}},_setOption:function(key,value){var isDraggable,isResizable,uiDialog=this.uiDialog;if(key==="dialogClass"){uiDialog.removeClass(this.options.dialogClass).addClass(value);}
if(key==="disabled"){return;}
this._super(key,value);if(key==="appendTo"){this.uiDialog.appendTo(this._appendTo());}
if(key==="buttons"){this._createButtons();}
if(key==="closeText"){this.uiDialogTitlebarClose.button({label:""+value});}
if(key==="draggable"){isDraggable=uiDialog.is(":data(ui-draggable)");if(isDraggable&&!value){uiDialog.draggable("destroy");}
if(!isDraggable&&value){this._makeDraggable();}}
if(key==="position"){this._position();}
if(key==="resizable"){isResizable=uiDialog.is(":data(ui-resizable)");if(isResizable&&!value){uiDialog.resizable("destroy");}
if(isResizable&&typeof value==="string"){uiDialog.resizable("option","handles",value);}
if(!isResizable&&value!==false){this._makeResizable();}}
if(key==="title"){this._title(this.uiDialogTitlebar.find(".ui-dialog-title"));}},_size:function(){var nonContentHeight,minContentHeight,maxContentHeight,options=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0});if(options.minWidth>options.width){options.width=options.minWidth;}
nonContentHeight=this.uiDialog.css({height:"auto",width:options.width}).outerHeight();minContentHeight=Math.max(0,options.minHeight-nonContentHeight);maxContentHeight=typeof options.maxHeight==="number"?Math.max(0,options.maxHeight-nonContentHeight):"none";if(options.height==="auto"){this.element.css({minHeight:minContentHeight,maxHeight:maxContentHeight,height:"auto"});}else{this.element.height(Math.max(0,options.height-nonContentHeight));}
if(this.uiDialog.is(":data(ui-resizable)")){this.uiDialog.resizable("option","minHeight",this._minHeight());}},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var iframe=$(this);return $("<div>").css({position:"absolute",width:iframe.outerWidth(),height:iframe.outerHeight()}).appendTo(iframe.parent()).offset(iframe.offset())[0];});},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks;}},_allowInteraction:function(event){if($(event.target).closest(".ui-dialog").length){return true;}
return!!$(event.target).closest(".ui-datepicker").length;},_createOverlay:function(){if(!this.options.modal){return;}
var isOpening=true;this._delay(function(){isOpening=false;});if(!this.document.data("ui-dialog-overlays")){this._on(this.document,{focusin:function(event){if(isOpening){return;}
if(!this._allowInteraction(event)){event.preventDefault();this._trackingInstances()[0]._focusTabbable();}}});}
this.overlay=$("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo());this._on(this.overlay,{mousedown:"_keepFocus"});this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1);},_destroyOverlay:function(){if(!this.options.modal){return;}
if(this.overlay){var overlays=this.document.data("ui-dialog-overlays")-1;if(!overlays){this.document.unbind("focusin").removeData("ui-dialog-overlays");}else{this.document.data("ui-dialog-overlays",overlays);}
this.overlay.remove();this.overlay=null;}}});}));(function(factory){if(typeof define==="function"&&define.amd){define(["jquery","./core","./widget","./position","./menu"],factory);}else{factory(jQuery);}}(function($){$.widget("ui.autocomplete",{version:"@VERSION",defaultElement:"<input>",options:{appendTo:null,autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var suppressKeyPress,suppressKeyPressRepeat,suppressInput,nodeName=this.element[0].nodeName.toLowerCase(),isTextarea=nodeName==="textarea",isInput=nodeName==="input";this.isMultiLine=isTextarea?true:isInput?false:this.element.prop("isContentEditable");this.valueMethod=this.element[isTextarea||isInput?"val":"text"];this.isNewMenu=true;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off");this._on(this.element,{keydown:function(event){if(this.element.prop("readOnly")){suppressKeyPress=true;suppressInput=true;suppressKeyPressRepeat=true;return;}
suppressKeyPress=false;suppressInput=false;suppressKeyPressRepeat=false;var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:suppressKeyPress=true;this._move("previousPage",event);break;case keyCode.PAGE_DOWN:suppressKeyPress=true;this._move("nextPage",event);break;case keyCode.UP:suppressKeyPress=true;this._keyEvent("previous",event);break;case keyCode.DOWN:suppressKeyPress=true;this._keyEvent("next",event);break;case keyCode.ENTER:if(this.menu.active){suppressKeyPress=true;event.preventDefault();this.menu.select(event);}
break;case keyCode.TAB:if(this.menu.active){this.menu.select(event);}
break;case keyCode.ESCAPE:if(this.menu.element.is(":visible")){if(!this.isMultiLine){this._value(this.term);}
this.close(event);event.preventDefault();}
break;default:suppressKeyPressRepeat=true;this._searchTimeout(event);break;}},keypress:function(event){if(suppressKeyPress){suppressKeyPress=false;if(!this.isMultiLine||this.menu.element.is(":visible")){event.preventDefault();}
return;}
if(suppressKeyPressRepeat){return;}
var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:this._move("previousPage",event);break;case keyCode.PAGE_DOWN:this._move("nextPage",event);break;case keyCode.UP:this._keyEvent("previous",event);break;case keyCode.DOWN:this._keyEvent("next",event);break;}},input:function(event){if(suppressInput){suppressInput=false;event.preventDefault();return;}
this._searchTimeout(event);},focus:function(){this.selectedItem=null;this.previous=this._value();},blur:function(event){if(this.cancelBlur){delete this.cancelBlur;return;}
clearTimeout(this.searching);this.close(event);this._change(event);}});this._initSource();this.menu=$("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance");this._on(this.menu.element,{mousedown:function(event){event.preventDefault();this.cancelBlur=true;this._delay(function(){delete this.cancelBlur;});var menuElement=this.menu.element[0];if(!$(event.target).closest(".ui-menu-item").length){this._delay(function(){var that=this;this.document.one("mousedown",function(event){if(event.target!==that.element[0]&&event.target!==menuElement&&!$.contains(menuElement,event.target)){that.close();}});});}},menufocus:function(event,ui){var label,item;if(this.isNewMenu){this.isNewMenu=false;if(event.originalEvent&&/^mouse/.test(event.originalEvent.type)){this.menu.blur();this.document.one("mousemove",function(){$(event.target).trigger(event.originalEvent);});return;}}
item=ui.item.data("ui-autocomplete-item");if(false!==this._trigger("focus",event,{item:item})){if(event.originalEvent&&/^key/.test(event.originalEvent.type)){this._value(item.value);}}
label=ui.item.attr("aria-label")||item.value;if(label&&$.trim(label).length){this.liveRegion.children().hide();$("<div>").text(label).appendTo(this.liveRegion);}},menuselect:function(event,ui){var item=ui.item.data("ui-autocomplete-item"),previous=this.previous;if(this.element[0]!==this.document[0].activeElement){this.element.focus();this.previous=previous;this._delay(function(){this.previous=previous;this.selectedItem=item;});}
if(false!==this._trigger("select",event,{item:item})){this._value(item.value);}
this.term=this._value();this.close(event);this.selectedItem=item;}});this.liveRegion=$("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body);this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete");}});},_destroy:function(){clearTimeout(this.searching);this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete");this.menu.element.remove();this.liveRegion.remove();},_setOption:function(key,value){this._super(key,value);if(key==="source"){this._initSource();}
if(key==="appendTo"){this.menu.element.appendTo(this._appendTo());}
if(key==="disabled"&&value&&this.xhr){this.xhr.abort();}},_appendTo:function(){var element=this.options.appendTo;if(element){element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0);}
if(!element||!element[0]){element=this.element.closest(".ui-front");}
if(!element.length){element=this.document[0].body;}
return element;},_initSource:function(){var array,url,that=this;if($.isArray(this.options.source)){array=this.options.source;this.source=function(request,response){response($.ui.autocomplete.filter(array,request.term));};}else if(typeof this.options.source==="string"){url=this.options.source;this.source=function(request,response){if(that.xhr){that.xhr.abort();}
that.xhr=$.ajax({url:url,data:request,dataType:"json",success:function(data){response(data);},error:function(){response([]);}});};}else{this.source=this.options.source;}},_searchTimeout:function(event){clearTimeout(this.searching);this.searching=this._delay(function(){var equalValues=this.term===this._value(),menuVisible=this.menu.element.is(":visible"),modifierKey=event.altKey||event.ctrlKey||event.metaKey||event.shiftKey;if(!equalValues||(equalValues&&!menuVisible&&!modifierKey)){this.selectedItem=null;this.search(null,event);}},this.options.delay);},search:function(value,event){value=value!=null?value:this._value();this.term=this._value();if(value.length<this.options.minLength){return this.close(event);}
if(this._trigger("search",event)===false){return;}
return this._search(value);},_search:function(value){this.pending++;this.element.addClass("ui-autocomplete-loading");this.cancelSearch=false;this.source({term:value},this._response());},_response:function(){var index=++this.requestIndex;return $.proxy(function(content){if(index===this.requestIndex){this.__response(content);}
this.pending--;if(!this.pending){this.element.removeClass("ui-autocomplete-loading");}},this);},__response:function(content){if(content){content=this._normalize(content);}
this._trigger("response",null,{content:content});if(!this.options.disabled&&content&&content.length&&!this.cancelSearch){this._suggest(content);this._trigger("open");}else{this._close();}},close:function(event){this.cancelSearch=true;this._close(event);},_close:function(event){if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.blur();this.isNewMenu=true;this._trigger("close",event);}},_change:function(event){if(this.previous!==this._value()){this._trigger("change",event,{item:this.selectedItem});}},_normalize:function(items){if(items.length&&items[0].label&&items[0].value){return items;}
return $.map(items,function(item){if(typeof item==="string"){return{label:item,value:item};}
return $.extend({},item,{label:item.label||item.value,value:item.value||item.label});});},_suggest:function(items){var ul=this.menu.element.empty();this._renderMenu(ul,items);this.isNewMenu=true;this.menu.refresh();ul.show();this._resizeMenu();ul.position($.extend({of:this.element},this.options.position));if(this.options.autoFocus){this.menu.next();}},_resizeMenu:function(){var ul=this.menu.element;ul.outerWidth(Math.max(ul.width("").outerWidth()+1,this.element.outerWidth()));},_renderMenu:function(ul,items){var that=this;$.each(items,function(index,item){that._renderItemData(ul,item);});},_renderItemData:function(ul,item){return this._renderItem(ul,item).data("ui-autocomplete-item",item);},_renderItem:function(ul,item){return $("<li>").text(item.label).appendTo(ul);},_move:function(direction,event){if(!this.menu.element.is(":visible")){this.search(null,event);return;}
if(this.menu.isFirstItem()&&/^previous/.test(direction)||this.menu.isLastItem()&&/^next/.test(direction)){if(!this.isMultiLine){this._value(this.term);}
this.menu.blur();return;}
this.menu[direction](event);},widget:function(){return this.menu.element;},_value:function(){return this.valueMethod.apply(this.element,arguments);},_keyEvent:function(keyEvent,event){if(!this.isMultiLine||this.menu.element.is(":visible")){this._move(keyEvent,event);event.preventDefault();}}});$.extend($.ui.autocomplete,{escapeRegex:function(value){return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");},filter:function(array,term){var matcher=new RegExp($.ui.autocomplete.escapeRegex(term),"i");return $.grep(array,function(value){return matcher.test(value.label||value.value||value);});}});$.widget("ui.autocomplete",$.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(amount){return amount+(amount>1?" results are":" result is")+" available, use up and down arrow keys to navigate.";}}},__response:function(content){var message;this._superApply(arguments);if(this.options.disabled||this.cancelSearch){return;}
if(content&&content.length){message=this.options.messages.results(content.length);}else{message=this.options.messages.noResults;}
this.liveRegion.children().hide();$("<div>").text(message).appendTo(this.liveRegion);}});return $.ui.autocomplete;}));(function(factory){if(typeof define==="function"&&define.amd){define(["jquery","./core","./widget","./position","./menu"],factory);}else{factory(jQuery);}}(function($){return $.widget("ui.selectmenu",{version:"@VERSION",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var selectmenuId=this.element.uniqueId().attr("id");this.ids={element:selectmenuId,button:selectmenuId+"-button",menu:selectmenuId+"-menu"};this._drawButton();this._drawMenu();if(this.options.disabled){this.disable();}},_drawButton:function(){var that=this,tabindex=this.element.attr("tabindex");this.label=$("label[for='"+this.ids.element+"']").attr("for",this.ids.button);this._on(this.label,{click:function(event){this.button.focus();event.preventDefault();}});this.element.hide();this.button=$("<span>",{"class":"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:tabindex||this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element);$("<span>",{"class":"ui-icon "+this.options.icons.button}).prependTo(this.button);this.buttonText=$("<span>",{"class":"ui-selectmenu-text"}).appendTo(this.button);this._setText(this.buttonText,this.element.find("option:selected").text());this._resizeButton();this._on(this.button,this._buttonEvents);this.button.one("focusin",function(){if(!that.menuItems){that._refreshMenu();}});this._hoverable(this.button);this._focusable(this.button);},_drawMenu:function(){var that=this;this.menu=$("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu});this.menuWrap=$("<div>",{"class":"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo());this.menuInstance=this.menu.menu({role:"listbox",select:function(event,ui){event.preventDefault();that._select(ui.item.data("ui-selectmenu-item"),event);},focus:function(event,ui){var item=ui.item.data("ui-selectmenu-item");if(that.focusIndex!=null&&item.index!==that.focusIndex){that._trigger("focus",event,{item:item});if(!that.isOpen){that._select(item,event);}}
that.focusIndex=item.index;that.button.attr("aria-activedescendant",that.menuItems.eq(item.index).attr("id"));}}).menu("instance");this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all");this.menuInstance._off(this.menu,"mouseleave");this.menuInstance._closeOnDocumentClick=function(){return false;};this.menuInstance._isDivider=function(){return false;};},refresh:function(){this._refreshMenu();this._setText(this.buttonText,this._getSelectedItem().text());if(!this.options.width){this._resizeButton();}},_refreshMenu:function(){this.menu.empty();var item,options=this.element.find("option");if(!options.length){return;}
this._parseOptions(options);this._renderMenu(this.menu,this.items);this.menuInstance.refresh();this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup");item=this._getSelectedItem();this.menuInstance.focus(null,item);this._setAria(item.data("ui-selectmenu-item"));this._setOption("disabled",this.element.prop("disabled"));},open:function(event){if(this.options.disabled){return;}
if(!this.menuItems){this._refreshMenu();}else{this.menu.find(".ui-state-focus").removeClass("ui-state-focus");this.menuInstance.focus(null,this._getSelectedItem());}
this.isOpen=true;this._toggleAttr();this._resizeMenu();this._position();this._on(this.document,this._documentClick);this._trigger("open",event);},_position:function(){this.menuWrap.position($.extend({of:this.button},this.options.position));},close:function(event){if(!this.isOpen){return;}
this.isOpen=false;this._toggleAttr();this._off(this.document);this._trigger("close",event);},widget:function(){return this.button;},menuWidget:function(){return this.menu;},_renderMenu:function(ul,items){var that=this,currentOptgroup="";$.each(items,function(index,item){if(item.optgroup!==currentOptgroup){$("<li>",{"class":"ui-selectmenu-optgroup ui-menu-divider"+
(item.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:item.optgroup}).appendTo(ul);currentOptgroup=item.optgroup;}
that._renderItemData(ul,item);});},_renderItemData:function(ul,item){return this._renderItem(ul,item).data("ui-selectmenu-item",item);},_renderItem:function(ul,item){var li=$("<li>");if(item.disabled){li.addClass("ui-state-disabled");}
this._setText(li,item.label);return li.appendTo(ul);},_setText:function(element,value){if(value){element.text(value);}else{element.html("&#160;");}},_move:function(direction,event){var item,next,filter=".ui-menu-item";if(this.isOpen){item=this.menuItems.eq(this.focusIndex);}else{item=this.menuItems.eq(this.element[0].selectedIndex);filter+=":not(.ui-state-disabled)";}
if(direction==="first"||direction==="last"){next=item[direction==="first"?"prevAll":"nextAll"](filter).eq(-1);}else{next=item[direction+"All"](filter).eq(0);}
if(next.length){this.menuInstance.focus(event,next);}},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex);},_toggle:function(event){this[this.isOpen?"close":"open"](event);},_documentClick:{mousedown:function(event){if(!this.isOpen){return;}
if(!$(event.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length){this.close(event);}}},_buttonEvents:{mousedown:function(event){event.preventDefault();},click:"_toggle",keydown:function(event){var preventDefault=true;switch(event.keyCode){case $.ui.keyCode.TAB:case $.ui.keyCode.ESCAPE:this.close(event);preventDefault=false;break;case $.ui.keyCode.ENTER:if(this.isOpen){this._selectFocusedItem(event);}
break;case $.ui.keyCode.UP:if(event.altKey){this._toggle(event);}else{this._move("prev",event);}
break;case $.ui.keyCode.DOWN:if(event.altKey){this._toggle(event);}else{this._move("next",event);}
break;case $.ui.keyCode.SPACE:if(this.isOpen){this._selectFocusedItem(event);}else{this._toggle(event);}
break;case $.ui.keyCode.LEFT:this._move("prev",event);break;case $.ui.keyCode.RIGHT:this._move("next",event);break;case $.ui.keyCode.HOME:case $.ui.keyCode.PAGE_UP:this._move("first",event);break;case $.ui.keyCode.END:case $.ui.keyCode.PAGE_DOWN:this._move("last",event);break;default:this.menu.trigger(event);preventDefault=false;}
if(preventDefault){event.preventDefault();}}},_selectFocusedItem:function(event){var item=this.menuItems.eq(this.focusIndex);if(!item.hasClass("ui-state-disabled")){this._select(item.data("ui-selectmenu-item"),event);}},_select:function(item,event){var oldIndex=this.element[0].selectedIndex;this.element[0].selectedIndex=item.index;this._setText(this.buttonText,item.label);this._setAria(item);this._trigger("select",event,{item:item});if(item.index!==oldIndex){this._trigger("change",event,{item:item});}
this.close(event);},_setAria:function(item){var id=this.menuItems.eq(item.index).attr("id");this.button.attr({"aria-labelledby":id,"aria-activedescendant":id});this.menu.attr("aria-activedescendant",id);},_setOption:function(key,value){if(key==="icons"){this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(value.button);}
this._super(key,value);if(key==="appendTo"){this.menuWrap.appendTo(this._appendTo());}
if(key==="disabled"){this.menuInstance.option("disabled",value);this.button.toggleClass("ui-state-disabled",value).attr("aria-disabled",value);this.element.prop("disabled",value);if(value){this.button.attr("tabindex",-1);this.close();}else{this.button.attr("tabindex",0);}}
if(key==="width"){this._resizeButton();}},_appendTo:function(){var element=this.options.appendTo;if(element){element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0);}
if(!element||!element[0]){element=this.element.closest(".ui-front");}
if(!element.length){element=this.document[0].body;}
return element;},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen);this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen);this.menu.attr("aria-hidden",!this.isOpen);},_resizeButton:function(){var width=this.options.width;if(!width){width=this.element.show().outerWidth();this.element.hide();}
this.button.outerWidth(width);},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1));},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")};},_parseOptions:function(options){var data=[];options.each(function(index,item){var option=$(item),optgroup=option.parent("optgroup");data.push({element:option,index:index,value:option.attr("value"),label:option.text(),optgroup:optgroup.attr("label")||"",disabled:optgroup.prop("disabled")||option.prop("disabled")});});this.items=data;},_destroy:function(){this.menuWrap.remove();this.button.remove();this.element.show();this.element.removeUniqueId();this.label.attr("for",this.ids.element);}});}));(function(factory){if(typeof define==="function"&&define.amd){define(["jquery","./core","./mouse","./widget"],factory);}else{factory(jQuery);}}(function($){return $.widget("ui.slider",$.ui.mouse,{version:"@VERSION",widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider"+" ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all");this._refresh();this._setOption("disabled",this.options.disabled);this._animateOff=false;},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue();},_createHandles:function(){var i,handleCount,options=this.options,existingHandles=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),handle="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",handles=[];handleCount=(options.values&&options.values.length)||1;if(existingHandles.length>handleCount){existingHandles.slice(handleCount).remove();existingHandles=existingHandles.slice(0,handleCount);}
for(i=existingHandles.length;i<handleCount;i++){handles.push(handle);}
this.handles=existingHandles.add($(handles.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.each(function(i){$(this).data("ui-slider-handle-index",i);});},_createRange:function(){var options=this.options,classes="";if(options.range){if(options.range===true){if(!options.values){options.values=[this._valueMin(),this._valueMin()];}else if(options.values.length&&options.values.length!==2){options.values=[options.values[0],options.values[0]];}else if($.isArray(options.values)){options.values=options.values.slice(0);}}
if(!this.range||!this.range.length){this.range=$("<div></div>").appendTo(this.element);classes="ui-slider-range"+" ui-widget-header ui-corner-all";}else{this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({"left":"","bottom":""});}
this.range.addClass(classes+
((options.range==="min"||options.range==="max")?" ui-slider-range-"+options.range:""));}else{if(this.range){this.range.remove();}
this.range=null;}},_setupEvents:function(){this._off(this.handles);this._on(this.handles,this._handleEvents);this._hoverable(this.handles);this._focusable(this.handles);},_destroy:function(){this.handles.remove();if(this.range){this.range.remove();}
this.element.removeClass("ui-slider"+" ui-slider-horizontal"+" ui-slider-vertical"+" ui-widget"+" ui-widget-content"+" ui-corner-all");this._mouseDestroy();},_mouseCapture:function(event){var position,normValue,distance,closestHandle,index,allowed,offset,mouseOverHandle,that=this,o=this.options;if(o.disabled){return false;}
this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();position={x:event.pageX,y:event.pageY};normValue=this._normValueFromMouse(position);distance=this._valueMax()-this._valueMin()+1;this.handles.each(function(i){var thisDistance=Math.abs(normValue-that.values(i));if((distance>thisDistance)||(distance===thisDistance&&(i===that._lastChangedValue||that.values(i)===o.min))){distance=thisDistance;closestHandle=$(this);index=i;}});allowed=this._start(event,index);if(allowed===false){return false;}
this._mouseSliding=true;this._handleIndex=index;closestHandle.addClass("ui-state-active").focus();offset=closestHandle.offset();mouseOverHandle=!$(event.target).parents().addBack().is(".ui-slider-handle");this._clickOffset=mouseOverHandle?{left:0,top:0}:{left:event.pageX-offset.left-(closestHandle.width()/2),top:event.pageY-offset.top-
(closestHandle.height()/2)-
(parseInt(closestHandle.css("borderTopWidth"),10)||0)-
(parseInt(closestHandle.css("borderBottomWidth"),10)||0)+
(parseInt(closestHandle.css("marginTop"),10)||0)};if(!this.handles.hasClass("ui-state-hover")){this._slide(event,index,normValue);}
this._animateOff=true;return true;},_mouseStart:function(){return true;},_mouseDrag:function(event){var position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position);this._slide(event,this._handleIndex,normValue);return false;},_mouseStop:function(event){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(event,this._handleIndex);this._change(event,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false;},_detectOrientation:function(){this.orientation=(this.options.orientation==="vertical")?"vertical":"horizontal";},_normValueFromMouse:function(position){var pixelTotal,pixelMouse,percentMouse,valueTotal,valueMouse;if(this.orientation==="horizontal"){pixelTotal=this.elementSize.width;pixelMouse=position.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0);}else{pixelTotal=this.elementSize.height;pixelMouse=position.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0);}
percentMouse=(pixelMouse/pixelTotal);if(percentMouse>1){percentMouse=1;}
if(percentMouse<0){percentMouse=0;}
if(this.orientation==="vertical"){percentMouse=1-percentMouse;}
valueTotal=this._valueMax()-this._valueMin();valueMouse=this._valueMin()+percentMouse*valueTotal;return this._trimAlignValue(valueMouse);},_start:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values();}
return this._trigger("start",event,uiHash);},_slide:function(event,index,newVal){var otherVal,newValues,allowed;if(this.options.values&&this.options.values.length){otherVal=this.values(index?0:1);if((this.options.values.length===2&&this.options.range===true)&&((index===0&&newVal>otherVal)||(index===1&&newVal<otherVal))){newVal=otherVal;}
if(newVal!==this.values(index)){newValues=this.values();newValues[index]=newVal;allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal,values:newValues});otherVal=this.values(index?0:1);if(allowed!==false){this.values(index,newVal);}}}else{if(newVal!==this.value()){allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal});if(allowed!==false){this.value(newVal);}}}},_stop:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values();}
this._trigger("stop",event,uiHash);},_change:function(event,index){if(!this._keySliding&&!this._mouseSliding){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values();}
this._lastChangedValue=index;this._trigger("change",event,uiHash);}},value:function(newValue){if(arguments.length){this.options.value=this._trimAlignValue(newValue);this._refreshValue();this._change(null,0);return;}
return this._value();},values:function(index,newValue){var vals,newValues,i;if(arguments.length>1){this.options.values[index]=this._trimAlignValue(newValue);this._refreshValue();this._change(null,index);return;}
if(arguments.length){if($.isArray(arguments[0])){vals=this.options.values;newValues=arguments[0];for(i=0;i<vals.length;i+=1){vals[i]=this._trimAlignValue(newValues[i]);this._change(null,i);}
this._refreshValue();}else{if(this.options.values&&this.options.values.length){return this._values(index);}else{return this.value();}}}else{return this._values();}},_setOption:function(key,value){var i,valsLength=0;if(key==="range"&&this.options.range===true){if(value==="min"){this.options.value=this._values(0);this.options.values=null;}else if(value==="max"){this.options.value=this._values(this.options.values.length-1);this.options.values=null;}}
if($.isArray(this.options.values)){valsLength=this.options.values.length;}
if(key==="disabled"){this.element.toggleClass("ui-state-disabled",!!value);}
this._super(key,value);switch(key){case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();this.handles.css(value==="horizontal"?"bottom":"left","");break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(i=0;i<valsLength;i+=1){this._change(null,i);}
this._animateOff=false;break;case"min":case"max":this._animateOff=true;this._refreshValue();this._animateOff=false;break;case"range":this._animateOff=true;this._refresh();this._animateOff=false;break;}},_value:function(){var val=this.options.value;val=this._trimAlignValue(val);return val;},_values:function(index){var val,vals,i;if(arguments.length){val=this.options.values[index];val=this._trimAlignValue(val);return val;}else if(this.options.values&&this.options.values.length){vals=this.options.values.slice();for(i=0;i<vals.length;i+=1){vals[i]=this._trimAlignValue(vals[i]);}
return vals;}else{return[];}},_trimAlignValue:function(val){if(val<=this._valueMin()){return this._valueMin();}
if(val>=this._valueMax()){return this._valueMax();}
var step=(this.options.step>0)?this.options.step:1,valModStep=(val-this._valueMin())%step,alignValue=val-valModStep;if(Math.abs(valModStep)*2>=step){alignValue+=(valModStep>0)?step:(-step);}
return parseFloat(alignValue.toFixed(5));},_valueMin:function(){return this.options.min;},_valueMax:function(){return this.options.max;},_refreshValue:function(){var lastValPercent,valPercent,value,valueMin,valueMax,oRange=this.options.range,o=this.options,that=this,animate=(!this._animateOff)?o.animate:false,_set={};if(this.options.values&&this.options.values.length){this.handles.each(function(i){valPercent=(that.values(i)-that._valueMin())/(that._valueMax()-that._valueMin())*100;_set[that.orientation==="horizontal"?"left":"bottom"]=valPercent+"%";$(this).stop(1,1)[animate?"animate":"css"](_set,o.animate);if(that.options.range===true){if(that.orientation==="horizontal"){if(i===0){that.range.stop(1,1)[animate?"animate":"css"]({left:valPercent+"%"},o.animate);}
if(i===1){that.range[animate?"animate":"css"]({width:(valPercent-lastValPercent)+"%"},{queue:false,duration:o.animate});}}else{if(i===0){that.range.stop(1,1)[animate?"animate":"css"]({bottom:(valPercent)+"%"},o.animate);}
if(i===1){that.range[animate?"animate":"css"]({height:(valPercent-lastValPercent)+"%"},{queue:false,duration:o.animate});}}}
lastValPercent=valPercent;});}else{value=this.value();valueMin=this._valueMin();valueMax=this._valueMax();valPercent=(valueMax!==valueMin)?(value-valueMin)/(valueMax-valueMin)*100:0;_set[this.orientation==="horizontal"?"left":"bottom"]=valPercent+"%";this.handle.stop(1,1)[animate?"animate":"css"](_set,o.animate);if(oRange==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[animate?"animate":"css"]({width:valPercent+"%"},o.animate);}
if(oRange==="max"&&this.orientation==="horizontal"){this.range[animate?"animate":"css"]({width:(100-valPercent)+"%"},{queue:false,duration:o.animate});}
if(oRange==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[animate?"animate":"css"]({height:valPercent+"%"},o.animate);}
if(oRange==="max"&&this.orientation==="vertical"){this.range[animate?"animate":"css"]({height:(100-valPercent)+"%"},{queue:false,duration:o.animate});}}},_handleEvents:{keydown:function(event){var allowed,curVal,newVal,step,index=$(event.target).data("ui-slider-handle-index");switch(event.keyCode){case $.ui.keyCode.HOME:case $.ui.keyCode.END:case $.ui.keyCode.PAGE_UP:case $.ui.keyCode.PAGE_DOWN:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:event.preventDefault();if(!this._keySliding){this._keySliding=true;$(event.target).addClass("ui-state-active");allowed=this._start(event,index);if(allowed===false){return;}}
break;}
step=this.options.step;if(this.options.values&&this.options.values.length){curVal=newVal=this.values(index);}else{curVal=newVal=this.value();}
switch(event.keyCode){case $.ui.keyCode.HOME:newVal=this._valueMin();break;case $.ui.keyCode.END:newVal=this._valueMax();break;case $.ui.keyCode.PAGE_UP:newVal=this._trimAlignValue(curVal+((this._valueMax()-this._valueMin())/this.numPages));break;case $.ui.keyCode.PAGE_DOWN:newVal=this._trimAlignValue(curVal-((this._valueMax()-this._valueMin())/this.numPages));break;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:if(curVal===this._valueMax()){return;}
newVal=this._trimAlignValue(curVal+step);break;case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(curVal===this._valueMin()){return;}
newVal=this._trimAlignValue(curVal-step);break;}
this._slide(event,index,newVal);},keyup:function(event){var index=$(event.target).data("ui-slider-handle-index");if(this._keySliding){this._keySliding=false;this._stop(event,index);this._change(event,index);$(event.target).removeClass("ui-state-active");}}}});}));(function($){$.extend($.ui,{fgtimepicker:{version:"0.3.3"}});var PROP_NAME='fgtimepicker',tpuuid=new Date().getTime();function FGTimePicker(){this.debug=true;this._curInst=null;this._disabledInputs=[];this._timepickerShowing=false;this._inDialog=false;this._dialogClass='ui-timepicker-dialog';this._mainDivId='ui-timepicker-div';this._inlineClass='ui-timepicker-inline';this._currentClass='ui-timepicker-current';this._dayOverClass='ui-timepicker-days-cell-over';this.regional=[];this.regional['']={hourText:'Hour',minuteText:'Minute',amPmText:['AM','PM'],closeButtonText:'Done',nowButtonText:'Now',deselectButtonText:'Deselect'};this._defaults={showOn:'focus',button:null,showAnim:'fadeIn',showOptions:{},appendText:'',beforeShow:null,onSelect:null,onClose:null,timeSeparator:':',periodSeparator:' ',showPeriod:false,showPeriodLabels:true,showLeadingZero:true,showMinutesLeadingZero:true,altField:'',defaultTime:'now',myPosition:'left top',atPosition:'left bottom',onHourShow:null,onMinuteShow:null,hours:{starts:0,ends:23},minutes:{starts:0,ends:55,interval:5,manual:[]},rows:4,showHours:true,showMinutes:true,optionalMinutes:false,showCloseButton:false,showNowButton:false,showDeselectButton:false,maxTime:{hour:null,minute:null},minTime:{hour:null,minute:null}};$.extend(this._defaults,this.regional['']);this.tpDiv=$('<div id="'+this._mainDivId+'" class="ui-timepicker ui-widget ui-helper-clearfix ui-corner-all " style="display: none"></div>');}
$.extend(FGTimePicker.prototype,{markerClassName:'hasTimepicker',log:function(){if(this.debug)
console.log.apply('',arguments);},_widgetTimepicker:function(){return this.tpDiv;},setDefaults:function(settings){extendRemove(this._defaults,settings||{});return this;},_attachTimepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute('time:'+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue);}catch(err){inlineSettings[attrName]=attrValue;}}}
var nodeName=target.nodeName.toLowerCase();var inline=(nodeName=='div'||nodeName=='span');if(!target.id){this.uuid+=1;target.id='tp'+this.uuid;}
var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{});if(nodeName=='input'){this._connectTimepicker(target,inst);this._setTimeFromField(inst);}else if(inline){this._inlineTimepicker(target,inst);}},_newInst:function(target,inline){var id=target[0].id.replace(/([^A-Za-z0-9_-])/g,'\\\\$1');return{id:id,input:target,inline:inline,tpDiv:(!inline?this.tpDiv:$('<div class="'+this._inlineClass+' ui-timepicker ui-widget  ui-helper-clearfix"></div>'))};},_connectTimepicker:function(target,inst){var input=$(target);inst.append=$([]);inst.trigger=$([]);if(input.hasClass(this.markerClassName)){return;}
this._attachments(input,inst);input.addClass(this.markerClassName).keydown(this._doKeyDown).keyup(this._doKeyUp).bind("setData.fgtimepicker",function(event,key,value){inst.settings[key]=value;}).bind("getData.fgtimepicker",function(event,key){return this._get(inst,key);});$.data(target,PROP_NAME,inst);},_doKeyDown:function(event){var inst=$.fgtimepicker._getInst(event.target);var handled=true;inst._keyEvent=true;if($.fgtimepicker._timepickerShowing){switch(event.keyCode){case 9:$.fgtimepicker._hideTimepicker();handled=false;break;case 13:$.fgtimepicker._updateSelectedValue(inst);$.fgtimepicker._hideTimepicker();return false;break;case 27:$.fgtimepicker._hideTimepicker();break;default:handled=false;}}
else if(event.keyCode==36&&event.ctrlKey){$.fgtimepicker._showTimepicker(this);}
else{handled=false;}
if(handled){event.preventDefault();event.stopPropagation();}},_doKeyUp:function(event){var inst=$.fgtimepicker._getInst(event.target);$.fgtimepicker._setTimeFromField(inst);$.fgtimepicker._updateTimepicker(inst);},_attachments:function(input,inst){var appendText=this._get(inst,'appendText');var isRTL=this._get(inst,'isRTL');if(inst.append){inst.append.remove();}
if(appendText){inst.append=$('<span class="'+this._appendClass+'">'+appendText+'</span>');input[isRTL?'before':'after'](inst.append);}
input.unbind('focus.fgtimepicker',this._showTimepicker);input.unbind('click.fgtimepicker',this._adjustZIndex);if(inst.trigger){inst.trigger.remove();}
var showOn=this._get(inst,'showOn');if(showOn=='focus'||showOn=='both'){input.bind("focus.fgtimepicker",this._showTimepicker);input.bind("click.fgtimepicker",this._adjustZIndex);}
if(showOn=='button'||showOn=='both'){var button=this._get(inst,'button');if(button==null){button=$('<button class="ui-timepicker-trigger" type="button">...</button>');input.after(button);}
$(button).bind("click.fgtimepicker",function(){if($.fgtimepicker._timepickerShowing&&$.fgtimepicker._lastInput==input[0]){$.fgtimepicker._hideTimepicker();}else if(!inst.input.is(':disabled')){$.fgtimepicker._showTimepicker(input[0]);}
return false;});}},_inlineTimepicker:function(target,inst){var divSpan=$(target);if(divSpan.hasClass(this.markerClassName))
return;divSpan.addClass(this.markerClassName).append(inst.tpDiv).bind("setData.fgtimepicker",function(event,key,value){inst.settings[key]=value;}).bind("getData.fgtimepicker",function(event,key){return this._get(inst,key);});$.data(target,PROP_NAME,inst);this._setTimeFromField(inst);this._updateTimepicker(inst);inst.tpDiv.show();},_adjustZIndex:function(input){input=input.target||input;var inst=$.fgtimepicker._getInst(input);inst.tpDiv.css('zIndex',$.fgtimepicker._getZIndex(input)+1);},_showTimepicker:function(input){input=input.target||input;if(input.nodeName.toLowerCase()!='input'){input=$('input',input.parentNode)[0];}
if($.fgtimepicker._isDisabledTimepicker(input)||$.fgtimepicker._lastInput==input){return;}
$.fgtimepicker._hideTimepicker();var inst=$.fgtimepicker._getInst(input);if($.fgtimepicker._curInst&&$.fgtimepicker._curInst!=inst){$.fgtimepicker._curInst.tpDiv.stop(true,true);}
var beforeShow=$.fgtimepicker._get(inst,'beforeShow');extendRemove(inst.settings,(beforeShow?beforeShow.apply(input,[input,inst]):{}));inst.lastVal=null;$.fgtimepicker._lastInput=input;$.fgtimepicker._setTimeFromField(inst);if($.fgtimepicker._inDialog){input.value='';}
if(!$.fgtimepicker._pos){$.fgtimepicker._pos=$.fgtimepicker._findPos(input);$.fgtimepicker._pos[1]+=input.offsetHeight;}
var isFixed=false;$(input).parents().each(function(){isFixed|=$(this).css('position')=='fixed';return!isFixed;});var offset={left:$.fgtimepicker._pos[0],top:$.fgtimepicker._pos[1]};$.fgtimepicker._pos=null;inst.tpDiv.css({position:'absolute',display:'block',top:'-1000px'});$.fgtimepicker._updateTimepicker(inst);if((!inst.inline)&&(typeof $.ui.position=='object')){inst.tpDiv.position({of:inst.input,my:$.fgtimepicker._get(inst,'myPosition'),at:$.fgtimepicker._get(inst,'atPosition'),collision:'flip'});var offset=inst.tpDiv.offset();$.fgtimepicker._pos=[offset.top,offset.left];}
inst._hoursClicked=false;inst._minutesClicked=false;offset=$.fgtimepicker._checkOffset(inst,offset,isFixed);inst.tpDiv.css({position:($.fgtimepicker._inDialog&&$.blockUI?'static':(isFixed?'fixed':'absolute')),display:'none',left:offset.left+'px',top:offset.top+'px'});if(!inst.inline){var showAnim=$.fgtimepicker._get(inst,'showAnim');var duration=$.fgtimepicker._get(inst,'duration');var postProcess=function(){$.fgtimepicker._timepickerShowing=true;var borders=$.fgtimepicker._getBorders(inst.tpDiv);inst.tpDiv.find('iframe.ui-timepicker-cover').css({left:-borders[0],top:-borders[1],width:inst.tpDiv.outerWidth(),height:inst.tpDiv.outerHeight()});};$.fgtimepicker._adjustZIndex(input);if($.effects&&$.effects[showAnim]){inst.tpDiv.show(showAnim,$.fgtimepicker._get(inst,'showOptions'),duration,postProcess);}
else{inst.tpDiv.show((showAnim?duration:null),postProcess);}
if(!showAnim||!duration){postProcess();}
if(inst.input.is(':visible')&&!inst.input.is(':disabled')){inst.input.focus();}
$.fgtimepicker._curInst=inst;}},_getZIndex:function(target){var elem=$(target);var maxValue=0;var position,value;while(elem.length&&elem[0]!==document){position=elem.css("position");if(position==="absolute"||position==="relative"||position==="fixed"){value=parseInt(elem.css("zIndex"),10);if(!isNaN(value)&&value!==0){if(value>maxValue){maxValue=value;}}}
elem=elem.parent();}
return maxValue;},_refreshTimepicker:function(target){var inst=this._getInst(target);if(inst){this._updateTimepicker(inst);}},_updateTimepicker:function(inst){inst.tpDiv.empty().append(this._generateHTML(inst));this._rebindDialogEvents(inst);},_rebindDialogEvents:function(inst){var borders=$.fgtimepicker._getBorders(inst.tpDiv),self=this;inst.tpDiv.find('iframe.ui-timepicker-cover').css({left:-borders[0],top:-borders[1],width:inst.tpDiv.outerWidth(),height:inst.tpDiv.outerHeight()}).end().find('.ui-timepicker-minute-cell').unbind().bind("click",{fromDoubleClick:false},$.proxy($.fgtimepicker.selectMinutes,this)).bind("dblclick",{fromDoubleClick:true},$.proxy($.fgtimepicker.selectMinutes,this)).end().find('.ui-timepicker-hour-cell').unbind().bind("click",{fromDoubleClick:false},$.proxy($.fgtimepicker.selectHours,this)).bind("dblclick",{fromDoubleClick:true},$.proxy($.fgtimepicker.selectHours,this)).end().find('.ui-timepicker td a').unbind().bind('mouseout',function(){$(this).removeClass('ui-state-hover');if(this.className.indexOf('ui-timepicker-prev')!=-1)$(this).removeClass('ui-timepicker-prev-hover');if(this.className.indexOf('ui-timepicker-next')!=-1)$(this).removeClass('ui-timepicker-next-hover');}).bind('mouseover',function(){if(!self._isDisabledTimepicker(inst.inline?inst.tpDiv.parent()[0]:inst.input[0])){$(this).parents('.ui-timepicker-calendar').find('a').removeClass('ui-state-hover');$(this).addClass('ui-state-hover');if(this.className.indexOf('ui-timepicker-prev')!=-1)$(this).addClass('ui-timepicker-prev-hover');if(this.className.indexOf('ui-timepicker-next')!=-1)$(this).addClass('ui-timepicker-next-hover');}}).end().find('.'+this._dayOverClass+' a').trigger('mouseover').end().find('.ui-timepicker-now').bind("click",function(e){$.fgtimepicker.selectNow(e);}).end().find('.ui-timepicker-deselect').bind("click",function(e){$.fgtimepicker.deselectTime(e);}).end().find('.ui-timepicker-close').bind("click",function(e){$.fgtimepicker._hideTimepicker();}).end();},_generateHTML:function(inst){var h,m,row,col,html,hoursHtml,minutesHtml='',showPeriod=(this._get(inst,'showPeriod')==true),showPeriodLabels=(this._get(inst,'showPeriodLabels')==true),showLeadingZero=(this._get(inst,'showLeadingZero')==true),showHours=(this._get(inst,'showHours')==true),showMinutes=(this._get(inst,'showMinutes')==true),amPmText=this._get(inst,'amPmText'),rows=this._get(inst,'rows'),amRows=0,pmRows=0,amItems=0,pmItems=0,amFirstRow=0,pmFirstRow=0,hours=Array(),hours_options=this._get(inst,'hours'),hoursPerRow=null,hourCounter=0,hourLabel=this._get(inst,'hourText'),showCloseButton=this._get(inst,'showCloseButton'),closeButtonText=this._get(inst,'closeButtonText'),showNowButton=this._get(inst,'showNowButton'),nowButtonText=this._get(inst,'nowButtonText'),showDeselectButton=this._get(inst,'showDeselectButton'),deselectButtonText=this._get(inst,'deselectButtonText'),showButtonPanel=showCloseButton||showNowButton||showDeselectButton;for(h=hours_options.starts;h<=hours_options.ends;h++){hours.push(h);}
hoursPerRow=Math.ceil(hours.length/rows);if(showPeriodLabels){for(hourCounter=0;hourCounter<hours.length;hourCounter++){if(hours[hourCounter]<12){amItems++;}
else{pmItems++;}}
hourCounter=0;amRows=Math.floor(amItems/hours.length*rows);pmRows=Math.floor(pmItems/hours.length*rows);if(rows!=amRows+pmRows){if(amItems&&(!pmItems||!amRows||(pmRows&&amItems/amRows>=pmItems/pmRows))){amRows++;}else{pmRows++;}}
amFirstRow=Math.min(amRows,1);pmFirstRow=amRows+1;if(amRows==0){hoursPerRow=Math.ceil(pmItems/pmRows);}else if(pmRows==0){hoursPerRow=Math.ceil(amItems/amRows);}else{hoursPerRow=Math.ceil(Math.max(amItems/amRows,pmItems/pmRows));}}
html='<table class="ui-timepicker-table ui-widget-content ui-corner-all"><tr>';if(showHours){html+='<td class="ui-timepicker-hours">'+'<div class="ui-timepicker-title ui-widget-header ui-helper-clearfix ui-corner-all">'+
hourLabel+'</div>'+'<table class="ui-timepicker">';for(row=1;row<=rows;row++){html+='<tr>';if(row==amFirstRow&&showPeriodLabels){html+='<th rowspan="'+amRows.toString()+'" class="periods" scope="row">'+amPmText[0]+'</th>';}
if(row==pmFirstRow&&showPeriodLabels){html+='<th rowspan="'+pmRows.toString()+'" class="periods" scope="row">'+amPmText[1]+'</th>';}
for(col=1;col<=hoursPerRow;col++){if(showPeriodLabels&&row<pmFirstRow&&hours[hourCounter]>=12){html+=this._generateHTMLHourCell(inst,undefined,showPeriod,showLeadingZero);}else{html+=this._generateHTMLHourCell(inst,hours[hourCounter],showPeriod,showLeadingZero);hourCounter++;}}
html+='</tr>';}
html+='</table>'+'</td>';}
if(showMinutes){html+='<td class="ui-timepicker-minutes">';html+=this._generateHTMLMinutes(inst);html+='</td>';}
html+='</tr>';if(showButtonPanel){var buttonPanel='<tr><td colspan="3"><div class="ui-timepicker-buttonpane ui-widget-content">';if(showNowButton){buttonPanel+='<button type="button" class="ui-timepicker-now ui-state-default ui-corner-all" '
+' data-timepicker-instance-id="#'+inst.id.replace(/\\\\/g,"\\")+'" >'
+nowButtonText+'</button>';}
if(showDeselectButton){buttonPanel+='<button type="button" class="ui-timepicker-deselect ui-state-default ui-corner-all" '
+' data-timepicker-instance-id="#'+inst.id.replace(/\\\\/g,"\\")+'" >'
+deselectButtonText+'</button>';}
if(showCloseButton){buttonPanel+='<button type="button" class="ui-timepicker-close ui-state-default ui-corner-all" '
+' data-timepicker-instance-id="#'+inst.id.replace(/\\\\/g,"\\")+'" >'
+closeButtonText+'</button>';}
html+=buttonPanel+'</div></td></tr>';}
html+='</table>';return html;},_updateMinuteDisplay:function(inst){var newHtml=this._generateHTMLMinutes(inst);inst.tpDiv.find('td.ui-timepicker-minutes').html(newHtml);this._rebindDialogEvents(inst);},_generateHTMLMinutes:function(inst){var m,row,html='',rows=this._get(inst,'rows'),minutes=Array(),minutes_options=this._get(inst,'minutes'),minutesPerRow=null,minuteCounter=0,showMinutesLeadingZero=(this._get(inst,'showMinutesLeadingZero')==true),onMinuteShow=this._get(inst,'onMinuteShow'),minuteLabel=this._get(inst,'minuteText');if(!minutes_options.starts){minutes_options.starts=0;}
if(!minutes_options.ends){minutes_options.ends=59;}
if(!minutes_options.manual){minutes_options.manual=[];}
for(m=minutes_options.starts;m<=minutes_options.ends;m+=minutes_options.interval){minutes.push(m);}
for(i=0;i<minutes_options.manual.length;i++){var currMin=minutes_options.manual[i];if(typeof currMin!='number'||currMin<0||currMin>59||$.inArray(currMin,minutes)>=0){continue;}
minutes.push(currMin);}
minutes.sort(function(a,b){return a-b;});minutesPerRow=Math.round(minutes.length/rows+0.49);if(onMinuteShow&&(onMinuteShow.apply((inst.input?inst.input[0]:null),[inst.hours,inst.minutes])==false)){for(minuteCounter=0;minuteCounter<minutes.length;minuteCounter+=1){m=minutes[minuteCounter];if(onMinuteShow.apply((inst.input?inst.input[0]:null),[inst.hours,m])){inst.minutes=m;break;}}}
html+='<div class="ui-timepicker-title ui-widget-header ui-helper-clearfix ui-corner-all">'+
minuteLabel+'</div>'+'<table class="ui-timepicker">';minuteCounter=0;for(row=1;row<=rows;row++){html+='<tr>';while(minuteCounter<row*minutesPerRow){var m=minutes[minuteCounter];var displayText='';if(m!==undefined){displayText=(m<10)&&showMinutesLeadingZero?"0"+m.toString():m.toString();}
html+=this._generateHTMLMinuteCell(inst,m,displayText);minuteCounter++;}
html+='</tr>';}
html+='</table>';return html;},_generateHTMLHourCell:function(inst,hour,showPeriod,showLeadingZero){var displayHour=hour;if((hour>12)&&showPeriod){displayHour=hour-12;}
if((displayHour==0)&&showPeriod){displayHour=12;}
if((displayHour<10)&&showLeadingZero){displayHour='0'+displayHour;}
var html="";var enabled=true;var onHourShow=this._get(inst,'onHourShow');var maxTime=this._get(inst,'maxTime');var minTime=this._get(inst,'minTime');if(hour==undefined){html='<td><span class="ui-state-default ui-state-disabled">&nbsp;</span></td>';return html;}
if(onHourShow){enabled=onHourShow.apply((inst.input?inst.input[0]:null),[hour]);}
if(enabled){if(!isNaN(parseInt(maxTime.hour))&&hour>maxTime.hour)enabled=false;if(!isNaN(parseInt(minTime.hour))&&hour<minTime.hour)enabled=false;}
if(enabled){html='<td class="ui-timepicker-hour-cell" data-timepicker-instance-id="#'+inst.id.replace(/\\\\/g,"\\")+'" data-hour="'+hour.toString()+'">'+'<a class="ui-state-default '+
(hour==inst.hours?'ui-state-active':'')+'">'+
displayHour.toString()+'</a></td>';}
else{html='<td>'+'<span class="ui-state-default ui-state-disabled '+
(hour==inst.hours?' ui-state-active ':' ')+'">'+
displayHour.toString()+'</span>'+'</td>';}
return html;},_generateHTMLMinuteCell:function(inst,minute,displayText){var html="";var enabled=true;var hour=inst.hours;var onMinuteShow=this._get(inst,'onMinuteShow');var maxTime=this._get(inst,'maxTime');var minTime=this._get(inst,'minTime');if(onMinuteShow){enabled=onMinuteShow.apply((inst.input?inst.input[0]:null),[inst.hours,minute]);}
if(minute==undefined){html='<td><span class="ui-state-default ui-state-disabled">&nbsp;</span></td>';return html;}
if(enabled&&hour!==null){if(!isNaN(parseInt(maxTime.hour))&&!isNaN(parseInt(maxTime.minute))&&hour>=maxTime.hour&&minute>maxTime.minute)enabled=false;if(!isNaN(parseInt(minTime.hour))&&!isNaN(parseInt(minTime.minute))&&hour<=minTime.hour&&minute<minTime.minute)enabled=false;}
if(enabled){html='<td class="ui-timepicker-minute-cell" data-timepicker-instance-id="#'+inst.id.replace(/\\\\/g,"\\")+'" data-minute="'+minute.toString()+'" >'+'<a class="ui-state-default '+
(minute==inst.minutes?'ui-state-active':'')+'" >'+
displayText+'</a></td>';}
else{html='<td>'+'<span class="ui-state-default ui-state-disabled" >'+
displayText+'</span>'+'</td>';}
return html;},_destroyTimepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return;}
var nodeName=target.nodeName.toLowerCase();$.removeData(target,PROP_NAME);if(nodeName=='input'){inst.append.remove();inst.trigger.remove();$target.removeClass(this.markerClassName).unbind('focus.fgtimepicker',this._showTimepicker).unbind('click.fgtimepicker',this._adjustZIndex);}else if(nodeName=='div'||nodeName=='span')
$target.removeClass(this.markerClassName).empty();},_enableTimepicker:function(target){var $target=$(target),target_id=$target.attr('id'),inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return;}
var nodeName=target.nodeName.toLowerCase();if(nodeName=='input'){target.disabled=false;var button=this._get(inst,'button');$(button).removeClass('ui-state-disabled').disabled=false;inst.trigger.filter('button').each(function(){this.disabled=false;}).end();}
else if(nodeName=='div'||nodeName=='span'){var inline=$target.children('.'+this._inlineClass);inline.children().removeClass('ui-state-disabled');inline.find('button').each(function(){this.disabled=false})}
this._disabledInputs=$.map(this._disabledInputs,function(value){return(value==target_id?null:value);});},_disableTimepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return;}
var nodeName=target.nodeName.toLowerCase();if(nodeName=='input'){var button=this._get(inst,'button');$(button).addClass('ui-state-disabled').disabled=true;target.disabled=true;inst.trigger.filter('button').each(function(){this.disabled=true;}).end();}
else if(nodeName=='div'||nodeName=='span'){var inline=$target.children('.'+this._inlineClass);inline.children().addClass('ui-state-disabled');inline.find('button').each(function(){this.disabled=true})}
this._disabledInputs=$.map(this._disabledInputs,function(value){return(value==target?null:value);});this._disabledInputs[this._disabledInputs.length]=$target.attr('id');},_isDisabledTimepicker:function(target_id){if(!target_id){return false;}
for(var i=0;i<this._disabledInputs.length;i++){if(this._disabledInputs[i]==target_id){return true;}}
return false;},_checkOffset:function(inst,offset,isFixed){var tpWidth=inst.tpDiv.outerWidth();var tpHeight=inst.tpDiv.outerHeight();var inputWidth=inst.input?inst.input.outerWidth():0;var inputHeight=inst.input?inst.input.outerHeight():0;var viewWidth=document.documentElement.clientWidth+$(document).scrollLeft();var viewHeight=document.documentElement.clientHeight+$(document).scrollTop();offset.left-=(this._get(inst,'isRTL')?(tpWidth-inputWidth):0);offset.left-=(isFixed&&offset.left==inst.input.offset().left)?$(document).scrollLeft():0;offset.top-=(isFixed&&offset.top==(inst.input.offset().top+inputHeight))?$(document).scrollTop():0;offset.left-=Math.min(offset.left,(offset.left+tpWidth>viewWidth&&viewWidth>tpWidth)?Math.abs(offset.left+tpWidth-viewWidth):0);offset.top-=Math.min(offset.top,(offset.top+tpHeight>viewHeight&&viewHeight>tpHeight)?Math.abs(tpHeight+inputHeight):0);return offset;},_findPos:function(obj){var inst=this._getInst(obj);var isRTL=this._get(inst,'isRTL');while(obj&&(obj.type=='hidden'||obj.nodeType!=1)){obj=obj[isRTL?'previousSibling':'nextSibling'];}
var position=$(obj).offset();return[position.left,position.top];},_getBorders:function(elem){var convert=function(value){return{thin:1,medium:2,thick:3}[value]||value;};return[parseFloat(convert(elem.css('border-left-width'))),parseFloat(convert(elem.css('border-top-width')))];},_checkExternalClick:function(event){if(!$.fgtimepicker._curInst){return;}
var $target=$(event.target);if($target[0].id!=$.fgtimepicker._mainDivId&&$target.parents('#'+$.fgtimepicker._mainDivId).length==0&&!$target.hasClass($.fgtimepicker.markerClassName)&&!$target.hasClass($.fgtimepicker._triggerClass)&&$.fgtimepicker._timepickerShowing&&!($.fgtimepicker._inDialog&&$.blockUI))
$.fgtimepicker._hideTimepicker();},_hideTimepicker:function(input){var inst=this._curInst;if(!inst||(input&&inst!=$.data(input,PROP_NAME))){return;}
if(this._timepickerShowing){var showAnim=this._get(inst,'showAnim');var duration=this._get(inst,'duration');var postProcess=function(){$.fgtimepicker._tidyDialog(inst);this._curInst=null;};if($.effects&&$.effects[showAnim]){inst.tpDiv.hide(showAnim,$.fgtimepicker._get(inst,'showOptions'),duration,postProcess);}
else{inst.tpDiv[(showAnim=='slideDown'?'slideUp':(showAnim=='fadeIn'?'fadeOut':'hide'))]((showAnim?duration:null),postProcess);}
if(!showAnim){postProcess();}
this._timepickerShowing=false;this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:'absolute',left:'0',top:'-100px'});if($.blockUI){$.unblockUI();$('body').append(this.tpDiv);}}
this._inDialog=false;var onClose=this._get(inst,'onClose');if(onClose){onClose.apply((inst.input?inst.input[0]:null),[(inst.input?inst.input.val():''),inst]);}}},_tidyDialog:function(inst){inst.tpDiv.removeClass(this._dialogClass).unbind('.ui-timepicker');},_getInst:function(target){try{return $.data(target,PROP_NAME);}
catch(err){throw'Missing instance data for this timepicker';}},_get:function(inst,name){return inst.settings[name]!==undefined?inst.settings[name]:this._defaults[name];},_setTimeFromField:function(inst){if(inst.input.val()==inst.lastVal){return;}
var defaultTime=this._get(inst,'defaultTime');var timeToParse=defaultTime=='now'?this._getCurrentTimeRounded(inst):defaultTime;if((inst.inline==false)&&(inst.input.val()!='')){timeToParse=inst.input.val()}
if(timeToParse instanceof Date){inst.hours=timeToParse.getHours();inst.minutes=timeToParse.getMinutes();}else{var timeVal=inst.lastVal=timeToParse;if(timeToParse==''){inst.hours=-1;inst.minutes=-1;}else{var time=this.parseTime(inst,timeVal);inst.hours=time.hours;inst.minutes=time.minutes;}}
$.fgtimepicker._updateTimepicker(inst);},_optionTimepicker:function(target,name,value){var inst=this._getInst(target);if(arguments.length==2&&typeof name=='string'){return(name=='defaults'?$.extend({},$.fgtimepicker._defaults):(inst?(name=='all'?$.extend({},inst.settings):this._get(inst,name)):null));}
var settings=name||{};if(typeof name=='string'){settings={};settings[name]=value;}
if(inst){extendRemove(inst.settings,settings);if(this._curInst==inst){this._hideTimepicker();this._updateTimepicker(inst);}
if(inst.inline){this._updateTimepicker(inst);}}},_setTimeTimepicker:function(target,time){var inst=this._getInst(target);if(inst){this._setTime(inst,time);this._updateTimepicker(inst);this._updateAlternate(inst,time);}},_setTime:function(inst,time,noChange){var origHours=inst.hours;var origMinutes=inst.minutes;if(time instanceof Date){inst.hours=time.getHours();inst.minutes=time.getMinutes();}else{var time=this.parseTime(inst,time);inst.hours=time.hours;inst.minutes=time.minutes;}
if((origHours!=inst.hours||origMinutes!=inst.minutes)&&!noChange){inst.input.trigger('change');}
this._updateTimepicker(inst);this._updateSelectedValue(inst);},_getCurrentTimeRounded:function(inst){var currentTime=new Date(),currentMinutes=currentTime.getMinutes(),minutes_options=this._get(inst,'minutes'),adjustedMinutes=Math.round(currentMinutes/minutes_options.interval)*minutes_options.interval;currentTime.setMinutes(adjustedMinutes);return currentTime;},parseTime:function(inst,timeVal){var retVal=new Object();retVal.hours=-1;retVal.minutes=-1;if(!timeVal)
return'';var timeSeparator=this._get(inst,'timeSeparator'),amPmText=this._get(inst,'amPmText'),showHours=this._get(inst,'showHours'),showMinutes=this._get(inst,'showMinutes'),optionalMinutes=this._get(inst,'optionalMinutes'),showPeriod=(this._get(inst,'showPeriod')==true),p=timeVal.indexOf(timeSeparator);if(p!=-1){retVal.hours=parseInt(timeVal.substr(0,p),10);retVal.minutes=parseInt(timeVal.substr(p+1),10);}
else if((showHours)&&(!showMinutes||optionalMinutes)){retVal.hours=parseInt(timeVal,10);}
else if((!showHours)&&(showMinutes)){retVal.minutes=parseInt(timeVal,10);}
if(showHours){var timeValUpper=timeVal.toUpperCase();if((retVal.hours<12)&&(showPeriod)&&(timeValUpper.indexOf(amPmText[1].toUpperCase())!=-1)){retVal.hours+=12;}
if((retVal.hours==12)&&(showPeriod)&&(timeValUpper.indexOf(amPmText[0].toUpperCase())!=-1)){retVal.hours=0;}}
return retVal;},selectNow:function(event){var id=$(event.target).attr("data-timepicker-instance-id"),$target=$(id),inst=this._getInst($target[0]);var currentTime=new Date();inst.hours=currentTime.getHours();inst.minutes=currentTime.getMinutes();this._updateSelectedValue(inst);this._updateTimepicker(inst);this._hideTimepicker();},deselectTime:function(event){var id=$(event.target).attr("data-timepicker-instance-id"),$target=$(id),inst=this._getInst($target[0]);inst.hours=-1;inst.minutes=-1;this._updateSelectedValue(inst);this._hideTimepicker();},selectHours:function(event){var $td=$(event.currentTarget),id=$td.attr("data-timepicker-instance-id"),newHours=parseInt($td.attr("data-hour")),fromDoubleClick=event.data.fromDoubleClick,$target=$(id),inst=this._getInst($target[0]),showMinutes=(this._get(inst,'showMinutes')==true);if($.fgtimepicker._isDisabledTimepicker($target.attr('id'))){return false}
$td.parents('.ui-timepicker-hours:first').find('a').removeClass('ui-state-active');$td.children('a').addClass('ui-state-active');inst.hours=newHours;var onMinuteShow=this._get(inst,'onMinuteShow'),maxTime=this._get(inst,'maxTime'),minTime=this._get(inst,'minTime');if(onMinuteShow||maxTime.minute||minTime.minute){this._updateMinuteDisplay(inst);}
this._updateSelectedValue(inst);inst._hoursClicked=true;if((inst._minutesClicked)||(fromDoubleClick)||(showMinutes==false)){$.fgtimepicker._hideTimepicker();}
return false;},selectMinutes:function(event){var $td=$(event.currentTarget),id=$td.attr("data-timepicker-instance-id"),newMinutes=parseInt($td.attr("data-minute")),fromDoubleClick=event.data.fromDoubleClick,$target=$(id),inst=this._getInst($target[0]),showHours=(this._get(inst,'showHours')==true);if($.fgtimepicker._isDisabledTimepicker($target.attr('id'))){return false}
$td.parents('.ui-timepicker-minutes:first').find('a').removeClass('ui-state-active');$td.children('a').addClass('ui-state-active');inst.minutes=newMinutes;this._updateSelectedValue(inst);inst._minutesClicked=true;if((inst._hoursClicked)||(fromDoubleClick)||(showHours==false)){$.fgtimepicker._hideTimepicker();return false;}
return false;},_updateSelectedValue:function(inst){var newTime=this._getParsedTime(inst);if(inst.input){inst.input.val(newTime);inst.input.trigger('change');}
var onSelect=this._get(inst,'onSelect');if(onSelect){onSelect.apply((inst.input?inst.input[0]:null),[newTime,inst]);}
this._updateAlternate(inst,newTime);return newTime;},_getParsedTime:function(inst){if(inst.hours==-1&&inst.minutes==-1){return'';}
if((inst.hours<inst.hours.starts)||(inst.hours>inst.hours.ends)){inst.hours=0;}
if((inst.minutes<inst.minutes.starts)||(inst.minutes>inst.minutes.ends)){inst.minutes=0;}
var period="",showPeriod=(this._get(inst,'showPeriod')==true),showLeadingZero=(this._get(inst,'showLeadingZero')==true),showHours=(this._get(inst,'showHours')==true),showMinutes=(this._get(inst,'showMinutes')==true),optionalMinutes=(this._get(inst,'optionalMinutes')==true),amPmText=this._get(inst,'amPmText'),selectedHours=inst.hours?inst.hours:0,selectedMinutes=inst.minutes?inst.minutes:0,displayHours=selectedHours?selectedHours:0,parsedTime='';if(displayHours==-1){displayHours=0}
if(selectedMinutes==-1){selectedMinutes=0}
if(showPeriod){if(inst.hours==0){displayHours=12;}
if(inst.hours<12){period=amPmText[0];}
else{period=amPmText[1];if(displayHours>12){displayHours-=12;}}}
var h=displayHours.toString();if(showLeadingZero&&(displayHours<10)){h='0'+h;}
var m=selectedMinutes.toString();if(selectedMinutes<10){m='0'+m;}
if(showHours){parsedTime+=h;}
if(showHours&&showMinutes&&(!optionalMinutes||m!=0)){parsedTime+=this._get(inst,'timeSeparator');}
if(showMinutes&&(!optionalMinutes||m!=0)){parsedTime+=m;}
if(showHours){if(period.length>0){parsedTime+=this._get(inst,'periodSeparator')+period;}}
return parsedTime;},_updateAlternate:function(inst,newTime){var altField=this._get(inst,'altField');if(altField){$(altField).each(function(i,e){$(e).val(newTime);});}},_getTimeAsDateTimepicker:function(input){var inst=this._getInst(input);if(inst.hours==-1&&inst.minutes==-1){return'';}
if((inst.hours<inst.hours.starts)||(inst.hours>inst.hours.ends)){inst.hours=0;}
if((inst.minutes<inst.minutes.starts)||(inst.minutes>inst.minutes.ends)){inst.minutes=0;}
return new Date(0,0,0,inst.hours,inst.minutes,0);},_getTimeTimepicker:function(input){var inst=this._getInst(input);return this._getParsedTime(inst);},_getHourTimepicker:function(input){var inst=this._getInst(input);if(inst==undefined){return-1;}
return inst.hours;},_getMinuteTimepicker:function(input){var inst=this._getInst(input);if(inst==undefined){return-1;}
return inst.minutes;}});$.fn.fgtimepicker=function(options){if(!$.fgtimepicker.initialized){$(document).mousedown($.fgtimepicker._checkExternalClick);$.fgtimepicker.initialized=true;}
if($("#"+$.fgtimepicker._mainDivId).length===0){$('body').append($.fgtimepicker.tpDiv);}
var otherArgs=Array.prototype.slice.call(arguments,1);if(typeof options=='string'&&(options=='getTime'||options=='getTimeAsDate'||options=='getHour'||options=='getMinute'))
return $.fgtimepicker['_'+options+'Timepicker'].apply($.fgtimepicker,[this[0]].concat(otherArgs));if(options=='option'&&arguments.length==2&&typeof arguments[1]=='string')
return $.fgtimepicker['_'+options+'Timepicker'].apply($.fgtimepicker,[this[0]].concat(otherArgs));return this.each(function(){typeof options=='string'?$.fgtimepicker['_'+options+'Timepicker'].apply($.fgtimepicker,[this].concat(otherArgs)):$.fgtimepicker._attachTimepicker(this,options);});};function extendRemove(target,props){$.extend(target,props);for(var name in props)
if(props[name]==null||props[name]==undefined)
target[name]=props[name];return target;};$.fgtimepicker=new FGTimePicker();$.fgtimepicker.initialized=false;$.fgtimepicker.uuid=new Date().getTime();$.fgtimepicker.version="0.3.3";window['TP_jQuery_'+tpuuid]=$;})(jQuery);(function($){$.ui.timepicker=$.ui.timepicker||{};if($.ui.timepicker.version){return;}
$.extend($.ui,{timepicker:{version:"1.5.0"}});var Timepicker=function(){this.regional=[];this.regional['']={currentText:'Now',closeText:'Done',amNames:['AM','A'],pmNames:['PM','P'],timeFormat:'HH:mm',timeSuffix:'',timeOnlyTitle:'Choose Time',timeText:'Time',hourText:'Hour',minuteText:'Minute',secondText:'Second',millisecText:'Millisecond',microsecText:'Microsecond',timezoneText:'Time Zone',isRTL:false};this._defaults={showButtonPanel:true,timeOnly:false,timeOnlyShowDate:false,showHour:null,showMinute:null,showSecond:null,showMillisec:null,showMicrosec:null,showTimezone:null,showTime:true,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,stepMicrosec:1,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,microsecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,microsecMax:999,minDateTime:null,maxDateTime:null,maxTime:null,minTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,microsecGrid:0,alwaysSetTime:true,separator:' ',altFieldTimeOnly:true,altTimeFormat:null,altSeparator:null,altTimeSuffix:null,altRedirectFocus:true,pickerTimeFormat:null,pickerTimeSuffix:null,showTimepicker:true,timezoneList:null,addSliderAccess:false,sliderAccessArgs:null,controlType:'slider',defaultValue:null,parse:'strict'};$.extend(this._defaults,this.regional['']);};$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,microsec_slider:null,timezone_select:null,maxTime:null,minTime:null,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,microsecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,microsecMaxOriginal:null,ampm:'',formattedDate:'',formattedTime:'',formattedDateTime:'',timezoneList:null,units:['hour','minute','second','millisec','microsec'],support:{},control:null,setDefaults:function(settings){extendRemove(this._defaults,settings||{});return this;},_newInst:function($input,opts){var tp_inst=new Timepicker(),inlineSettings={},fns={},overrides,i;for(var attrName in this._defaults){if(this._defaults.hasOwnProperty(attrName)){var attrValue=$input.attr('time:'+attrName);if(attrValue){try{inlineSettings[attrName]=eval(attrValue);}catch(err){inlineSettings[attrName]=attrValue;}}}}
overrides={beforeShow:function(input,dp_inst){if($.isFunction(tp_inst._defaults.evnts.beforeShow)){return tp_inst._defaults.evnts.beforeShow.call($input[0],input,dp_inst,tp_inst);}},onChangeMonthYear:function(year,month,dp_inst){tp_inst._updateDateTime(dp_inst);if($.isFunction(tp_inst._defaults.evnts.onChangeMonthYear)){tp_inst._defaults.evnts.onChangeMonthYear.call($input[0],year,month,dp_inst,tp_inst);}},onClose:function(dateText,dp_inst){if(tp_inst.timeDefined===true&&$input.val()!==''){tp_inst._updateDateTime(dp_inst);}
if($.isFunction(tp_inst._defaults.evnts.onClose)){tp_inst._defaults.evnts.onClose.call($input[0],dateText,dp_inst,tp_inst);}}};for(i in overrides){if(overrides.hasOwnProperty(i)){fns[i]=opts[i]||null;}}
tp_inst._defaults=$.extend({},this._defaults,inlineSettings,opts,overrides,{evnts:fns,timepicker:tp_inst});tp_inst.amNames=$.map(tp_inst._defaults.amNames,function(val){return val.toUpperCase();});tp_inst.pmNames=$.map(tp_inst._defaults.pmNames,function(val){return val.toUpperCase();});tp_inst.support=detectSupport(tp_inst._defaults.timeFormat+
(tp_inst._defaults.pickerTimeFormat?tp_inst._defaults.pickerTimeFormat:'')+
(tp_inst._defaults.altTimeFormat?tp_inst._defaults.altTimeFormat:''));if(typeof(tp_inst._defaults.controlType)==='string'){if(tp_inst._defaults.controlType==='slider'&&typeof($.ui.slider)==='undefined'){tp_inst._defaults.controlType='select';}
tp_inst.control=tp_inst._controls[tp_inst._defaults.controlType];}
else{tp_inst.control=tp_inst._defaults.controlType;}
var timezoneList=[-720,-660,-600,-570,-540,-480,-420,-360,-300,-270,-240,-210,-180,-120,-60,0,60,120,180,210,240,270,300,330,345,360,390,420,480,525,540,570,600,630,660,690,720,765,780,840];if(tp_inst._defaults.timezoneList!==null){timezoneList=tp_inst._defaults.timezoneList;}
var tzl=timezoneList.length,tzi=0,tzv=null;if(tzl>0&&typeof timezoneList[0]!=='object'){for(;tzi<tzl;tzi++){tzv=timezoneList[tzi];timezoneList[tzi]={value:tzv,label:$.timepicker.timezoneOffsetString(tzv,tp_inst.support.iso8601)};}}
tp_inst._defaults.timezoneList=timezoneList;tp_inst.timezone=tp_inst._defaults.timezone!==null?$.timepicker.timezoneOffsetNumber(tp_inst._defaults.timezone):((new Date()).getTimezoneOffset()*-1);tp_inst.hour=tp_inst._defaults.hour<tp_inst._defaults.hourMin?tp_inst._defaults.hourMin:tp_inst._defaults.hour>tp_inst._defaults.hourMax?tp_inst._defaults.hourMax:tp_inst._defaults.hour;tp_inst.minute=tp_inst._defaults.minute<tp_inst._defaults.minuteMin?tp_inst._defaults.minuteMin:tp_inst._defaults.minute>tp_inst._defaults.minuteMax?tp_inst._defaults.minuteMax:tp_inst._defaults.minute;tp_inst.second=tp_inst._defaults.second<tp_inst._defaults.secondMin?tp_inst._defaults.secondMin:tp_inst._defaults.second>tp_inst._defaults.secondMax?tp_inst._defaults.secondMax:tp_inst._defaults.second;tp_inst.millisec=tp_inst._defaults.millisec<tp_inst._defaults.millisecMin?tp_inst._defaults.millisecMin:tp_inst._defaults.millisec>tp_inst._defaults.millisecMax?tp_inst._defaults.millisecMax:tp_inst._defaults.millisec;tp_inst.microsec=tp_inst._defaults.microsec<tp_inst._defaults.microsecMin?tp_inst._defaults.microsecMin:tp_inst._defaults.microsec>tp_inst._defaults.microsecMax?tp_inst._defaults.microsecMax:tp_inst._defaults.microsec;tp_inst.ampm='';tp_inst.$input=$input;if(tp_inst._defaults.altField){tp_inst.$altInput=$(tp_inst._defaults.altField);if(tp_inst._defaults.altRedirectFocus===true){tp_inst.$altInput.css({cursor:'pointer'}).focus(function(){$input.trigger("focus");});}}
if(tp_inst._defaults.minDate===0||tp_inst._defaults.minDateTime===0){tp_inst._defaults.minDate=new Date();}
if(tp_inst._defaults.maxDate===0||tp_inst._defaults.maxDateTime===0){tp_inst._defaults.maxDate=new Date();}
if(tp_inst._defaults.minDate!==undefined&&tp_inst._defaults.minDate instanceof Date){tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime());}
if(tp_inst._defaults.minDateTime!==undefined&&tp_inst._defaults.minDateTime instanceof Date){tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime());}
if(tp_inst._defaults.maxDate!==undefined&&tp_inst._defaults.maxDate instanceof Date){tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime());}
if(tp_inst._defaults.maxDateTime!==undefined&&tp_inst._defaults.maxDateTime instanceof Date){tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime());}
tp_inst.$input.bind('focus',function(){tp_inst._onFocus();});return tp_inst;},_addTimePicker:function(dp_inst){var currDT=(this.$altInput&&this._defaults.altFieldTimeOnly)?this.$input.val()+' '+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(currDT);this._limitMinMaxDateTime(dp_inst,false);this._injectTimePicker();},_parseTime:function(timeString,withDate){if(!this.inst){this.inst=$.datepicker._getInst(this.$input[0]);}
if(withDate||!this._defaults.timeOnly){var dp_dateFormat=$.datepicker._get(this.inst,'dateFormat');try{var parseRes=parseDateTimeInternal(dp_dateFormat,this._defaults.timeFormat,timeString,$.datepicker._getFormatConfig(this.inst),this._defaults);if(!parseRes.timeObj){return false;}
$.extend(this,parseRes.timeObj);}catch(err){$.timepicker.log("Error parsing the date/time string: "+err+"\ndate/time string = "+timeString+"\ntimeFormat = "+this._defaults.timeFormat+"\ndateFormat = "+dp_dateFormat);return false;}
return true;}else{var timeObj=$.datepicker.parseTime(this._defaults.timeFormat,timeString,this._defaults);if(!timeObj){return false;}
$.extend(this,timeObj);return true;}},_injectTimePicker:function(){var $dp=this.inst.dpDiv,o=this.inst.settings,tp_inst=this,litem='',uitem='',show=null,max={},gridSize={},size=null,i=0,l=0;if($dp.find("div.ui-timepicker-div").length===0&&o.showTimepicker){var noDisplay=' style="display:none;"',html='<div class="ui-timepicker-div'+(o.isRTL?' ui-timepicker-rtl':'')+'"><dl>'+'<dt class="ui_tpicker_time_label"'+((o.showTime)?'':noDisplay)+'>'+o.timeText+'</dt>'+'<dd class="ui_tpicker_time"'+((o.showTime)?'':noDisplay)+'></dd>';for(i=0,l=this.units.length;i<l;i++){litem=this.units[i];uitem=litem.substr(0,1).toUpperCase()+litem.substr(1);show=o['show'+uitem]!==null?o['show'+uitem]:this.support[litem];max[litem]=parseInt((o[litem+'Max']-((o[litem+'Max']-o[litem+'Min'])%o['step'+uitem])),10);gridSize[litem]=0;html+='<dt class="ui_tpicker_'+litem+'_label"'+(show?'':noDisplay)+'>'+o[litem+'Text']+'</dt>'+'<dd class="ui_tpicker_'+litem+'"><div class="ui_tpicker_'+litem+'_slider"'+(show?'':noDisplay)+'></div>';if(show&&o[litem+'Grid']>0){html+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>';if(litem==='hour'){for(var h=o[litem+'Min'];h<=max[litem];h+=parseInt(o[litem+'Grid'],10)){gridSize[litem]++;var tmph=$.datepicker.formatTime(this.support.ampm?'hht':'HH',{hour:h},o);html+='<td data-for="'+litem+'">'+tmph+'</td>';}}
else{for(var m=o[litem+'Min'];m<=max[litem];m+=parseInt(o[litem+'Grid'],10)){gridSize[litem]++;html+='<td data-for="'+litem+'">'+((m<10)?'0':'')+m+'</td>';}}
html+='</tr></table></div>';}
html+='</dd>';}
var showTz=o.showTimezone!==null?o.showTimezone:this.support.timezone;html+='<dt class="ui_tpicker_timezone_label"'+(showTz?'':noDisplay)+'>'+o.timezoneText+'</dt>';html+='<dd class="ui_tpicker_timezone" '+(showTz?'':noDisplay)+'></dd>';html+='</dl></div>';var $tp=$(html);if(o.timeOnly===true){$tp.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all">'+'<div class="ui-datepicker-title">'+o.timeOnlyTitle+'</div>'+'</div>');$dp.find('.ui-datepicker-header, .ui-datepicker-calendar').hide();}
for(i=0,l=tp_inst.units.length;i<l;i++){litem=tp_inst.units[i];uitem=litem.substr(0,1).toUpperCase()+litem.substr(1);show=o['show'+uitem]!==null?o['show'+uitem]:this.support[litem];tp_inst[litem+'_slider']=tp_inst.control.create(tp_inst,$tp.find('.ui_tpicker_'+litem+'_slider'),litem,tp_inst[litem],o[litem+'Min'],max[litem],o['step'+uitem]);if(show&&o[litem+'Grid']>0){size=100*gridSize[litem]*o[litem+'Grid']/(max[litem]-o[litem+'Min']);$tp.find('.ui_tpicker_'+litem+' table').css({width:size+"%",marginLeft:o.isRTL?'0':((size/(-2*gridSize[litem]))+"%"),marginRight:o.isRTL?((size/(-2*gridSize[litem]))+"%"):'0',borderCollapse:'collapse'}).find("td").click(function(e){var $t=$(this),h=$t.html(),n=parseInt(h.replace(/[^0-9]/g),10),ap=h.replace(/[^apm]/ig),f=$t.data('for');if(f==='hour'){if(ap.indexOf('p')!==-1&&n<12){n+=12;}
else{if(ap.indexOf('a')!==-1&&n===12){n=0;}}}
tp_inst.control.value(tp_inst,tp_inst[f+'_slider'],litem,n);tp_inst._onTimeChange();tp_inst._onSelectHandler();}).css({cursor:'pointer',width:(100/gridSize[litem])+'%',textAlign:'center',overflow:'hidden'});}}
this.timezone_select=$tp.find('.ui_tpicker_timezone').append('<select></select>').find("select");$.fn.append.apply(this.timezone_select,$.map(o.timezoneList,function(val,idx){return $("<option />").val(typeof val==="object"?val.value:val).text(typeof val==="object"?val.label:val);}));if(typeof(this.timezone)!=="undefined"&&this.timezone!==null&&this.timezone!==""){var local_timezone=(new Date(this.inst.selectedYear,this.inst.selectedMonth,this.inst.selectedDay,12)).getTimezoneOffset()*-1;if(local_timezone===this.timezone){selectLocalTimezone(tp_inst);}else{this.timezone_select.val(this.timezone);}}else{if(typeof(this.hour)!=="undefined"&&this.hour!==null&&this.hour!==""){this.timezone_select.val(o.timezone);}else{selectLocalTimezone(tp_inst);}}
this.timezone_select.change(function(){tp_inst._onTimeChange();tp_inst._onSelectHandler();});var $buttonPanel=$dp.find('.ui-datepicker-buttonpane');if($buttonPanel.length){$buttonPanel.before($tp);}else{$dp.append($tp);}
this.$timeObj=$tp.find('.ui_tpicker_time');if(this.inst!==null){var timeDefined=this.timeDefined;this._onTimeChange();this.timeDefined=timeDefined;}
if(this._defaults.addSliderAccess){var sliderAccessArgs=this._defaults.sliderAccessArgs,rtl=this._defaults.isRTL;sliderAccessArgs.isRTL=rtl;setTimeout(function(){if($tp.find('.ui-slider-access').length===0){$tp.find('.ui-slider:visible').sliderAccess(sliderAccessArgs);var sliderAccessWidth=$tp.find('.ui-slider-access:eq(0)').outerWidth(true);if(sliderAccessWidth){$tp.find('table:visible').each(function(){var $g=$(this),oldWidth=$g.outerWidth(),oldMarginLeft=$g.css(rtl?'marginRight':'marginLeft').toString().replace('%',''),newWidth=oldWidth-sliderAccessWidth,newMarginLeft=((oldMarginLeft*newWidth)/oldWidth)+'%',css={width:newWidth,marginRight:0,marginLeft:0};css[rtl?'marginRight':'marginLeft']=newMarginLeft;$g.css(css);});}}},10);}
tp_inst._limitMinMaxDateTime(this.inst,true);}},_limitMinMaxDateTime:function(dp_inst,adjustSliders){var o=this._defaults,dp_date=new Date(dp_inst.selectedYear,dp_inst.selectedMonth,dp_inst.selectedDay);if(!this._defaults.showTimepicker){return;}
if($.datepicker._get(dp_inst,'minDateTime')!==null&&$.datepicker._get(dp_inst,'minDateTime')!==undefined&&dp_date){var minDateTime=$.datepicker._get(dp_inst,'minDateTime'),minDateTimeDate=new Date(minDateTime.getFullYear(),minDateTime.getMonth(),minDateTime.getDate(),0,0,0,0);if(this.hourMinOriginal===null||this.minuteMinOriginal===null||this.secondMinOriginal===null||this.millisecMinOriginal===null||this.microsecMinOriginal===null){this.hourMinOriginal=o.hourMin;this.minuteMinOriginal=o.minuteMin;this.secondMinOriginal=o.secondMin;this.millisecMinOriginal=o.millisecMin;this.microsecMinOriginal=o.microsecMin;}
if(dp_inst.settings.timeOnly||minDateTimeDate.getTime()===dp_date.getTime()){this._defaults.hourMin=minDateTime.getHours();if(this.hour<=this._defaults.hourMin){this.hour=this._defaults.hourMin;this._defaults.minuteMin=minDateTime.getMinutes();if(this.minute<=this._defaults.minuteMin){this.minute=this._defaults.minuteMin;this._defaults.secondMin=minDateTime.getSeconds();if(this.second<=this._defaults.secondMin){this.second=this._defaults.secondMin;this._defaults.millisecMin=minDateTime.getMilliseconds();if(this.millisec<=this._defaults.millisecMin){this.millisec=this._defaults.millisecMin;this._defaults.microsecMin=minDateTime.getMicroseconds();}else{if(this.microsec<this._defaults.microsecMin){this.microsec=this._defaults.microsecMin;}
this._defaults.microsecMin=this.microsecMinOriginal;}}else{this._defaults.millisecMin=this.millisecMinOriginal;this._defaults.microsecMin=this.microsecMinOriginal;}}else{this._defaults.secondMin=this.secondMinOriginal;this._defaults.millisecMin=this.millisecMinOriginal;this._defaults.microsecMin=this.microsecMinOriginal;}}else{this._defaults.minuteMin=this.minuteMinOriginal;this._defaults.secondMin=this.secondMinOriginal;this._defaults.millisecMin=this.millisecMinOriginal;this._defaults.microsecMin=this.microsecMinOriginal;}}else{this._defaults.hourMin=this.hourMinOriginal;this._defaults.minuteMin=this.minuteMinOriginal;this._defaults.secondMin=this.secondMinOriginal;this._defaults.millisecMin=this.millisecMinOriginal;this._defaults.microsecMin=this.microsecMinOriginal;}}
if($.datepicker._get(dp_inst,'maxDateTime')!==null&&$.datepicker._get(dp_inst,'maxDateTime')!==undefined&&dp_date){var maxDateTime=$.datepicker._get(dp_inst,'maxDateTime'),maxDateTimeDate=new Date(maxDateTime.getFullYear(),maxDateTime.getMonth(),maxDateTime.getDate(),0,0,0,0);if(this.hourMaxOriginal===null||this.minuteMaxOriginal===null||this.secondMaxOriginal===null||this.millisecMaxOriginal===null){this.hourMaxOriginal=o.hourMax;this.minuteMaxOriginal=o.minuteMax;this.secondMaxOriginal=o.secondMax;this.millisecMaxOriginal=o.millisecMax;this.microsecMaxOriginal=o.microsecMax;}
if(dp_inst.settings.timeOnly||maxDateTimeDate.getTime()===dp_date.getTime()){this._defaults.hourMax=maxDateTime.getHours();if(this.hour>=this._defaults.hourMax){this.hour=this._defaults.hourMax;this._defaults.minuteMax=maxDateTime.getMinutes();if(this.minute>=this._defaults.minuteMax){this.minute=this._defaults.minuteMax;this._defaults.secondMax=maxDateTime.getSeconds();if(this.second>=this._defaults.secondMax){this.second=this._defaults.secondMax;this._defaults.millisecMax=maxDateTime.getMilliseconds();if(this.millisec>=this._defaults.millisecMax){this.millisec=this._defaults.millisecMax;this._defaults.microsecMax=maxDateTime.getMicroseconds();}else{if(this.microsec>this._defaults.microsecMax){this.microsec=this._defaults.microsecMax;}
this._defaults.microsecMax=this.microsecMaxOriginal;}}else{this._defaults.millisecMax=this.millisecMaxOriginal;this._defaults.microsecMax=this.microsecMaxOriginal;}}else{this._defaults.secondMax=this.secondMaxOriginal;this._defaults.millisecMax=this.millisecMaxOriginal;this._defaults.microsecMax=this.microsecMaxOriginal;}}else{this._defaults.minuteMax=this.minuteMaxOriginal;this._defaults.secondMax=this.secondMaxOriginal;this._defaults.millisecMax=this.millisecMaxOriginal;this._defaults.microsecMax=this.microsecMaxOriginal;}}else{this._defaults.hourMax=this.hourMaxOriginal;this._defaults.minuteMax=this.minuteMaxOriginal;this._defaults.secondMax=this.secondMaxOriginal;this._defaults.millisecMax=this.millisecMaxOriginal;this._defaults.microsecMax=this.microsecMaxOriginal;}}
if(dp_inst.settings.minTime!==null){var tempMinTime=new Date("01/01/1970 "+dp_inst.settings.minTime);if(this.hour<tempMinTime.getHours()){this.hour=this._defaults.hourMin=tempMinTime.getHours();this.minute=this._defaults.minuteMin=tempMinTime.getMinutes();}else if(this.hour===tempMinTime.getHours()&&this.minute<tempMinTime.getMinutes()){this.minute=this._defaults.minuteMin=tempMinTime.getMinutes();}else{if(this._defaults.hourMin<tempMinTime.getHours()){this._defaults.hourMin=tempMinTime.getHours();this._defaults.minuteMin=tempMinTime.getMinutes();}else if(this._defaults.hourMin===tempMinTime.getHours()===this.hour&&this._defaults.minuteMin<tempMinTime.getMinutes()){this._defaults.minuteMin=tempMinTime.getMinutes();}else{this._defaults.minuteMin=0;}}}
if(dp_inst.settings.maxTime!==null){var tempMaxTime=new Date("01/01/1970 "+dp_inst.settings.maxTime);if(this.hour>tempMaxTime.getHours()){this.hour=this._defaults.hourMax=tempMaxTime.getHours();this.minute=this._defaults.minuteMax=tempMaxTime.getMinutes();}else if(this.hour===tempMaxTime.getHours()&&this.minute>tempMaxTime.getMinutes()){this.minute=this._defaults.minuteMax=tempMaxTime.getMinutes();}else{if(this._defaults.hourMax>tempMaxTime.getHours()){this._defaults.hourMax=tempMaxTime.getHours();this._defaults.minuteMax=tempMaxTime.getMinutes();}else if(this._defaults.hourMax===tempMaxTime.getHours()===this.hour&&this._defaults.minuteMax>tempMaxTime.getMinutes()){this._defaults.minuteMax=tempMaxTime.getMinutes();}else{this._defaults.minuteMax=59;}}}
if(adjustSliders!==undefined&&adjustSliders===true){var hourMax=parseInt((this._defaults.hourMax-((this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour)),10),minMax=parseInt((this._defaults.minuteMax-((this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute)),10),secMax=parseInt((this._defaults.secondMax-((this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond)),10),millisecMax=parseInt((this._defaults.millisecMax-((this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec)),10),microsecMax=parseInt((this._defaults.microsecMax-((this._defaults.microsecMax-this._defaults.microsecMin)%this._defaults.stepMicrosec)),10);if(this.hour_slider){this.control.options(this,this.hour_slider,'hour',{min:this._defaults.hourMin,max:hourMax,step:this._defaults.stepHour});this.control.value(this,this.hour_slider,'hour',this.hour-(this.hour%this._defaults.stepHour));}
if(this.minute_slider){this.control.options(this,this.minute_slider,'minute',{min:this._defaults.minuteMin,max:minMax,step:this._defaults.stepMinute});this.control.value(this,this.minute_slider,'minute',this.minute-(this.minute%this._defaults.stepMinute));}
if(this.second_slider){this.control.options(this,this.second_slider,'second',{min:this._defaults.secondMin,max:secMax,step:this._defaults.stepSecond});this.control.value(this,this.second_slider,'second',this.second-(this.second%this._defaults.stepSecond));}
if(this.millisec_slider){this.control.options(this,this.millisec_slider,'millisec',{min:this._defaults.millisecMin,max:millisecMax,step:this._defaults.stepMillisec});this.control.value(this,this.millisec_slider,'millisec',this.millisec-(this.millisec%this._defaults.stepMillisec));}
if(this.microsec_slider){this.control.options(this,this.microsec_slider,'microsec',{min:this._defaults.microsecMin,max:microsecMax,step:this._defaults.stepMicrosec});this.control.value(this,this.microsec_slider,'microsec',this.microsec-(this.microsec%this._defaults.stepMicrosec));}}},_onTimeChange:function(){if(!this._defaults.showTimepicker){return;}
var hour=(this.hour_slider)?this.control.value(this,this.hour_slider,'hour'):false,minute=(this.minute_slider)?this.control.value(this,this.minute_slider,'minute'):false,second=(this.second_slider)?this.control.value(this,this.second_slider,'second'):false,millisec=(this.millisec_slider)?this.control.value(this,this.millisec_slider,'millisec'):false,microsec=(this.microsec_slider)?this.control.value(this,this.microsec_slider,'microsec'):false,timezone=(this.timezone_select)?this.timezone_select.val():false,o=this._defaults,pickerTimeFormat=o.pickerTimeFormat||o.timeFormat,pickerTimeSuffix=o.pickerTimeSuffix||o.timeSuffix;if(typeof(hour)==='object'){hour=false;}
if(typeof(minute)==='object'){minute=false;}
if(typeof(second)==='object'){second=false;}
if(typeof(millisec)==='object'){millisec=false;}
if(typeof(microsec)==='object'){microsec=false;}
if(typeof(timezone)==='object'){timezone=false;}
if(hour!==false){hour=parseInt(hour,10);}
if(minute!==false){minute=parseInt(minute,10);}
if(second!==false){second=parseInt(second,10);}
if(millisec!==false){millisec=parseInt(millisec,10);}
if(microsec!==false){microsec=parseInt(microsec,10);}
if(timezone!==false){timezone=timezone.toString();}
var ampm=o[hour<12?'amNames':'pmNames'][0];var hasChanged=(hour!==parseInt(this.hour,10)||minute!==parseInt(this.minute,10)||second!==parseInt(this.second,10)||millisec!==parseInt(this.millisec,10)||microsec!==parseInt(this.microsec,10)||(this.ampm.length>0&&(hour<12)!==($.inArray(this.ampm.toUpperCase(),this.amNames)!==-1))||(this.timezone!==null&&timezone!==this.timezone.toString()));if(hasChanged){if(hour!==false){this.hour=hour;}
if(minute!==false){this.minute=minute;}
if(second!==false){this.second=second;}
if(millisec!==false){this.millisec=millisec;}
if(microsec!==false){this.microsec=microsec;}
if(timezone!==false){this.timezone=timezone;}
if(!this.inst){this.inst=$.datepicker._getInst(this.$input[0]);}
this._limitMinMaxDateTime(this.inst,true);}
if(this.support.ampm){this.ampm=ampm;}
this.formattedTime=$.datepicker.formatTime(o.timeFormat,this,o);if(this.$timeObj){if(pickerTimeFormat===o.timeFormat){this.$timeObj.text(this.formattedTime+pickerTimeSuffix);}
else{this.$timeObj.text($.datepicker.formatTime(pickerTimeFormat,this,o)+pickerTimeSuffix);}}
this.timeDefined=true;if(hasChanged){this._updateDateTime();}},_onSelectHandler:function(){var onSelect=this._defaults.onSelect||this.inst.settings.onSelect;var inputEl=this.$input?this.$input[0]:null;if(onSelect&&inputEl){onSelect.apply(inputEl,[this.formattedDateTime,this]);}},_updateDateTime:function(dp_inst){dp_inst=this.inst||dp_inst;var dtTmp=(dp_inst.currentYear>0?new Date(dp_inst.currentYear,dp_inst.currentMonth,dp_inst.currentDay):new Date(dp_inst.selectedYear,dp_inst.selectedMonth,dp_inst.selectedDay)),dt=$.datepicker._daylightSavingAdjust(dtTmp),dateFmt=$.datepicker._get(dp_inst,'dateFormat'),formatCfg=$.datepicker._getFormatConfig(dp_inst),timeAvailable=dt!==null&&this.timeDefined;this.formattedDate=$.datepicker.formatDate(dateFmt,(dt===null?new Date():dt),formatCfg);var formattedDateTime=this.formattedDate;if(dp_inst.lastVal===""){dp_inst.currentYear=dp_inst.selectedYear;dp_inst.currentMonth=dp_inst.selectedMonth;dp_inst.currentDay=dp_inst.selectedDay;}
if(this._defaults.timeOnly===true&&this._defaults.timeOnlyShowDate===false){formattedDateTime=this.formattedTime;}else if((this._defaults.timeOnly!==true&&(this._defaults.alwaysSetTime||timeAvailable))||(this._defaults.timeOnly===true&&this._defaults.timeOnlyShowDate===true)){formattedDateTime+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix;}
this.formattedDateTime=formattedDateTime;if(!this._defaults.showTimepicker){this.$input.val(this.formattedDate);}else if(this.$altInput&&this._defaults.timeOnly===false&&this._defaults.altFieldTimeOnly===true){this.$altInput.val(this.formattedTime);this.$input.val(this.formattedDate);}else if(this.$altInput){this.$input.val(formattedDateTime);var altFormattedDateTime='',altSeparator=this._defaults.altSeparator!==null?this._defaults.altSeparator:this._defaults.separator,altTimeSuffix=this._defaults.altTimeSuffix!==null?this._defaults.altTimeSuffix:this._defaults.timeSuffix;if(!this._defaults.timeOnly){if(this._defaults.altFormat){altFormattedDateTime=$.datepicker.formatDate(this._defaults.altFormat,(dt===null?new Date():dt),formatCfg);}
else{altFormattedDateTime=this.formattedDate;}
if(altFormattedDateTime){altFormattedDateTime+=altSeparator;}}
if(this._defaults.altTimeFormat!==null){altFormattedDateTime+=$.datepicker.formatTime(this._defaults.altTimeFormat,this,this._defaults)+altTimeSuffix;}
else{altFormattedDateTime+=this.formattedTime+altTimeSuffix;}
this.$altInput.val(altFormattedDateTime);}else{this.$input.val(formattedDateTime);}
this.$input.trigger("change");},_onFocus:function(){if(!this.$input.val()&&this._defaults.defaultValue){this.$input.val(this._defaults.defaultValue);var inst=$.datepicker._getInst(this.$input.get(0)),tp_inst=$.datepicker._get(inst,'timepicker');if(tp_inst){if(tp_inst._defaults.timeOnly&&(inst.input.val()!==inst.lastVal)){try{$.datepicker._updateDatepicker(inst);}catch(err){$.timepicker.log(err);}}}}},_controls:{slider:{create:function(tp_inst,obj,unit,val,min,max,step){var rtl=tp_inst._defaults.isRTL;return obj.prop('slide',null).slider({orientation:"horizontal",value:rtl?val*-1:val,min:rtl?max*-1:min,max:rtl?min*-1:max,step:step,slide:function(event,ui){tp_inst.control.value(tp_inst,$(this),unit,rtl?ui.value*-1:ui.value);tp_inst._onTimeChange();},stop:function(event,ui){tp_inst._onSelectHandler();}});},options:function(tp_inst,obj,unit,opts,val){if(tp_inst._defaults.isRTL){if(typeof(opts)==='string'){if(opts==='min'||opts==='max'){if(val!==undefined){return obj.slider(opts,val*-1);}
return Math.abs(obj.slider(opts));}
return obj.slider(opts);}
var min=opts.min,max=opts.max;opts.min=opts.max=null;if(min!==undefined){opts.max=min*-1;}
if(max!==undefined){opts.min=max*-1;}
return obj.slider(opts);}
if(typeof(opts)==='string'&&val!==undefined){return obj.slider(opts,val);}
return obj.slider(opts);},value:function(tp_inst,obj,unit,val){if(tp_inst._defaults.isRTL){if(val!==undefined){return obj.slider('value',val*-1);}
return Math.abs(obj.slider('value'));}
if(val!==undefined){return obj.slider('value',val);}
return obj.slider('value');}},select:{create:function(tp_inst,obj,unit,val,min,max,step){var sel='<select class="ui-timepicker-select ui-state-default ui-corner-all" data-unit="'+unit+'" data-min="'+min+'" data-max="'+max+'" data-step="'+step+'">',format=tp_inst._defaults.pickerTimeFormat||tp_inst._defaults.timeFormat;for(var i=min;i<=max;i+=step){sel+='<option value="'+i+'"'+(i===val?' selected':'')+'>';if(unit==='hour'){sel+=$.datepicker.formatTime($.trim(format.replace(/[^ht ]/ig,'')),{hour:i},tp_inst._defaults);}
else if(unit==='millisec'||unit==='microsec'||i>=10){sel+=i;}
else{sel+='0'+i.toString();}
sel+='</option>';}
sel+='</select>';obj.children('select').remove();$(sel).appendTo(obj).change(function(e){tp_inst._onTimeChange();tp_inst._onSelectHandler();});return obj;},options:function(tp_inst,obj,unit,opts,val){var o={},$t=obj.children('select');if(typeof(opts)==='string'){if(val===undefined){return $t.data(opts);}
o[opts]=val;}
else{o=opts;}
return tp_inst.control.create(tp_inst,obj,$t.data('unit'),$t.val(),o.min||$t.data('min'),o.max||$t.data('max'),o.step||$t.data('step'));},value:function(tp_inst,obj,unit,val){var $t=obj.children('select');if(val!==undefined){return $t.val(val);}
return $t.val();}}}});$.fn.extend({timepicker:function(o){o=o||{};var tmp_args=Array.prototype.slice.call(arguments);if(typeof o==='object'){tmp_args[0]=$.extend(o,{timeOnly:true});}
return $(this).each(function(){$.fn.datetimepicker.apply($(this),tmp_args);});},datetimepicker:function(o){o=o||{};var tmp_args=arguments;if(typeof(o)==='string'){if(o==='getDate'||(o==='option'&&tmp_args.length===2&&typeof(tmp_args[1])==='string')){return $.fn.datepicker.apply($(this[0]),tmp_args);}else{return this.each(function(){var $t=$(this);$t.datepicker.apply($t,tmp_args);});}}else{return this.each(function(){var $t=$(this);$t.datepicker($.timepicker._newInst($t,o)._defaults);});}}});$.datepicker.parseDateTime=function(dateFormat,timeFormat,dateTimeString,dateSettings,timeSettings){var parseRes=parseDateTimeInternal(dateFormat,timeFormat,dateTimeString,dateSettings,timeSettings);if(parseRes.timeObj){var t=parseRes.timeObj;parseRes.date.setHours(t.hour,t.minute,t.second,t.millisec);parseRes.date.setMicroseconds(t.microsec);}
return parseRes.date;};$.datepicker.parseTime=function(timeFormat,timeString,options){var o=extendRemove(extendRemove({},$.timepicker._defaults),options||{}),iso8601=(timeFormat.replace(/\'.*?\'/g,'').indexOf('Z')!==-1);var strictParse=function(f,s,o){var getPatternAmpm=function(amNames,pmNames){var markers=[];if(amNames){$.merge(markers,amNames);}
if(pmNames){$.merge(markers,pmNames);}
markers=$.map(markers,function(val){return val.replace(/[.*+?|()\[\]{}\\]/g,'\\$&');});return'('+markers.join('|')+')?';};var getFormatPositions=function(timeFormat){var finds=timeFormat.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|c{1}|t{1,2}|z|'.*?')/g),orders={h:-1,m:-1,s:-1,l:-1,c:-1,t:-1,z:-1};if(finds){for(var i=0;i<finds.length;i++){if(orders[finds[i].toString().charAt(0)]===-1){orders[finds[i].toString().charAt(0)]=i+1;}}}
return orders;};var regstr='^'+f.toString().replace(/([hH]{1,2}|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,function(match){var ml=match.length;switch(match.charAt(0).toLowerCase()){case'h':return ml===1?'(\\d?\\d)':'(\\d{'+ml+'})';case'm':return ml===1?'(\\d?\\d)':'(\\d{'+ml+'})';case's':return ml===1?'(\\d?\\d)':'(\\d{'+ml+'})';case'l':return'(\\d?\\d?\\d)';case'c':return'(\\d?\\d?\\d)';case'z':return'(z|[-+]\\d\\d:?\\d\\d|\\S+)?';case't':return getPatternAmpm(o.amNames,o.pmNames);default:return'('+match.replace(/\'/g,"").replace(/(\.|\$|\^|\\|\/|\(|\)|\[|\]|\?|\+|\*)/g,function(m){return"\\"+m;})+')?';}}).replace(/\s/g,'\\s?')+
o.timeSuffix+'$',order=getFormatPositions(f),ampm='',treg;treg=s.match(new RegExp(regstr,'i'));var resTime={hour:0,minute:0,second:0,millisec:0,microsec:0};if(treg){if(order.t!==-1){if(treg[order.t]===undefined||treg[order.t].length===0){ampm='';resTime.ampm='';}else{ampm=$.inArray(treg[order.t].toUpperCase(),o.amNames)!==-1?'AM':'PM';resTime.ampm=o[ampm==='AM'?'amNames':'pmNames'][0];}}
if(order.h!==-1){if(ampm==='AM'&&treg[order.h]==='12'){resTime.hour=0;}else{if(ampm==='PM'&&treg[order.h]!=='12'){resTime.hour=parseInt(treg[order.h],10)+12;}else{resTime.hour=Number(treg[order.h]);}}}
if(order.m!==-1){resTime.minute=Number(treg[order.m]);}
if(order.s!==-1){resTime.second=Number(treg[order.s]);}
if(order.l!==-1){resTime.millisec=Number(treg[order.l]);}
if(order.c!==-1){resTime.microsec=Number(treg[order.c]);}
if(order.z!==-1&&treg[order.z]!==undefined){resTime.timezone=$.timepicker.timezoneOffsetNumber(treg[order.z]);}
return resTime;}
return false;};var looseParse=function(f,s,o){try{var d=new Date('2012-01-01 '+s);if(isNaN(d.getTime())){d=new Date('2012-01-01T'+s);if(isNaN(d.getTime())){d=new Date('01/01/2012 '+s);if(isNaN(d.getTime())){throw"Unable to parse time with native Date: "+s;}}}
return{hour:d.getHours(),minute:d.getMinutes(),second:d.getSeconds(),millisec:d.getMilliseconds(),microsec:d.getMicroseconds(),timezone:d.getTimezoneOffset()*-1};}
catch(err){try{return strictParse(f,s,o);}
catch(err2){$.timepicker.log("Unable to parse \ntimeString: "+s+"\ntimeFormat: "+f);}}
return false;};if(typeof o.parse==="function"){return o.parse(timeFormat,timeString,o);}
if(o.parse==='loose'){return looseParse(timeFormat,timeString,o);}
return strictParse(timeFormat,timeString,o);};$.datepicker.formatTime=function(format,time,options){options=options||{};options=$.extend({},$.timepicker._defaults,options);time=$.extend({hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null},time);var tmptime=format,ampmName=options.amNames[0],hour=parseInt(time.hour,10);if(hour>11){ampmName=options.pmNames[0];}
tmptime=tmptime.replace(/(?:HH?|hh?|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,function(match){switch(match){case'HH':return('0'+hour).slice(-2);case'H':return hour;case'hh':return('0'+convert24to12(hour)).slice(-2);case'h':return convert24to12(hour);case'mm':return('0'+time.minute).slice(-2);case'm':return time.minute;case'ss':return('0'+time.second).slice(-2);case's':return time.second;case'l':return('00'+time.millisec).slice(-3);case'c':return('00'+time.microsec).slice(-3);case'z':return $.timepicker.timezoneOffsetString(time.timezone===null?options.timezone:time.timezone,false);case'Z':return $.timepicker.timezoneOffsetString(time.timezone===null?options.timezone:time.timezone,true);case'T':return ampmName.charAt(0).toUpperCase();case'TT':return ampmName.toUpperCase();case't':return ampmName.charAt(0).toLowerCase();case'tt':return ampmName.toLowerCase();default:return match.replace(/'/g,"");}});return tmptime;};$.datepicker._base_selectDate=$.datepicker._selectDate;$.datepicker._selectDate=function(id,dateStr){var inst=this._getInst($(id)[0]),tp_inst=this._get(inst,'timepicker'),was_inline;if(tp_inst&&inst.settings.showTimepicker){tp_inst._limitMinMaxDateTime(inst,true);was_inline=inst.inline;inst.inline=inst.stay_open=true;this._base_selectDate(id,dateStr);inst.inline=was_inline;inst.stay_open=false;this._notifyChange(inst);this._updateDatepicker(inst);}else{this._base_selectDate(id,dateStr);}};$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker;$.datepicker._updateDatepicker=function(inst){var input=inst.input[0];if($.datepicker._curInst&&$.datepicker._curInst!==inst&&$.datepicker._datepickerShowing&&$.datepicker._lastInput!==input){return;}
if(typeof(inst.stay_open)!=='boolean'||inst.stay_open===false){this._base_updateDatepicker(inst);var tp_inst=this._get(inst,'timepicker');if(tp_inst){tp_inst._addTimePicker(inst);}}};$.datepicker._base_doKeyPress=$.datepicker._doKeyPress;$.datepicker._doKeyPress=function(event){var inst=$.datepicker._getInst(event.target),tp_inst=$.datepicker._get(inst,'timepicker');if(tp_inst){if($.datepicker._get(inst,'constrainInput')){var ampm=tp_inst.support.ampm,tz=tp_inst._defaults.showTimezone!==null?tp_inst._defaults.showTimezone:tp_inst.support.timezone,dateChars=$.datepicker._possibleChars($.datepicker._get(inst,'dateFormat')),datetimeChars=tp_inst._defaults.timeFormat.toString().replace(/[hms]/g,'').replace(/TT/g,ampm?'APM':'').replace(/Tt/g,ampm?'AaPpMm':'').replace(/tT/g,ampm?'AaPpMm':'').replace(/T/g,ampm?'AP':'').replace(/tt/g,ampm?'apm':'').replace(/t/g,ampm?'ap':'')+" "+tp_inst._defaults.separator+
tp_inst._defaults.timeSuffix+
(tz?tp_inst._defaults.timezoneList.join(''):'')+
(tp_inst._defaults.amNames.join(''))+(tp_inst._defaults.pmNames.join(''))+
dateChars,chr=String.fromCharCode(event.charCode===undefined?event.keyCode:event.charCode);return event.ctrlKey||(chr<' '||!dateChars||datetimeChars.indexOf(chr)>-1);}}
return $.datepicker._base_doKeyPress(event);};$.datepicker._base_updateAlternate=$.datepicker._updateAlternate;$.datepicker._updateAlternate=function(inst){var tp_inst=this._get(inst,'timepicker');if(tp_inst){var altField=tp_inst._defaults.altField;if(altField){var altFormat=tp_inst._defaults.altFormat||tp_inst._defaults.dateFormat,date=this._getDate(inst),formatCfg=$.datepicker._getFormatConfig(inst),altFormattedDateTime='',altSeparator=tp_inst._defaults.altSeparator?tp_inst._defaults.altSeparator:tp_inst._defaults.separator,altTimeSuffix=tp_inst._defaults.altTimeSuffix?tp_inst._defaults.altTimeSuffix:tp_inst._defaults.timeSuffix,altTimeFormat=tp_inst._defaults.altTimeFormat!==null?tp_inst._defaults.altTimeFormat:tp_inst._defaults.timeFormat;altFormattedDateTime+=$.datepicker.formatTime(altTimeFormat,tp_inst,tp_inst._defaults)+altTimeSuffix;if(!tp_inst._defaults.timeOnly&&!tp_inst._defaults.altFieldTimeOnly&&date!==null){if(tp_inst._defaults.altFormat){altFormattedDateTime=$.datepicker.formatDate(tp_inst._defaults.altFormat,date,formatCfg)+altSeparator+altFormattedDateTime;}
else{altFormattedDateTime=tp_inst.formattedDate+altSeparator+altFormattedDateTime;}}
$(altField).val(inst.input.val()?altFormattedDateTime:"");}}
else{$.datepicker._base_updateAlternate(inst);}};$.datepicker._base_doKeyUp=$.datepicker._doKeyUp;$.datepicker._doKeyUp=function(event){var inst=$.datepicker._getInst(event.target),tp_inst=$.datepicker._get(inst,'timepicker');if(tp_inst){if(tp_inst._defaults.timeOnly&&(inst.input.val()!==inst.lastVal)){try{$.datepicker._updateDatepicker(inst);}catch(err){$.timepicker.log(err);}}}
return $.datepicker._base_doKeyUp(event);};$.datepicker._base_gotoToday=$.datepicker._gotoToday;$.datepicker._gotoToday=function(id){var inst=this._getInst($(id)[0]),$dp=inst.dpDiv;this._base_gotoToday(id);var tp_inst=this._get(inst,'timepicker');selectLocalTimezone(tp_inst);var now=new Date();this._setTime(inst,now);this._setDate(inst,now);};$.datepicker._disableTimepickerDatepicker=function(target){var inst=this._getInst(target);if(!inst){return;}
var tp_inst=this._get(inst,'timepicker');$(target).datepicker('getDate');if(tp_inst){inst.settings.showTimepicker=false;tp_inst._defaults.showTimepicker=false;tp_inst._updateDateTime(inst);}};$.datepicker._enableTimepickerDatepicker=function(target){var inst=this._getInst(target);if(!inst){return;}
var tp_inst=this._get(inst,'timepicker');$(target).datepicker('getDate');if(tp_inst){inst.settings.showTimepicker=true;tp_inst._defaults.showTimepicker=true;tp_inst._addTimePicker(inst);tp_inst._updateDateTime(inst);}};$.datepicker._setTime=function(inst,date){var tp_inst=this._get(inst,'timepicker');if(tp_inst){var defaults=tp_inst._defaults;tp_inst.hour=date?date.getHours():defaults.hour;tp_inst.minute=date?date.getMinutes():defaults.minute;tp_inst.second=date?date.getSeconds():defaults.second;tp_inst.millisec=date?date.getMilliseconds():defaults.millisec;tp_inst.microsec=date?date.getMicroseconds():defaults.microsec;tp_inst._limitMinMaxDateTime(inst,true);tp_inst._onTimeChange();tp_inst._updateDateTime(inst);}};$.datepicker._setTimeDatepicker=function(target,date,withDate){var inst=this._getInst(target);if(!inst){return;}
var tp_inst=this._get(inst,'timepicker');if(tp_inst){this._setDateFromField(inst);var tp_date;if(date){if(typeof date==="string"){tp_inst._parseTime(date,withDate);tp_date=new Date();tp_date.setHours(tp_inst.hour,tp_inst.minute,tp_inst.second,tp_inst.millisec);tp_date.setMicroseconds(tp_inst.microsec);}else{tp_date=new Date(date.getTime());tp_date.setMicroseconds(date.getMicroseconds());}
if(tp_date.toString()==='Invalid Date'){tp_date=undefined;}
this._setTime(inst,tp_date);}}};$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker;$.datepicker._setDateDatepicker=function(target,_date){var inst=this._getInst(target);var date=_date;if(!inst){return;}
if(typeof(_date)==='string'){date=new Date(_date);if(!date.getTime()){this._base_setDateDatepicker.apply(this,arguments);date=$(target).datepicker('getDate');}}
var tp_inst=this._get(inst,'timepicker');var tp_date;if(date instanceof Date){tp_date=new Date(date.getTime());tp_date.setMicroseconds(date.getMicroseconds());}else{tp_date=date;}
if(tp_inst&&tp_date){if(!tp_inst.support.timezone&&tp_inst._defaults.timezone===null){tp_inst.timezone=tp_date.getTimezoneOffset()*-1;}
date=$.timepicker.timezoneAdjust(date,tp_inst.timezone);tp_date=$.timepicker.timezoneAdjust(tp_date,tp_inst.timezone);}
this._updateDatepicker(inst);this._base_setDateDatepicker.apply(this,arguments);this._setTimeDatepicker(target,tp_date,true);};$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker;$.datepicker._getDateDatepicker=function(target,noDefault){var inst=this._getInst(target);if(!inst){return;}
var tp_inst=this._get(inst,'timepicker');if(tp_inst){if(inst.lastVal===undefined){this._setDateFromField(inst,noDefault);}
var date=this._getDate(inst);if(date&&tp_inst._parseTime($(target).val(),tp_inst.timeOnly)){date.setHours(tp_inst.hour,tp_inst.minute,tp_inst.second,tp_inst.millisec);date.setMicroseconds(tp_inst.microsec);if(tp_inst.timezone!=null){if(!tp_inst.support.timezone&&tp_inst._defaults.timezone===null){tp_inst.timezone=date.getTimezoneOffset()*-1;}
date=$.timepicker.timezoneAdjust(date,tp_inst.timezone);}}
return date;}
return this._base_getDateDatepicker(target,noDefault);};$.datepicker._base_parseDate=$.datepicker.parseDate;$.datepicker.parseDate=function(format,value,settings){var date;try{date=this._base_parseDate(format,value,settings);}catch(err){if(err.indexOf(":")>=0){date=this._base_parseDate(format,value.substring(0,value.length-(err.length-err.indexOf(':')-2)),settings);$.timepicker.log("Error parsing the date string: "+err+"\ndate string = "+value+"\ndate format = "+format);}else{throw err;}}
return date;};$.datepicker._base_formatDate=$.datepicker._formatDate;$.datepicker._formatDate=function(inst,day,month,year){var tp_inst=this._get(inst,'timepicker');if(tp_inst){tp_inst._updateDateTime(inst);return tp_inst.$input.val();}
return this._base_formatDate(inst);};$.datepicker._base_optionDatepicker=$.datepicker._optionDatepicker;$.datepicker._optionDatepicker=function(target,name,value){var inst=this._getInst(target),name_clone;if(!inst){return null;}
var tp_inst=this._get(inst,'timepicker');if(tp_inst){var min=null,max=null,onselect=null,overrides=tp_inst._defaults.evnts,fns={},prop,ret,oldVal,$target;if(typeof name==='string'){if(name==='minDate'||name==='minDateTime'){min=value;}else if(name==='maxDate'||name==='maxDateTime'){max=value;}else if(name==='onSelect'){onselect=value;}else if(overrides.hasOwnProperty(name)){if(typeof(value)==='undefined'){return overrides[name];}
fns[name]=value;name_clone={};}}else if(typeof name==='object'){if(name.minDate){min=name.minDate;}else if(name.minDateTime){min=name.minDateTime;}else if(name.maxDate){max=name.maxDate;}else if(name.maxDateTime){max=name.maxDateTime;}
for(prop in overrides){if(overrides.hasOwnProperty(prop)&&name[prop]){fns[prop]=name[prop];}}}
for(prop in fns){if(fns.hasOwnProperty(prop)){overrides[prop]=fns[prop];if(!name_clone){name_clone=$.extend({},name);}
delete name_clone[prop];}}
if(name_clone&&isEmptyObject(name_clone)){return;}
if(min){if(min===0){min=new Date();}else{min=new Date(min);}
tp_inst._defaults.minDate=min;tp_inst._defaults.minDateTime=min;}else if(max){if(max===0){max=new Date();}else{max=new Date(max);}
tp_inst._defaults.maxDate=max;tp_inst._defaults.maxDateTime=max;}else if(onselect){tp_inst._defaults.onSelect=onselect;}
if(min||max){$target=$(target);oldVal=$target.datetimepicker('getDate');ret=this._base_optionDatepicker.call($.datepicker,target,name_clone||name,value);$target.datetimepicker('setDate',oldVal);return ret;}}
if(value===undefined){return this._base_optionDatepicker.call($.datepicker,target,name);}
return this._base_optionDatepicker.call($.datepicker,target,name_clone||name,value);};var isEmptyObject=function(obj){var prop;for(prop in obj){if(obj.hasOwnProperty(prop)){return false;}}
return true;};var extendRemove=function(target,props){$.extend(target,props);for(var name in props){if(props[name]===null||props[name]===undefined){target[name]=props[name];}}
return target;};var detectSupport=function(timeFormat){var tf=timeFormat.replace(/'.*?'/g,'').toLowerCase(),isIn=function(f,t){return f.indexOf(t)!==-1?true:false;};return{hour:isIn(tf,'h'),minute:isIn(tf,'m'),second:isIn(tf,'s'),millisec:isIn(tf,'l'),microsec:isIn(tf,'c'),timezone:isIn(tf,'z'),ampm:isIn(tf,'t')&&isIn(timeFormat,'h'),iso8601:isIn(timeFormat,'Z')};};var convert24to12=function(hour){hour%=12;if(hour===0){hour=12;}
return String(hour);};var computeEffectiveSetting=function(settings,property){return settings&&settings[property]?settings[property]:$.timepicker._defaults[property];};var splitDateTime=function(dateTimeString,timeSettings){var separator=computeEffectiveSetting(timeSettings,'separator'),format=computeEffectiveSetting(timeSettings,'timeFormat'),timeParts=format.split(separator),timePartsLen=timeParts.length,allParts=dateTimeString.split(separator),allPartsLen=allParts.length;if(allPartsLen>1){return{dateString:allParts.splice(0,allPartsLen-timePartsLen).join(separator),timeString:allParts.splice(0,timePartsLen).join(separator)};}
return{dateString:dateTimeString,timeString:''};};var parseDateTimeInternal=function(dateFormat,timeFormat,dateTimeString,dateSettings,timeSettings){var date,parts,parsedTime;parts=splitDateTime(dateTimeString,timeSettings);date=$.datepicker._base_parseDate(dateFormat,parts.dateString,dateSettings);if(parts.timeString===''){return{date:date};}
parsedTime=$.datepicker.parseTime(timeFormat,parts.timeString,timeSettings);if(!parsedTime){throw'Wrong time format';}
return{date:date,timeObj:parsedTime};};var selectLocalTimezone=function(tp_inst,date){if(tp_inst&&tp_inst.timezone_select){var now=date||new Date();tp_inst.timezone_select.val(-now.getTimezoneOffset());}};$.timepicker=new Timepicker();$.timepicker.timezoneOffsetString=function(tzMinutes,iso8601){if(isNaN(tzMinutes)||tzMinutes>840||tzMinutes<-720){return tzMinutes;}
var off=tzMinutes,minutes=off%60,hours=(off-minutes)/60,iso=iso8601?':':'',tz=(off>=0?'+':'-')+('0'+Math.abs(hours)).slice(-2)+iso+('0'+Math.abs(minutes)).slice(-2);if(tz==='+00:00'){return'Z';}
return tz;};$.timepicker.timezoneOffsetNumber=function(tzString){var normalized=tzString.toString().replace(':','');if(normalized.toUpperCase()==='Z'){return 0;}
if(!/^(\-|\+)\d{4}$/.test(normalized)){return tzString;}
return((normalized.substr(0,1)==='-'?-1:1)*((parseInt(normalized.substr(1,2),10)*60)+
parseInt(normalized.substr(3,2),10)));};$.timepicker.timezoneAdjust=function(date,toTimezone){var toTz=$.timepicker.timezoneOffsetNumber(toTimezone);if(!isNaN(toTz)){date.setMinutes(date.getMinutes()+-date.getTimezoneOffset()-toTz);}
return date;};$.timepicker.timeRange=function(startTime,endTime,options){return $.timepicker.handleRange('timepicker',startTime,endTime,options);};$.timepicker.datetimeRange=function(startTime,endTime,options){$.timepicker.handleRange('datetimepicker',startTime,endTime,options);};$.timepicker.dateRange=function(startTime,endTime,options){$.timepicker.handleRange('datepicker',startTime,endTime,options);};$.timepicker.handleRange=function(method,startTime,endTime,options){options=$.extend({},{minInterval:0,maxInterval:0,start:{},end:{}},options);var timeOnly=false;if(method==='timepicker'){timeOnly=true;method='datetimepicker';}
function checkDates(changed,other){var startdt=startTime[method]('getDate'),enddt=endTime[method]('getDate'),changeddt=changed[method]('getDate');if(startdt!==null){var minDate=new Date(startdt.getTime()),maxDate=new Date(startdt.getTime());minDate.setMilliseconds(minDate.getMilliseconds()+options.minInterval);maxDate.setMilliseconds(maxDate.getMilliseconds()+options.maxInterval);if(options.minInterval>0&&minDate>enddt){endTime[method]('setDate',minDate);}
else if(options.maxInterval>0&&maxDate<enddt){endTime[method]('setDate',maxDate);}
else if(startdt>enddt){other[method]('setDate',changeddt);}}}
function selected(changed,other,option){if(!changed.val()){return;}
var date=changed[method].call(changed,'getDate');if(date!==null&&options.minInterval>0){if(option==='minDate'){date.setMilliseconds(date.getMilliseconds()+options.minInterval);}
if(option==='maxDate'){date.setMilliseconds(date.getMilliseconds()-options.minInterval);}}
if(date.getTime){other[method].call(other,'option',option,date);}}
$.fn[method].call(startTime,$.extend({timeOnly:timeOnly,onClose:function(dateText,inst){checkDates($(this),endTime);},onSelect:function(selectedDateTime){selected($(this),endTime,'minDate');}},options,options.start));$.fn[method].call(endTime,$.extend({timeOnly:timeOnly,onClose:function(dateText,inst){checkDates($(this),startTime);},onSelect:function(selectedDateTime){selected($(this),startTime,'maxDate');}},options,options.end));checkDates(startTime,endTime);selected(startTime,endTime,'minDate');selected(endTime,startTime,'maxDate');return $([startTime.get(0),endTime.get(0)]);};$.timepicker.log=function(){if(window.console){window.console.log.apply(window.console,Array.prototype.slice.call(arguments));}};$.timepicker._util={_extendRemove:extendRemove,_isEmptyObject:isEmptyObject,_convert24to12:convert24to12,_detectSupport:detectSupport,_selectLocalTimezone:selectLocalTimezone,_computeEffectiveSetting:computeEffectiveSetting,_splitDateTime:splitDateTime,_parseDateTimeInternal:parseDateTimeInternal};if(!Date.prototype.getMicroseconds){Date.prototype.microseconds=0;Date.prototype.getMicroseconds=function(){return this.microseconds;};Date.prototype.setMicroseconds=function(m){this.setMilliseconds(this.getMilliseconds()+Math.floor(m/1000));this.microseconds=m%1000;return this;};}
$.timepicker.version="1.5.0";})(jQuery);(function($,undefined){var multiselectID=0;var $doc=$(document);$.widget('ech.multiselect',{options:{header:true,height:175,minWidth:225,classes:'',checkAllText:'Check all',uncheckAllText:'Uncheck all',allSelectedText:'All selected',noneSelectedText:'Select options',selectedText:'# selected',selectedList:0,show:null,hide:null,autoOpen:false,multiple:true,position:{},appendTo:'body',create:{}},_create:function(){var el=this.element.hide();var o=this.options;this.speed=$.fx.speeds._default;this._isOpen=false;this._namespaceID=this.eventNamespace||('multiselect'+multiselectID);var button=(this.button=$('<button type="button"><span class="ui-icon ui-icon-triangle-1-s"></span></button>')).addClass('ui-multiselect ui-widget ui-state-default ui-corner-all').addClass(o.classes).attr({'title':el.attr('title'),'aria-haspopup':true,'tabIndex':el.attr('tabIndex')}).insertAfter(el),buttonlabel=(this.buttonlabel=$('<span />')).html(o.noneSelectedText).appendTo(button),menu=(this.menu=$('<div />')).addClass('ui-multiselect-menu ui-widget ui-widget-content ui-corner-all').addClass(o.classes).appendTo($(o.appendTo)),header=(this.header=$('<div />')).addClass('ui-widget-header ui-corner-all ui-multiselect-header ui-helper-clearfix').appendTo(menu),headerLinkContainer=(this.headerLinkContainer=$('<ul />')).addClass('ui-helper-reset').html(function(){if(o.header===true){return'<li><a class="ui-multiselect-all" href="#"><span class="ui-icon ui-icon-check"></span><span>'+o.checkAllText+'</span></a></li><li><a class="ui-multiselect-none" href="#"><span class="ui-icon ui-icon-closethick"></span><span>'+o.uncheckAllText+'</span></a></li>';}else if(typeof o.header==="string"){return'<li>'+o.header+'</li>';}else{return'';}}).append('<li class="ui-multiselect-close"><a href="#" class="ui-multiselect-close"><span class="ui-icon ui-icon-circle-close"></span></a></li>').appendTo(header),checkboxContainer=(this.checkboxContainer=$('<ul />')).addClass('ui-multiselect-checkboxes ui-helper-reset').appendTo(menu);this._bindEvents();this.refresh(true);if(!o.multiple){menu.addClass('ui-multiselect-single');}
if(el.hasClass('hide')){button.hide();}
multiselectID++;},_init:function(){if(this.options.header===false){this.header.hide();}
if(!this.options.multiple){this.headerLinkContainer.find('.ui-multiselect-all, .ui-multiselect-none').hide();}
if(this.options.autoOpen){this.open();}
if(this.element.is(':disabled')){this.disable();}},refresh:function(init){var el=this.element;var o=this.options;var menu=this.menu;var checkboxContainer=this.checkboxContainer;var optgroups=[];var html='';var id=el.attr('id')||multiselectID++;el.find('option').each(function(i){var $this=$(this);var parent=this.parentNode;var description=this.innerHTML;var title=this.title;var value=this.value;var inputID='ui-multiselect-'+(this.id||id+'-option-'+i);var isDisabled=this.disabled;var isSelected=this.selected;var labelClasses=['ui-corner-all'];var liClasses=(isDisabled?'ui-multiselect-disabled ':' ')+this.className;var optLabel;if(parent.tagName==='OPTGROUP'){optLabel=parent.getAttribute('label');if($.inArray(optLabel,optgroups)===-1){html+='<li class="ui-multiselect-optgroup-label '+parent.className+'"><a href="#">'+optLabel+'</a></li>';optgroups.push(optLabel);}}
if(isDisabled){labelClasses.push('ui-state-disabled');}
if(isSelected&&!o.multiple){labelClasses.push('ui-state-active');}
html+='<li class="'+liClasses+'">';html+='<label for="'+inputID+'" title="'+title+'" class="'+labelClasses.join(' ')+'">';html+='<input id="'+inputID+'" name="multiselect_'+id+'" type="'+(o.multiple?"checkbox":"radio")+'" value="'+value+'" title="'+title+'"';if(isSelected){html+=' checked="checked"';html+=' aria-selected="true"';}
if(isDisabled){html+=' disabled="disabled"';html+=' aria-disabled="true"';}
html+=' /><span>'+description+'</span></label></li>';});if(!$.isEmptyObject(o.create)){var opts=o.create;var url=S3.Ap.concat('/',opts.c,'/',opts.f,'/create?format=popup&caller=',id);if(opts.parent){url+='&parent='+opts.parent;}
if(opts.child){url+='&child='+opts.child;}
var label=opts.label;html+='<li><a class="s3_modal" target="top" title="'+label+'" href="'+url+'"><label class="ui-corner-all"><span><i>'+label+'</i></span></label></a></li>';}
checkboxContainer.html(html);if(!$.isEmptyObject(o.create)){S3.addModals();}
this.labels=menu.find('label');this.inputs=this.labels.children('input');this._setButtonWidth();this._setMenuWidth();this.button[0].defaultValue=this.update();if(!init){this._trigger('refresh');}},update:function(){var o=this.options;var value;if(o.multiple){var $inputs=this.inputs;var $checked=$inputs.filter(':checked');var numChecked=$checked.length;if(numChecked===0){value=o.noneSelectedText;}else if(numChecked===$inputs.length){value=o.allSelectedText;}else{if($.isFunction(o.selectedText)){value=o.selectedText.call(this,numChecked,$inputs.length,$checked.get());}else if(/\d/.test(o.selectedList)&&o.selectedList>0&&numChecked<=o.selectedList){value=$checked.map(function(){return $('<div>').html($(this).next().html()).text();}).get().join(', ');}else{value=o.selectedText.replace('#',numChecked).replace('#',$inputs.length);}}}else{if(!this.element[0].value){value=o.noneSelectedText;}else{value=this.element[0].selectedOptions&&this.element[0].selectedOptions[0].innerHTML;}}
this._setButtonValue(value);return value;},_setButtonValue:function(value){this.buttonlabel.text(value);},_bindEvents:function(){var self=this;var button=this.button;function clickHandler(){self[self._isOpen?'close':'open']();return false;}
button.find('span').bind('click.multiselect',clickHandler);button.bind({click:clickHandler,keypress:function(e){switch(e.which){case 27:case 38:case 37:self.close();break;case 39:case 40:self.open();break;}},mouseenter:function(){if(!button.hasClass('ui-state-disabled')){$(this).addClass('ui-state-hover');}},mouseleave:function(){$(this).removeClass('ui-state-hover');},focus:function(){if(!button.hasClass('ui-state-disabled')){$(this).addClass('ui-state-focus');}},blur:function(){$(this).removeClass('ui-state-focus');}});this.header.delegate('a','click.multiselect',function(e){if($(this).hasClass('ui-multiselect-close')){self.close();}else{self[$(this).hasClass('ui-multiselect-all')?'checkAll':'uncheckAll']();}
e.preventDefault();});this.menu.delegate('li.ui-multiselect-optgroup-label a','click.multiselect',function(e){e.preventDefault();var $this=$(this);var $inputs=$this.parent().nextUntil('li.ui-multiselect-optgroup-label').find('input:visible:not(:disabled)');var nodes=$inputs.get();var label=$this.parent().text();if(self._trigger('beforeoptgrouptoggle',e,{inputs:nodes,label:label})===false){return;}
self._toggleChecked($inputs.filter(':checked').length!==$inputs.length,$inputs);self._trigger('optgrouptoggle',e,{inputs:nodes,label:label,checked:nodes[0].checked});}).delegate('label','mouseenter.multiselect',function(){if(!$(this).hasClass('ui-state-disabled')){self.labels.removeClass('ui-state-hover');$(this).addClass('ui-state-hover').find('input').focus();}}).delegate('label','keydown.multiselect',function(e){e.preventDefault();switch(e.which){case 9:case 27:self.close();break;case 38:case 40:case 37:case 39:self._traverse(e.which,this);break;case 13:$(this).find('input')[0].click();break;}}).delegate('input[type="checkbox"], input[type="radio"]','click.multiselect',function(e){var $this=$(this);var val=this.value;var checked=this.checked;var tags=self.element.find('option');if(this.disabled||self._trigger('click',e,{value:val,text:this.title,checked:checked})===false){e.preventDefault();return;}
$this.focus();$this.attr('aria-selected',checked);tags.each(function(){if(this.value===val){this.selected=checked;}else if(!self.options.multiple){this.selected=false;}});if(!self.options.multiple){self.labels.removeClass('ui-state-active');$this.closest('label').toggleClass('ui-state-active',checked);self.close();}
self.element.trigger('change');setTimeout($.proxy(self.update,self),10);});$doc.bind('mousedown.'+this._namespaceID,function(event){var target=event.target;if(self._isOpen&&target!==self.button[0]&&target!==self.menu[0]&&!$.contains(self.menu[0],target)&&!$.contains(self.button[0],target)){self.close();}});$(this.element[0].form).bind('reset.'+this._namespaceID,function(){setTimeout($.proxy(self.refresh,self),10);});},_setButtonWidth:function(){var width=this.element.outerWidth();var o=this.options;if(/\d/.test(o.minWidth)&&width<o.minWidth){width=o.minWidth;}
this.button.outerWidth(width);},_setMenuWidth:function(){this.menu.outerWidth(this.button.outerWidth());},_traverse:function(which,start){var $start=$(start);var moveToLast=which===38||which===37;var $next=$start.parent()[moveToLast?'prevAll':'nextAll']('li:not(.ui-multiselect-disabled, .ui-multiselect-optgroup-label)').first();if(!$next.length){var $container=this.menu.find('ul').last();this.menu.find('label')[moveToLast?'last':'first']().trigger('mouseover');$container.scrollTop(moveToLast?$container.height():0);}else{$next.find('label').trigger('mouseover');}},_toggleState:function(prop,flag){return function(){if(!this.disabled){this[prop]=flag;}
if(flag){this.setAttribute('aria-selected',true);}else{this.removeAttribute('aria-selected');}};},_toggleChecked:function(flag,group){var $inputs=(group&&group.length)?group:this.inputs;var self=this;$inputs.each(this._toggleState('checked',flag));$inputs.eq(0).focus();this.update();var values=$inputs.map(function(){return this.value;}).get();this.element.find('option').each(function(){if(!this.disabled&&$.inArray(this.value,values)>-1){self._toggleState('selected',flag).call(this);}});if($inputs.length){this.element.trigger('change');}},_toggleDisabled:function(flag){this.button.attr({'disabled':flag,'aria-disabled':flag})[flag?'addClass':'removeClass']('ui-state-disabled');var inputs=this.menu.find('input');var key='ech-multiselect-disabled';if(flag){inputs=inputs.filter(':enabled').data(key,true)}else{inputs=inputs.filter(function(){return $.data(this,key)===true;}).removeData(key);}
inputs.attr({'disabled':flag,'arial-disabled':flag}).parent()[flag?'addClass':'removeClass']('ui-state-disabled');this.element.attr({'disabled':flag,'aria-disabled':flag});},open:function(e){var self=this;var button=this.button;var menu=this.menu;var speed=this.speed;var o=this.options;var args=[];if(this._trigger('beforeopen')===false||button.hasClass('ui-state-disabled')||this._isOpen){return;}
var $container=menu.find('ul').last();var effect=o.show;if($.isArray(o.show)){effect=o.show[0];speed=o.show[1]||self.speed;}
if(effect){args=[effect,speed];}
$container.scrollTop(0).height(o.height);this.position();$.fn.show.apply(menu,args);this.labels.filter(':not(.ui-state-disabled)').eq(0).trigger('mouseover').trigger('mouseenter').find('input').trigger('focus');button.addClass('ui-state-active');this._isOpen=true;this._trigger('open');},close:function(){if(this._trigger('beforeclose')===false){return;}
var o=this.options;var effect=o.hide;var speed=this.speed;var args=[];if($.isArray(o.hide)){effect=o.hide[0];speed=o.hide[1]||this.speed;}
if(effect){args=[effect,speed];}
$.fn.hide.apply(this.menu,args);this.button.removeClass('ui-state-active').trigger('blur').trigger('mouseleave');this._isOpen=false;this._trigger('close');},enable:function(){this._toggleDisabled(false);},disable:function(){this._toggleDisabled(true);},checkAll:function(e){this._toggleChecked(true);this._trigger('checkAll');},uncheckAll:function(){this._toggleChecked(false);this._trigger('uncheckAll');},getChecked:function(){return this.menu.find('input').filter(':checked');},destroy:function(){$.Widget.prototype.destroy.call(this);$doc.unbind(this._namespaceID);$(this.element[0].form).unbind(this._namespaceID);this.button.remove();this.menu.remove();this.element.show();return this;},isOpen:function(){return this._isOpen;},widget:function(){return this.menu;},getButton:function(){return this.button;},position:function(){var o=this.options;if($.ui.position&&!$.isEmptyObject(o.position)){o.position.of=o.position.of||this.button;this.menu.show().position(o.position).hide();}else{var pos=this.button.offset();this.menu.css({top:pos.top+this.button.outerHeight(),left:pos.left});}},_setOption:function(key,value){var menu=this.menu;switch(key){case'header':menu.find('div.ui-multiselect-header')[value?'show':'hide']();break;case'checkAllText':menu.find('a.ui-multiselect-all span').eq(-1).text(value);break;case'uncheckAllText':menu.find('a.ui-multiselect-none span').eq(-1).text(value);break;case'height':menu.find('ul').last().height(parseInt(value,10));break;case'minWidth':this.options[key]=parseInt(value,10);this._setButtonWidth();this._setMenuWidth();break;case'selectedText':case'selectedList':case'noneSelectedText':this.options[key]=value;this.update();break;case'classes':menu.add(this.button).removeClass(this.options.classes).addClass(value);break;case'multiple':menu.toggleClass('ui-multiselect-single',!value);this.options.multiple=value;this.element[0].multiple=value;this.refresh();break;case'position':this.position();}
$.Widget.prototype._setOption.apply(this,arguments);}});})(jQuery);(function($){var rEscape=/[\-\[\]{}()*+?.,\\\^$|#\s]/g;$.widget('ech.multiselectfilter',{options:{label:'Filter:',width:null,placeholder:'Enter keywords',autoReset:false},_create:function(){var opts=this.options;var elem=$(this.element);var instance=(this.instance=(elem.data('echMultiselect')||elem.data("multiselect")||elem.data("ech-multiselect")));var header=(this.header=instance.menu.find('.ui-multiselect-header').addClass('ui-multiselect-hasfilter'));var wrapper=(this.wrapper=$('<div class="ui-multiselect-filter">'+(opts.label.length?opts.label:'')+'<input placeholder="'+opts.placeholder+'" type="search"'+(/\d/.test(opts.width)?'style="width:'+opts.width+'px"':'')+' /></div>').prependTo(this.header));this.inputs=instance.menu.find('input[type="checkbox"], input[type="radio"]');this.input=wrapper.find('input').bind({keydown:function(e){if(e.which===13){e.preventDefault();}},keyup:$.proxy(this._handler,this),click:$.proxy(this._handler,this)});this.updateCache();instance._toggleChecked=function(flag,group){var $inputs=(group&&group.length)?group:this.labels.find('input');var _self=this;var selector=_self._isOpen?':disabled, :hidden':':disabled';$inputs=$inputs.not(selector).each(this._toggleState('checked',flag));this.update();var values=$inputs.map(function(){return this.value;}).get();this.element.find('option').filter(function(){if(!this.disabled&&$.inArray(this.value,values)>-1){_self._toggleState('selected',flag).call(this);}});if($inputs.length){this.element.trigger('change');}};var doc=$(document).bind('multiselectrefresh.'+instance._namespaceID,$.proxy(function(){this.updateCache();this._handler();},this));if(this.options.autoReset){doc.bind('multiselectclose.'+instance._namespaceID,$.proxy(this._reset,this));}},_handler:function(e){var term=$.trim(this.input[0].value.toLowerCase()),rows=this.rows,inputs=this.inputs,cache=this.cache;if(!term){rows.show();}else{rows.hide();var regex=new RegExp(term.replace(rEscape,"\\$&"),'gi');this._trigger("filter",e,$.map(cache,function(v,i){if(v.search(regex)!==-1){rows.eq(i).show();return inputs.get(i);}
return null;}));}
this.instance.menu.find(".ui-multiselect-optgroup-label").each(function(){var $this=$(this);var isVisible=$this.nextUntil('.ui-multiselect-optgroup-label').filter(function(){return $.css(this,"display")!=='none';}).length;$this[isVisible?'show':'hide']();});},_reset:function(){this.input.val('').trigger('keyup');},updateCache:function(){this.rows=this.instance.menu.find(".ui-multiselect-checkboxes li:not(.ui-multiselect-optgroup-label)");this.cache=this.element.children().map(function(){var elem=$(this);if(this.tagName.toLowerCase()==="optgroup"){elem=elem.children();}
return elem.map(function(){return this.innerHTML.toLowerCase();}).get();}).get();},widget:function(){return this.wrapper;},destroy:function(){$.Widget.prototype.destroy.call(this);this.input.val('').trigger("keyup");this.wrapper.remove();}});})(jQuery);if(typeof String.prototype.startsWith!='function'){String.prototype.startsWith=function(str){return this.substring(0,str.length)===str;};}
var S3={};S3.gis={};S3.gis.options={};S3.timeline={};S3.JSONRequest={};S3.queryString={parse:function(str){if(typeof str!=='string'){return{};}
str=str.trim().replace(/^(\?|#)/,'');if(!str){return{};}
return str.trim().split('&').reduce(function(ret,param){var parts=param.replace(/\+/g,' ').split('=');var key=parts[0];var val=parts[1];key=decodeURIComponent(key);val=val===undefined?null:decodeURIComponent(val);if(!ret.hasOwnProperty(key)){ret[key]=val;}else if(Array.isArray(ret[key])){ret[key].push(val);}else{ret[key]=[ret[key],val];}
return ret;},{});},stringify:function(obj){return obj?Object.keys(obj).map(function(key){var val=obj[key];if(Array.isArray(val)){return val.map(function(val2){return encodeURIComponent(key)+'='+encodeURIComponent(val2);}).join('&');}
return encodeURIComponent(key)+'='+encodeURIComponent(val);}).join('&'):'';}};S3.uid=function(){return(((+(new Date()))/1000*0x10000+Math.random()*0xffff)>>0).toString(16);};S3.Utf8={encode:function(string){string=string.replace(/\r\n/g,'\n');var utftext='';for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c);}else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128);}else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128);}}
return utftext;},decode:function(utftext){var string='',i=0,c=0,c1=0,c2=0;while(i<utftext.length){c=utftext.charCodeAt(i);if(c<128){string+=String.fromCharCode(c);i++;}else if((c>191)&&(c<224)){c1=utftext.charCodeAt(i+1);string+=String.fromCharCode(((c&31)<<6)|(c1&63));i+=2;}else{c1=utftext.charCodeAt(i+1);c2=utftext.charCodeAt(i+2);string+=String.fromCharCode(((c&15)<<12)|((c1&63)<<6)|(c2&63));i+=3;}}
return string;}};S3.addTooltips=function(){$.cluetip.defaults.cluezIndex=9999;$('.tooltip').cluetip({activation:'hover',sticky:false,splitTitle:'|'});$('label[title][title!=""]').cluetip({splitTitle:'|',showTitle:false});$('.tooltipbody').cluetip({activation:'hover',sticky:false,splitTitle:'|',showTitle:false});var tipCloseText='<img src="'+S3.Ap.concat('/static/img/cross2.png')+'" alt="close" />';$('.stickytip').cluetip({activation:'hover',sticky:true,closePosition:'title',closeText:tipCloseText,splitTitle:'|'});$('.errortip').cluetip({activation:'click',sticky:true,closePosition:'title',closeText:tipCloseText,splitTitle:'|'});$('.ajaxtip').cluetip({activation:'click',sticky:true,closePosition:'title',closeText:tipCloseText,width:380});};S3.addModals=function(){$('a.s3_add_resource_link').attr('href',function(index,attr){var url_out=attr;if(attr.indexOf('caller=')==-1){var caller=$(this).parents('tr').attr('id');if(!caller){caller=$(this).parent().parent().attr('id');}
if(!caller){caller=$(this).parents('.form-row').attr('id');}
if(!caller){caller=$(this).parents('.control-group').attr('id');}
if(caller){caller=caller.replace(/__row_comment/,'').replace(/__row/,'');url_out=attr+'&caller='+caller;}}
return url_out;});$('.s3_add_resource_link, .s3_modal').off('.S3Modal').on('click.S3Modal',function(){var title=this.title;var url=this.href;var i=url.indexOf('caller=');if(i!=-1){var caller=url.slice(i+7);i=caller.indexOf('&');if(i!=-1){caller=caller.slice(0,i);}
var select=$('#'+caller);if(select.hasClass('multiselect-widget')){select.multiselect('close');}}
var id=S3.uid(),dialog=$('<iframe>',{'id':id,'src':'','class':'loading','load':function(){if($(this).attr('src')){S3.popup_loaded(id);}},'marginWidth':'0','marginHeight':'0','frameBorder':'0'}).appendTo('body');var self=this;dialog.dialog({autoOpen:false,title:title,minHeight:480,minWidth:320,modal:true,closeText:'',open:function(){$('.ui-widget-overlay').bind('click',function(){dialog.dialog('close');});},close:function(){if(self.parent){var iframe=self.parent.$('iframe.ui-dialog-content');var width=iframe.width();iframe.width(0);window.setTimeout(function(){iframe.width(width);},300);}
dialog.attr('src','').remove();},});dialog.attr('src',url).dialog('open');return false;});};S3.popup_loaded=function(id){if(window!=window.parent){var parent_dialog=$(window.parent.document).find('.ui-dialog');var parent_height=parent_dialog.height();parent_dialog.height(parent_height+41);var parent_iframe=parent_dialog.find('iframe');var parent_iframe_height=parent_iframe.height();parent_iframe.height(parent_iframe_height+41);}
var width=$('.ui-dialog').width();$('#'+id).removeClass('loading').width(width).contents().find('#popup').show();};S3.popup_remove=function(){$('iframe.ui-dialog-content').dialog('close');};S3.redraw_fns=['addModals','addTooltips'];S3.redraw=function(){var redraw_fns=S3.redraw_fns;var len=redraw_fns.length;for(var i=0;i<len;i++){S3[redraw_fns[i]]();}};$.widget('custom.iconselectmenu',$.ui.selectmenu,{_renderItem:function(ul,item){var li=$('<li>',{text:item.label});if(item.disabled){li.addClass('ui-state-disabled');}
var element=item.element;var _class=item.element.attr('data-class');if(_class){_class='ui-icon '+_class;}else{_class='ui-icon';}
$('<span>',{'style':element.attr('data-style'),'class':_class}).appendTo(li);return li.appendTo(ul);}});S3.getClientLocation=function(targetfield){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(position){var clientlocation=position.coords.latitude+'|'+position.coords.longitude+'|'+position.coords.accuracy;targetfield.val(clientlocation);});}};S3.confirmClick=function(ElementID,Message){if(S3.interactive){$(ElementID).click(function(event){if(confirm(Message)){return true;}else{event.preventDefault();return false;}});}};S3.autoTotals=function(sumField,sourceFields,tablename){if(tablename===undefined){tablename='';}else{tablename=tablename+'_';}
sumField=$('#'+tablename+sumField);var fieldname,value,total;for(var i=0;i<sourceFields.length;i++){fieldname=sourceFields[i];$('#'+tablename+fieldname).change(function(){total=0;for(var j=0;j<sourceFields.length;j++){fieldname=sourceFields[j];value=$('#'+tablename+fieldname).val();if(value){total+=parseInt(value);}}
sumField.val(total).trigger('change');});}};S3.showHidden=function(controlField,affectedFields,tablename){if(tablename===undefined){tablename='';}else{tablename=tablename+'_';}
controlField=$('#'+tablename+controlField);controlField.change(function(){var fieldname,selector,i;if(controlField.prop('checked')){for(i=0;i<affectedFields.length;i++){fieldname=affectedFields[i];selector='#'+tablename+fieldname;$(selector+'__row, '+selector+'__subheading, '+selector+'__subheading1, '+selector+'__subheading2').show();}}else{for(i=0;i<affectedFields.length;i++){fieldname=affectedFields[i];selector='#'+tablename+fieldname;$(selector+'__row, '+selector+'__subheading, '+selector+'__subheading1, '+selector+'__subheading2').hide();}}});controlField.trigger('change');};S3.trunk8=function(selector,lines,more){var settings={fill:'&hellip; <a class="s3-truncate-more" href="#">'+more+'</a>'};if(lines){settings.lines=lines;}
$(selector).trunk8(settings);$('.dl').on('listUpdate',function(){$(this).find(selector).each(function(){if(this.trunk8===undefined){$(this).trunk8(settings);}});});$('.dataTable').on('draw.dt',function(){$(this).find(selector).each(function(){if(this.trunk8===undefined){$(this).trunk8(settings);}});});};S3.maxLength={init:function(id,maxLength){var apply=this.apply;if(maxLength){var input=$('#'+id);input.next('div.maxLength_status').remove();input.after('<div class="maxLength_status"></div>');apply(id,maxLength);input.unbind('keyup.maxLength').bind('keyup.maxLength',function(){apply(id,maxLength);});}else{$('#'+id).removeClass('maxLength').unbind('keyup.maxLength').next('div.maxLength_status').remove();}},apply:function(id,maxLength){var message=i18n.characters_left||'characters left',input=$('#'+id),currentLength=input.val().length;if(currentLength>=maxLength){input.addClass('maxLength');input.val(input.val().substr(0,maxLength));}else{input.removeClass('maxLength');}
var remaining=maxLength-currentLength;if(remaining<0){remaining=0;}
input.next('div.maxLength_status').html(remaining+' '+message);}};var S3SetNavigateAwayConfirm=function(event,trigger){if(trigger!=='implicit'){window.onbeforeunload=function(){return i18n.unsaved_changes;};}};var S3ClearNavigateAwayConfirm=function(){window.onbeforeunload=function(){};};var S3EnableNavigateAwayConfirm=function(){$(document).ready(function(){if($('[class=error]').length>0){S3SetNavigateAwayConfirm();}
var form=$('form:not(.filter-form,.pt-form)');$('input, textarea',form).keypress(S3SetNavigateAwayConfirm).change(S3SetNavigateAwayConfirm);$('select',form).change(S3SetNavigateAwayConfirm);form.submit(S3ClearNavigateAwayConfirm);});};(function($){$.ajaxS3Settings={timeout:10000,retryLimit:5,dataType:'json',async:true,type:'GET'};function AjaxS3(ajaxOptions){this.xhr=null;var options=$.extend({},$.ajaxS3Settings,ajaxOptions);this.options=options;this.successCallback=ajaxOptions.success;this.errorCallback=ajaxOptions.error;options.success=null;options.error=null;this.message=ajaxOptions.message;this.tryCount=0;this.retryLimit=options.retryLimit;this.alerts=[];this.ignoreStatus=options.ignoreStatus||[];}
AjaxS3.prototype.onSuccess=function(data){var self=this.AjaxS3;if(!self){return;}
self.tryCount=0;self.xhr=null;S3.hideAlerts(self.alerts);if(data&&data.message){S3.showAlert(data.message,'success');}
var successCallback=self.successCallback;if(successCallback){successCallback.apply(this,arguments);}};AjaxS3.prototype.onFailure=function(jqXHR,textStatus){var self=this.AjaxS3;if(!self){return;}
var httpStatus=jqXHR.status,readyState=jqXHR.readyState,navigateAway=!httpStatus&&readyState===0;if(textStatus=='abort'||navigateAway){self.tryCount=0;self.xhr=null;if(navigateAway){return;}}else if(textStatus=='timeout'){self.tryCount++;var tryCount=self.tryCount,message=self.message;if(tryCount<=self.retryLimit){message=i18n.ajax_get+' '+(message?message:i18n.ajax_fmd)+'... '+i18n.ajax_rtr+' '+tryCount;self.alerts.push(S3.showAlert(message,'warning'));self.send();return;}else{self.xhr=null;}
message=i18n.ajax_wht+' '+tryCount+' '+i18n.ajax_gvn;S3.showAlert(message,'error');}else if(httpStatus==500){S3.showAlert(i18n.ajax_500,'error');}else{if(self.ignoreStatus.indexOf(httpStatus)!=-1){}else{var responseJSON=jqXHR.responseJSON;if(responseJSON&&responseJSON.message){S3.showAlert(responseJSON.message,'error');}else{S3.showAlert(i18n.ajax_dwn,'error');}}}
var errorCallback=self.errorCallback;if(errorCallback){errorCallback.apply(this,arguments);}};AjaxS3.prototype.start=function(){if(this.xhr!==null){return;}
var message=this.message;if(message){message=i18n.ajax_get+' '+(message?message:i18n.ajax_fmd)+'...';this.alerts.push(S3.showAlert(message,'info'));}
this.send();return this;};AjaxS3.prototype.send=function(){var options=this.options;options.AjaxS3=this;this.xhr=$.ajax(options).done(function(){this.AjaxS3.onSuccess.apply(this,arguments);}).fail(function(){this.AjaxS3.onFailure.apply(this,arguments);});};AjaxS3.prototype.abort=function(){if(this.xhr){this.xhr.abort();this.xhr=null;}};$.ajaxS3=function(options){return new AjaxS3(options).start();};$.getS3=function(url,data,callback,type,message,sync){if($.isFunction(data)){sync=message;message=type;type=callback;callback=data;data=null;}
return $.ajaxS3({type:'GET',url:url,async:!sync,data:data,dataType:type,message:message,success:callback});};$.getJSONS3=function(url,data,callback,message,sync){if($.isFunction(data)){sync=message;message=callback;callback=data;data=null;}
if(!sync){sync=false;}
return $.getS3(url,data,callback,'json',message,sync);};})($);S3.showAlert=function(message,type,callback){if(!type){type='success';}
var alertSpace=$('#alert-space'),alert=$('<div class="alert alert-'+type+'">'+message+'<button type="button" class="close" data-dismiss="alert"></button></div>');alertSpace.append(alert).undelegate('.s3').delegate('.alert','click.s3',function(){$(this).fadeOut('slow').remove();if(callback){callback();}
return false;});return alert;};S3.hideAlerts=function(alerts){if(typeof alerts=='string'){$('.alert-'+alerts).remove();}else if(alerts){alerts.forEach(function(alert){alert.remove();});}else{$('#alert-space').empty();}};S3.fieldError=function(selector,error){$(selector).after('<div class="error" style="display: block;">'+error+'</div>');};S3.unmask=function(table,field){var caller=table+'_'+field+'_'+'unmask';var target=table+'_'+field;var state=$('#'+caller).text();if(state==i18n.password_view){state=i18n.password_mask;$('#'+target).attr('type','text');$('#'+caller).text(state);}
else{state=i18n.password_view;$('#'+target).attr('type','password');$('#'+caller).text(state);}};var s3_viewMap=function(location_id,iframe_height,popup,controller,func){var url=S3.Ap.concat('/gis/display_feature/')+location_id,$map=$('#map'),$iframe_map=$('#iframe-map'),curl=document.location.pathname.split("/");if(controller===undefined){controller=curl[2];}
if(func===undefined){func=curl[3];}
url+='?c='+controller+'&f='+func;if((curl.length>6)&&($.isNumeric(curl[6]))){url+='&r='+curl[6];}else if((curl.length>4)&&($.isNumeric(curl[4]))){url+='&r='+curl[4];}
if($map.length==0||popup=='True'){url+='&popup=1';S3.openPopup(url,true);}else{var toggleButton=function(){var closeMap=$('#close-iframe-map');if($iframe_map.is(':visible')){closeMap.css({'display':''});}else{closeMap.css({'display':'none'});}};var closeMap=function(){$('#iframe-map').slideUp('medium');$('#close-iframe-map').css({'display':'none'});};if($iframe_map.length==0){var iframe=$("<iframe id='iframe-map' data-feature='"+location_id+"' style='border-style:none' width='100%' height='"+iframe_height+"' src='"+url+"' />"),closelink=$("<a class='button tiny' id='close-iframe-map'>"+i18n.close_map+"</a>");closelink.bind('click',closeMap);$map.slideDown('medium');$map.append(iframe);$map.append($('<div style="margin-bottom:10px" />').append(closelink));}else{var fid=$iframe_map.attr('data-feature');if(fid==location_id){$iframe_map.slideToggle('medium',toggleButton);}else{$iframe_map.attr({'src':url,'data-feature':location_id});$iframe_map.slideDown('medium',toggleButton);}}}};var s3_viewMapMulti=function(module,resource,instance,jresource){var url=S3.Ap.concat('/gis/display_feature//?module=')+module+'&resource='+resource+'&instance='+instance+'&jresource='+jresource;var oldhtml=$('#map').html();var iframe='<iframe width="640" height="480" src="'+url+'"></iframe>';var closelink=$('<a href=\"#\">'+i18n.close_map+'</a>');closelink.bind('click',function(evt){$('#map').html(oldhtml);evt.preventDefault();});$('#map').html(iframe);$('#map').append($("<div style='margin-bottom:10px' />").append(closelink));};S3.popupWin=null;S3.openPopup=function(url,center){if(!S3.popupWin||S3.popupWin.closed){var params='width=640, height=480';if(center===true){params+=',left='+(screen.width-640)/2+',top='+(screen.height-480)/2;}
S3.popupWin=window.open(url,'popupWin',params);}else{S3.popupWin.focus();}};(function(){var getSelector=function(setting){var selector;if(typeof setting=='string'){selector='[name="'+setting+'"]';}else{var prefix=setting.prefix?setting.prefix:'default';if(setting.alias){prefix+=setting.alias;}
var type=setting.inlineType||'sub',rows=setting.inlineRows;if(rows===undefined){rows=true;}
if(type=='sub'){var name=setting.name;if(rows){selector='[name^="'+prefix+'"][name*="_i_'+name+'_edit_"]';}else{selector='[name="'+prefix+'-'+name+'"]';}}else if(type=='link'){selector='[name="link_'+prefix+'"]';}}
return selector;};var addThrobber=function(widget,resourceName){var throbber=widget.siblings('.'+resourceName+'-throbber');if(!throbber.length){widget.after('<div class="'+resourceName+'-throbber throbber"/>');}};var removeThrobber=function(widget,resourceName){var throbber=widget.siblings('.'+resourceName+'-throbber');if(throbber.length){throbber.remove();}};var updateAddResourceLink=function(resourceName,key,value){$('a#'+resourceName+'_add').each(function(){var search=this.search,queries=[],selectable=false;if(search){var items=search.substring(1).split('&');items.forEach(function(item){if(decodeURIComponent(item.split('=')[0])!=key){queries.push(item);}});}
if(value!==undefined&&value!==null){var query=encodeURIComponent(key)+'='+encodeURIComponent(value);queries.push(query);selectable=true;}
if(queries.length){search='?'+queries.join('&');}else{search='';}
var href=this.protocol+'//'+this.host+this.pathname+search+this.hash,$this=$(this).attr('href',href);if(selectable){$this.parent().show();}else{$this.parent().hide();}});};var renderOptions=function(data,settings){var options=[],defaultValue=0;if(data.length===0){var showEmptyField=settings.showEmptyField;if(showEmptyField||showEmptyField===undefined){var msgNoRecords=settings.msgNoRecords||'-';options.push('<option value="">'+msgNoRecords+'</option>');}}else{var fncPrep=settings.fncPrep,prepResult=null;if(fncPrep){try{prepResult=fncPrep(data);}catch(e){}}
var lookupField=settings.lookupField||'id',fncRepresent=settings.fncRepresent,record,value,name,title;for(var i=0;i<data.length;i++){record=data[i];value=record[lookupField];if(i===0){defaultValue=value;}
name=fncRepresent?fncRepresent(record,prepResult):record.name;if(record._tooltip){title=' title="'+record._tooltip+'"';}else{title='';}
options.push('<option'+title+' value="'+value+'">'+name+'</option>');}
if(settings.optional){defaultValue=0;options.unshift('<option value=""></option>');}}
return{options:options.join(''),defaultValue:defaultValue};};var updateOptions=function(widget,data,empty){if(widget.hasClass('checkboxes-widget-s3')){s3_debug('filterOptionsS3 error: checkboxes-widget-s3 not supported, updateOptions aborted');return;}
var options=data.options,newValue=data.defaultValue,selectedValues=[];if(!empty){var currentValue='';if(widget.hasClass('checkboxes-widget-s3')){return;}else{currentValue=widget.val();if(!currentValue){currentValue=widget.prop('value');}
if(!$.isArray(currentValue)){currentValue=[currentValue];}
for(var i=0,len=currentValue.length,val;i<len;i++){val=currentValue[i];if(val&&$(options).filter('option[value='+val+']').length){selectedValues.push(val);}}}
if(selectedValues.length){newValue=selectedValues;}}
if(widget.prop('tagName')=='INPUT'){var select=$('<select/>').addClass(widget.attr('class')).attr('id',widget.attr('id')).attr('name',widget.attr('name')).data('visible',widget.data('visible')).hide();widget.replaceWith(select);widget=select;}
var disable=options==='';widget.html(options).val(newValue).change().prop('disabled',disable);if(widget.hasClass('groupedopts-widget')){widget.groupedopts('refresh');}else if(widget.hasClass('multiselect-widget')){widget.multiselect('refresh');if(!disable){widget.multiselect('enable');}else{widget.multiselect('disable');}}
return widget;};var replaceWidgetHTML=function(widget,data){if(data!==''){var is_groupedopts=false,is_multiselect=false;if(widget.hasClass('groupedopts-widget')){is_groupedopts=true;}else if(widget.hasClass('multiselect-widget')){is_multiselect=true;}
var widgetValue;if(is_groupedopts||is_multiselect){if(widget.prop('tagName').toLowerCase()=='select'){widgetValue=widget.val();}}
widget.html(data).change().prop('disabled',false);if(is_groupedopts||is_multiselect){if(widgetValue){var new_value=[];for(var i=0,len=widgetValue.length,val;i<len;i++){val=widgetValue[i];if(widget.find('option[value='+val+']').length){new_value.push(val);}}
widget.val(new_value).change();}
if(is_groupedopts){widget.groupedopts('refresh');}else{widget.multiselect('refresh');}}}else{widget.prop('disabled',true);}
return widget;};var updateTarget=function(target,lookupKey,value,settings,userChange){var multiple=false;if(target.length>1){if(target.first().attr('type')=='checkbox'){var checkboxesWidget=target.first().closest('.checkboxes-widget-s3');if(checkboxesWidget){s3_debug('filterOptionsS3 error: checkboxes-widget-s3 not supported, skipping');return;}}else{multiple=true;}}
if(multiple&&settings.getWidgetHTML){s3_debug('filterOptionsS3 warning: getWidgetHTML=true not suitable for multiple target widgets (e.g. inline rows)');target=target.first();multiple=false;}
var requestTarget=multiple?target.first():target;var previousRequest=requestTarget.data('update-request');if(previousRequest){try{previousRequest.abort();}catch(err){}}
var lookupResource=settings.lookupResource;if(value===''||value===null||value===undefined){target.val('').prop('disabled',true);if(target.multiselect('instance')){target.multiselect('refresh').multiselect('disable');}
target.change();updateAddResourceLink(lookupResource,lookupKey);return;}
var url;if(settings.lookupURL){url=settings.lookupURL;if(value){url=url.concat(value);}}else{var lookupPrefix=settings.lookupPrefix;url=S3.Ap.concat('/',lookupPrefix,'/',lookupResource,'.json');var q;if(value){q=lookupResource+'.'+lookupKey+'='+value;if(url.indexOf('?')!=-1){url=url.concat('&'+q);}else{url=url.concat('?'+q);}}}
var tooltip=settings.tooltip;if(tooltip){tooltip='tooltip='+tooltip;if(url.indexOf('?')!=-1){url=url.concat('&'+tooltip);}else{url=url.concat('?'+tooltip);}}
var represent=settings.represent;if(represent||typeof represent=='undefined'){if(url.indexOf('?')!=-1){url=url.concat('&represent=1');}else{url=url.concat('?represent=1');}}
var request=null;if(!settings.getWidgetHTML){target.each(function(){var widget=$(this),visible=true;if(widget.hasClass('groupedopts-widget')){visible=widget.groupedopts('visible');}else{visible=widget.data('visible')||widget.is(':visible');}
if(visible){widget.data('visible',true);if(widget.hasClass('groupedopts-widget')){widget.groupedopts('hide');}else{widget.hide();}
addThrobber(widget,lookupResource);}else{widget.data('visible',false);}});request=$.ajaxS3({url:url,dataType:'json',success:function(data){var options=renderOptions(data,settings),empty=data.length===0?true:false;target.each(function(){var widget=$(this);widget=updateOptions(widget,options,empty);if(widget.data('visible')){if(widget.hasClass('groupedopts-widget')){if(!empty){widget.groupedopts('show');}}else{widget.show();}}
removeThrobber(widget,lookupResource);});updateAddResourceLink(lookupResource,lookupKey,value);if(!userChange){S3ClearNavigateAwayConfirm();}}});}else{var targetName=settings.targetWidget||target.attr('name');var widget=$('[name = "'+targetName+'"]'),visible=true,show_widget=false;if(widget.hasClass('groupedopts-widget')){visible=widget.groupedopts('visible');}else{visible=widget.data('visible')||widget.is(':visible');}
if(visible){show_widget=true;widget.data('visible',true);if(widget.hasClass('groupedopts-widget')){widget.groupedopts('hide');}else{widget.hide();}
addThrobber(widget,lookupResource);}
request=$.ajaxS3({url:url,dataType:'html',success:function(data){widget=replaceWidgetHTML(widget,data,settings);if(show_widget){if(widget.hasClass('groupedopts-widget')){if(widget.find('option').length){widget.groupedopts('show');}}else{widget.show();}}
removeThrobber(widget,lookupResource);updateAddResourceLink(lookupResource,lookupKey,value);if(!userChange){S3ClearNavigateAwayConfirm();}}});}
requestTarget.data('update-request',request);};var getTriggerData=function(trigger){var triggerField=trigger,triggerValue='';if(triggerField.attr('type')=='checkbox'){var checkboxesWidget=triggerField.closest('.checkboxes-widget-s3');if(checkboxesWidget){triggerField=checkboxesWidget;}}
if(triggerField.hasClass('checkboxes-widget-s3')){triggerValue=[];triggerField.find('input:checked').each(function(){triggerValue.push($(this).val());});}else if(triggerField.hasClass('s3-hierarchy-input')){triggerValue='';var value=triggerField.val();if(value){value=JSON.parse(value);if(value.constructor===Array){if(value.length){triggerValue=value[0];}}else
if(!!value){triggerValue=value;}}}else if(triggerField.length==1){triggerValue=triggerField.val();}
return[triggerField,triggerValue];};$.filterOptionsS3=function(settings){var trigger=settings.trigger,triggerName;if(settings.event){triggerName=settings.event;}else if(typeof trigger=='string'){triggerName=trigger;}else{triggerName=trigger.name;}
var lookupKey=settings.lookupKey||triggerName,triggerSelector=getSelector(settings.trigger),targetSelector=getSelector(settings.target),triggerField,targetField,targetForm;if(!targetSelector){return;}else{targetField=$(targetSelector);if(!targetField.length){return;}
targetForm=targetField.closest('form');}
if(!triggerSelector){return;}else{triggerField=targetForm.find(triggerSelector);if(!triggerField.length){return;}}
$(triggerSelector).each(function(){var trigger=$(this),$scope;var inlineRow=trigger.closest('.inline-form');if(inlineRow.length&&(inlineRow.hasClass('empty-row')||inlineRow.css('display')=='none')){return;}
if(settings.scope=='row'){$scope=trigger.closest('.edit-row.inline-form,.add-row.inline-form');}else{$scope=targetForm;}
var triggerData=getTriggerData(trigger),target=$scope.find(targetSelector);updateTarget(target,lookupKey,triggerData[1],settings,false);});var changeEventName='change.s3options',triggerEventName='triggerUpdate.'+triggerName;targetForm.undelegate(triggerSelector,changeEventName).delegate(triggerSelector,changeEventName,function(){var triggerData=getTriggerData($(this));targetForm.trigger(triggerEventName,triggerData);});targetForm.on(triggerEventName,function(e,triggerField,triggerValue){var $scope;if(settings.scope=='row'){$scope=triggerField.closest('.edit-row.inline-form,.add-row.inline-form');}else{$scope=targetForm;}
var target=$scope.find(targetSelector);updateTarget(target,lookupKey,triggerValue,settings,true);});};})(jQuery);(function(){var stripQuery=function(url){var newurl=url.split('?')[0].split('#')[0];return newurl;};$.cancelButtonS3=function(defaultURL){var cancelButtons=$('.s3-cancel');if(!cancelButtons.length){return;}
var referrer=document.referrer;if(referrer&&stripQuery(referrer)!=stripQuery(document.URL)){var anchor=document.createElement('a');anchor.href=referrer;if(anchor.host==window.location.host&&anchor.pathname.lastIndexOf(S3.Ap,0)===0){cancelButtons.attr('href',referrer);}else if(defaultURL){cancelButtons.attr('href',defaultURL);}else{cancelButtons.hide();}}else if(defaultURL){cancelButtons.attr('href',defaultURL);}else{cancelButtons.hide();}};})(jQuery);S3.slider=function(fieldname,min,max,step,value){var real_input=$('#'+fieldname);var selector='#'+fieldname+'_slider';$(selector).slider({min:min,max:max,step:step,value:value,slide:function(event,ui){real_input.val(ui.value);},change:function(){if(value==null){value=(min+max)/2;var modulo=value%step;if(modulo!=0){if(modulo<(step/2)){value=value-modulo;}else{value=value+modulo;}}
$(selector).slider('option','value',value);$(selector+' .ui-slider-handle').show();real_input.show().next().remove();}}});if(value==null){$(selector+' .ui-slider-handle').hide();real_input.hide().after('<p>'+i18n.slider_help+'</p>');}
real_input.closest('form').submit(function(){real_input.prop('disabled',false);return true;});};S3.range_slider=function(fieldname,min,max,step,values){var real_input1=$('#'+fieldname+'_1');var real_input2=$('#'+fieldname+'_2');var selector='#'+fieldname+'_slider';$(selector).slider({range:true,min:min,max:max,step:step,values:values,slide:function(event,ui){real_input1.val(ui.values[0]);real_input2.val(ui.values[1]);},change:function(event,ui){var value=ui.value,index=ui.handleIndex,real_input=$('#'+fieldname+'_'+(index+1));if(value==null){value=(min+max)/2;var modulo=value%step;if(modulo!=0){if(modulo<(step/2)){value=value-modulo;}else{value=value+modulo;}}
$(selector).slider('option','values',index,value);$(selector+' .ui-slider-handle').show();real_input.show().next().remove();}}});if(values==[]){$(selector+' .ui-slider-handle').hide();real_input1.hide();real_input2.hide().after('<p>'+i18n.slider_help+'</p>');}
real_input1.closest('form').submit(function(){real_input1.prop('disabled',false);real_input2.prop('disabled',false);return true;});};S3.reloadWithQueryStringVars=function(queryStringVars){var existingQueryVars=location.search?location.search.substring(1).split('&'):[],currentUrl=location.search?location.href.replace(location.search,''):location.href,newQueryVars={},newUrl=currentUrl+'?';if(existingQueryVars.length>0){for(var i=0;i<existingQueryVars.length;i++){var pair=existingQueryVars[i].split('=');newQueryVars[pair[0]]=pair[1];}}
if(queryStringVars){for(var queryStringVar in queryStringVars){newQueryVars[queryStringVar]=queryStringVars[queryStringVar];}}
if(newQueryVars){for(var newQueryVar in newQueryVars){newUrl+=newQueryVar+'='+newQueryVars[newQueryVar]+'&';}
newUrl=newUrl.substring(0,newUrl.length-1);window.location.href=newUrl;}else{window.location.href=location.href;}};(function(){var deduplication=function(){$('.mark-deduplicate').click(function(){var url=$('#markDuplicateURL').attr('href');if(url){$.ajaxS3({type:'POST',url:url,data:{},dataType:'JSON',success:function(){$('.mark-deduplicate, .unmark-deduplicate, .deduplicate').toggleClass('hide');}});}});$('.unmark-deduplicate').click(function(){var url=$('#markDuplicateURL').attr('href');if(url){$.ajaxS3({type:'POST',url:url+'?remove=1',data:{},dataType:'JSON',success:function(){$('.mark-deduplicate, .unmark-deduplicate, .deduplicate').toggleClass('hide');}});}});$('.swap-button').click(function(){var id=this.id;var name=id.slice(5);var original=$('#original_'+name);var original_id=original.attr('id');var original_name=original.attr('name');var original_parent=original.parent().closest('td.mwidget');var duplicate=$('#duplicate_'+name);var duplicate_id=duplicate.attr('id');var duplicate_name=duplicate.attr('name');var duplicate_parent=duplicate.parent().closest('td.mwidget');original.attr('id','swap_original_id');original.attr('name','swap_original_name');$('#dummy'+original_id).attr('id','dummy_swap_original_id');duplicate.attr('id','swap_duplicate_id');duplicate.attr('name','swap_duplicate_name');$('#dummy'+duplicate_id).attr('id','dummy_swap_duplicate_id');original_parent.before('<td id="swap_original_placeholder"></td>');var o=original_parent.detach();duplicate_parent.before('<td id="swap_duplicate_placeholder"></td>');var d=duplicate_parent.detach();$('#swap_original_placeholder').after(d);$('#swap_original_placeholder').remove();$('#swap_duplicate_placeholder').after(o);$('#swap_duplicate_placeholder').remove();original.attr('id',duplicate_id);original.attr('name',duplicate_name);$('#dummy_swap_original_id').attr('id','dummy'+duplicate_id);duplicate.attr('id',original_id);duplicate.attr('name',original_name);$('#dummy_swap_duplicate').attr('id','dummy'+original_id);});};var onResize=function(){var side_menu_holder=$('.aside');if(side_menu_holder.length){var header=$('#menu_modules');if(!header.length){header=$('#navbar-inner');if(!header.length){header=$('#header');}}
var side_menu=$('#menu_options');if((header.height()+side_menu.height()+10)<$(window).height()){side_menu_holder.css('position','fixed');$('#content').css('min-height',side_menu.height());}else{side_menu_holder.css('position','static');}}};$(document).ready(function(){$('.alert-error').hide().slideDown('slow');$('.alert-error').click(function(){$(this).fadeOut('slow');return false;});$('.alert-warning').hide().slideDown('slow');$('.alert-warning').click(function(){$(this).fadeOut('slow');return false;});$('.alert-info').hide().slideDown('slow');$('.alert-info').click(function(){$(this).fadeOut('slow');return false;});$('.alert-success').hide().slideDown('slow');$('.alert-success').click(function(){$(this).fadeOut('slow');return false;});$("input[type='checkbox'].delete").click(function(){if((this.checked)&&(!confirm(i18n.delete_confirmation))){this.checked=false;}});var inputErrorId=$('form .error[id]').eq(0).attr('id');if(inputErrorId!=undefined){var inputName=inputErrorId.replace('__error',''),inputId=$('[name='+inputName+']').attr('id'),inputLabel=$('[for='+inputId+']');try{window.scrollTo(0,inputLabel.offset().top);S3.FocusOnFirstField=false;}catch(e){}}
if(S3.interactive){$(document).on('click','a.delete-btn',function(event){if(confirm(i18n.delete_confirmation)){return true;}else{event.preventDefault();return false;}});if(S3.FocusOnFirstField!=false){$('input:text:visible:first').focus();}}
$('input.int_amount').keyup(function(){this.value=this.value.reverse().replace(/[^0-9\-,]|\-(?=.)/g,'').reverse();});$('input.float_amount').keyup(function(){this.value=this.value.reverse().replace(/[^0-9\-\.,]|[\-](?=.)|[\.](?=[0-9]*[\.])/g,'').reverse();});$('input[name="first_name"]').focusout(function(){this.value=this.value.charAt(0).toLocaleUpperCase()+this.value.substring(1);});if(S3.rtl){$('.phone-widget').each(function(){var value=this.value;if(value&&(value.charAt(0)!='\u200E')){this.value='\u200E'+value;}});$('.phone-widget').focusout(function(){var value=this.value;if(value){if(value.charAt(0)!='\u200E'){if(value.charAt(value.length-1)=='+'){this.value='\u200E'+'+'+value.substr(0,value.length-2);}else{this.value='\u200E'+value;}}else{if(value.charAt(value.length-1)=='+'){this.value='\u200E'+'+'+value.substr(1,value.length-2);}}}});}
$('#show-add-btn').click(function(){$('#show-add-btn').hide(10,function(){$('#list-add').slideDown('medium');$('.select-widget').selectmenu('refresh');});});$('textarea.resizable:not(.textarea-processed)').each(function(){var that=$(this);if(that.is(('textarea.teaser:not(.teaser-processed)'))){return false;}
var textarea=that.addClass('textarea-processed');var staticOffset=null;that.wrap('<div class="resizable-textarea"><span></span></div>').parent().append($('<div class="grippie"></div>').mousedown(startDrag));var grippie=$('div.grippie',that.parent())[0];grippie.style.marginRight=(grippie.offsetWidth-that[0].offsetWidth)+'px';function startDrag(e){staticOffset=textarea.height()-e.pageY;textarea.css('opacity',0.25);$(document).mousemove(performDrag).mouseup(endDrag);return false;}
function performDrag(e){textarea.height(Math.max(32,staticOffset+e.pageY)+'px');return false;}
function endDrag(){$(document).unbind('mousemove',performDrag).unbind('mouseup',endDrag);textarea.css('opacity',1);}
return true;});$('#modulenav .hoverable').hover(function(){$(this).addClass('hovered');},function(){$(this).removeClass('hovered');});$('#modulenav li').hover(function(){var header_width=$(this).width();var popup_width=$('ul',this).width();if(popup_width!==null){if(popup_width<header_width){$('ul',this).css({'width':header_width.toString()+'px'});}}
$('ul',this).css('display','block');},function(){$('ul',this).css('display','none');});S3.redraw();if(typeof($.fn.popover)!='undefined'){$('body').popover({selector:'.s3-popover',trigger:'hover',placement:'left'});}
onResize();$(window).bind('resize',onResize);deduplication();var anyform=$('form');if(anyform.length){var now=new Date(),tz;anyform.append("<input type='hidden' value='"+now.getTimezoneOffset()+"' name='_utc_offset'/>");try{tz=Intl.DateTimeFormat().resolvedOptions().timeZone;}catch(e){}
if(tz){anyform.append("<input type='hidden' value='"+tz+"' name='_timezone'/>");}}
if($('#socialmedia_share').length>0){var currenturl=document.location.href;$('#socialmedia_share').append("<div class='socialmedia_element'><script src='//platform.linkedin.com/in.js'></script><script type='IN/Share' data-counter='right'></script></div>");$('#socialmedia_share').append("<div class='socialmedia_element'><a href='https://twitter.com/share' class='twitter-share-button' data-count='none' data-hashtags='sahana-eden'>Tweet</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='//platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','twitter-wjs');</script></div>");$('#socialmedia_share').append("<div class='socialmedia_element'><div id='fb-root'></div><script>(function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = '//connect.facebook.net/en_US/all.js#xfbml=1'; fjs.parentNode.insertBefore(js, fjs); }(document, 'script', 'facebook-jssdk'));</script> <div class='fb-like' data-send='false' data-layout='button_count' data-show-faces='true' data-href='"+currenturl+"'></div></div>");}
$('.form-toggle').click(function(){var self=$(this),hidden=$(this).data('hidden');hidden=hidden&&hidden!='False';self.data('hidden',hidden?false:true).siblings().slideToggle('medium',function(){self.children('span').each(function(){$(this).text(hidden?$(this).data('off'):$(this).data('on')).siblings().toggle();});});});$('#menu-options-toggle,#list-filter-toggle').on('click',function(e){e.stopPropagation();var $this=$(this);var status=$this.data('status'),menu;if(this.id=='menu-options-toggle'){menu=$('#menu-options');}else{menu=$('#list-filter');}
if(status=='off'){menu.hide().removeClass('hide-for-small').slideDown(400,function(){$this.data('status','on').text($this.data('on'));});}else{menu.slideUp(400,function(){menu.addClass('hide-for-small').show();$this.data('status','off').text($this.data('off'));});}});$('.s3-download-button').on('click',function(e){e.preventDefault();e.stopPropagation();var url=$(this).data('url');if(!url){return;}
var iframe=document.getElementById("s3-download");if(iframe==null){iframe=document.createElement('iframe');iframe.id="s3-download";iframe.style.visibility='hidden';document.body.appendChild(iframe);}
$('#s3-download').off('load').on('load',function(){var message,self=$(this);try{message=JSON.parse(this.contentDocument.body.textContent).message;}catch(e){self.dialog({title:'Download failed',width:500,height:300,close:function(){self.attr('src','').remove();}}).css({visibility:'visible',width:'100%'});return;}
alert(message);});iframe.src=url;return false;});});}());$.fn.collapsible=function(options){var defaults={defaulthide:true,symbolhide:'-',symbolshow:'+',imagehide:null,imageshow:null,xoffset:'-15',yoffset:'0'};var opts=$.extend(defaults,options);var o=$.meta?$.extend({},opts,$$.data()):opts;var obj=$(this);if(o.imageshow)o.symbolshow='<img src="'+o.imageshow+'" class="jc-show" border="0">';if(o.imagehide)o.symbolhide='<img src="'+o.imagehide+'" class="jc-hide" border="0">';var startsymbol=o.symbolshow;$('li',obj).each(function(index){if($('>ul, >ol',this).size()>0){if(o.defaulthide)$('>ul, >ol',this).hide();else startsymbol=o.symbolhide;$(this).prepend('<a href="" class="jcollapsible" style="position:absolute;outline:0;left:'+o.xoffset+'px;top:'+o.yoffset+'px;">'+startsymbol+'</a>').css('position','relative');}});$('.jcollapsible',obj).click(function(){var parent=$(this).parent();$('>ul, >ol',parent).slideToggle('fast');$(this).html($(this).html()==o.symbolshow?o.symbolhide:o.symbolshow);return false;});};(function($){$.cluetip={version:'1.2.5',template:['<div>','<div class="cluetip-outer">','<h3 class="cluetip-title ui-widget-header ui-cluetip-header"></h3>','<div class="cluetip-inner ui-widget-content ui-cluetip-content"></div>','</div>','<div class="cluetip-extra"></div>','<div class="cluetip-arrows ui-state-default"></div>','</div>'].join(''),setup:{insertionType:'appendTo',insertionElement:'body'},defaults:{multiple:false,width:275,height:'auto',cluezIndex:97,positionBy:'auto',topOffset:15,leftOffset:15,local:false,localPrefix:null,localIdSuffix:null,hideLocal:true,attribute:'rel',titleAttribute:'title',splitTitle:'',escapeTitle:false,showTitle:true,cluetipClass:'default',hoverClass:'',waitImage:true,cursor:'help',arrows:false,dropShadow:true,dropShadowSteps:6,sticky:false,mouseOutClose:false,activation:'hover',clickThrough:true,tracking:false,delayedClose:0,closePosition:'top',closeText:'Close',truncate:0,fx:{open:'show',openSpeed:''},hoverIntent:{sensitivity:3,interval:50,timeout:0},onActivate:function(e){return true;},onShow:function(ct,ci){},onHide:function(ct,ci){},ajaxCache:true,ajaxProcess:function(data){data=data.replace(/<(script|style|title)[^<]+<\/(script|style|title)>/gm,'').replace(/<(link|meta)[^>]+>/g,'');return data;},ajaxSettings:{dataType:'html'},debug:false}};var $cluetipWait,standardClasses='cluetip ui-widget ui-widget-content ui-cluetip',caches={},counter=0,imgCount=0;$.fn.attrProp=$.fn.prop||$.fn.attr;$.fn.cluetip=function(js,options){var $cluetip,$cluetipInner,$cluetipOuter,$cluetipTitle,$cluetipArrows,$dropShadow;if(typeof js=='object'){options=js;js=null;}
if(js=='destroy'){var data=this.data('cluetip');if(data){$(data.selector).remove();$.removeData(this,'title');$.removeData(this,'cluetip');}
$(document).unbind('.cluetip');return this.unbind('.cluetip');}
options=$.extend(true,{},$.cluetip.defaults,options||{});counter++;var cluezIndex,cluetipId=$.cluetip.backCompat||!options.multiple?'cluetip':'cluetip-'+counter,cluetipSelector='#'+cluetipId,prefix=$.cluetip.backCompat?'#':'.',insertionType=$.cluetip.setup.insertionType,insertionElement=$.cluetip.setup.insertionElement||'body';insertionType=(/appendTo|prependTo|insertBefore|insertAfter/).test(insertionType)?insertionType:'appendTo';$cluetip=$(cluetipSelector);if(!$cluetip.length){$cluetip=$($.cluetip.template)
[insertionType](insertionElement).attr('id',cluetipId).css({position:'absolute',display:'none'});cluezIndex=+options.cluezIndex;$cluetipOuter=$cluetip.find(prefix+'cluetip-outer').css({position:'relative',zIndex:cluezIndex});$cluetipInner=$cluetip.find(prefix+'cluetip-inner');$cluetipTitle=$cluetip.find(prefix+'cluetip-title');}
$cluetipWait=$('#cluetip-waitimage');if(!$cluetipWait.length){$cluetipWait=$('<div></div>').attr('id','cluetip-waitimage').css({position:'absolute'});}
$cluetipWait.insertBefore($cluetip).hide();var cluetipPadding=(parseInt($cluetip.css('paddingLeft'),10)||0)+(parseInt($cluetip.css('paddingRight'),10)||0);this.each(function(index){var link=this,$link=$(this),opts=$.extend(true,{},options,$.metadata?$link.metadata():$.meta?$link.data():$link.data('cluetip')||{}),cluetipContents=false,isActive=false,closeOnDelay=0,tipAttribute=opts[opts.attribute]||(opts.attribute=='href'?$link.attr(opts.attribute):$link.attrProp(opts.attribute)||$link.attr(opts.attribute)),ctClass=opts.cluetipClass;cluezIndex=+opts.cluezIndex;$link.data('cluetip',{title:link.title,zIndex:cluezIndex,selector:cluetipSelector});if(!tipAttribute&&!opts.splitTitle&&!js){return true;}
if(opts.local&&opts.localPrefix){tipAttribute=opts.localPrefix+tipAttribute;}
if(opts.local&&opts.hideLocal&&tipAttribute){$(tipAttribute+':first').hide();}
var tOffset=parseInt(opts.topOffset,10),lOffset=parseInt(opts.leftOffset,10);var tipHeight,wHeight,defHeight=isNaN(parseInt(opts.height,10))?'auto':(/\D/g).test(opts.height)?opts.height:opts.height+'px';var sTop,linkTop,posY,tipY,mouseY,baseline;var tipInnerWidth=parseInt(opts.width,10)||275,tipWidth=tipInnerWidth+cluetipPadding+opts.dropShadowSteps,linkWidth=this.offsetWidth,linkLeft,posX,tipX,mouseX,winWidth;var tipParts;var tipTitle=(opts.attribute!='title')?$link.attrProp(opts.titleAttribute)||'':'';if(opts.splitTitle){tipParts=tipTitle.split(opts.splitTitle);tipTitle=opts.showTitle||tipParts[0]===''?tipParts.shift():'';}
if(opts.escapeTitle){tipTitle=tipTitle.replace(/&/g,'&amp;').replace(/>/g,'&gt;').replace(/</g,'&lt;');}
var localContent;function returnFalse(){return false;}
var activate=function(event){var pY,ajaxMergedSettings,cacheKey,continueOn=opts.onActivate.call(link,event);if(continueOn===false){return false;}
isActive=true;$cluetip=$(cluetipSelector).css({position:'absolute'});$cluetipOuter=$cluetip.find(prefix+'cluetip-outer');$cluetipInner=$cluetip.find(prefix+'cluetip-inner');$cluetipTitle=$cluetip.find(prefix+'cluetip-title');$cluetipArrows=$cluetip.find(prefix+'cluetip-arrows');$cluetip.removeClass().css({width:tipInnerWidth});if(tipAttribute==$link.attr('href')){$link.css('cursor',opts.cursor);}
if(opts.hoverClass){$link.addClass(opts.hoverClass);}
linkTop=posY=$link.offset().top;linkLeft=$link.offset().left;linkWidth=$link.innerWidth();if(event.type==focus){mouseX=linkLeft+(linkWidth/2)+lOffset;$cluetip.css({left:posX});mouseY=posY+tOffset;}else{mouseX=event.pageX;mouseY=event.pageY;}
if(link.tagName.toLowerCase()!='area'){sTop=$(document).scrollTop();winWidth=$(window).width();}
if(opts.positionBy=='fixed'){posX=linkWidth+linkLeft+lOffset;$cluetip.css({left:posX});}else{posX=(linkWidth>linkLeft&&linkLeft>tipWidth)||linkLeft+linkWidth+tipWidth+lOffset>winWidth?linkLeft-tipWidth-lOffset:linkWidth+linkLeft+lOffset;if(link.tagName.toLowerCase()=='area'||opts.positionBy=='mouse'||linkWidth+tipWidth>winWidth){if(mouseX+20+tipWidth>winWidth){$cluetip.addClass('cluetip-'+ctClass);posX=(mouseX-tipWidth-lOffset)>=0?mouseX-tipWidth-lOffset-parseInt($cluetip.css('marginLeft'),10)+parseInt($cluetipInner.css('marginRight'),10):mouseX-(tipWidth/2);}else{posX=mouseX+lOffset;}}
pY=posX<0?event.pageY+tOffset:event.pageY;if(posX<0||opts.positionBy=='bottomTop'){posX=(mouseX+(tipWidth/2)>winWidth)?winWidth/2-tipWidth/2:Math.max(mouseX-(tipWidth/2),0);}}
$cluetipArrows.css({zIndex:$link.data('cluetip').zIndex+1});$cluetip.css({left:posX,zIndex:$link.data('cluetip').zIndex});wHeight=$(window).height();if(js){if(typeof js=='function'){js=js.call(link);}
$cluetipInner.html(js);cluetipShow(pY);}
else if(tipParts){var tpl=tipParts.length;$cluetipInner.html(tpl?tipParts[0]:'');if(tpl>1){for(var i=1;i<tpl;i++){$cluetipInner.append('<div class="split-body">'+tipParts[i]+'</div>');}}
cluetipShow(pY);}
else if(!opts.local&&tipAttribute.indexOf('#')!==0){if(/\.(jpe?g|tiff?|gif|png)(?:\?.*)?$/i.test(tipAttribute)){$cluetipInner.html('<img src="'+tipAttribute+'" alt="'+tipTitle+'" />');cluetipShow(pY);}else{var optionBeforeSend=opts.ajaxSettings.beforeSend,optionError=opts.ajaxSettings.error,optionSuccess=opts.ajaxSettings.success,optionComplete=opts.ajaxSettings.complete;cacheKey=getCacheKey(tipAttribute,opts.ajaxSettings.data);var ajaxSettings={cache:opts.ajaxCache,url:tipAttribute,beforeSend:function(xhr,settings){if(optionBeforeSend){optionBeforeSend.call(link,xhr,$cluetip,$cluetipInner,settings);}
$cluetipOuter.children().empty();if(opts.waitImage){$cluetipWait.css({top:mouseY+20,left:mouseX+20,zIndex:$link.data('cluetip').zIndex-1}).show();}},error:function(xhr,textStatus){if(options.ajaxCache&&!caches[cacheKey]){caches[cacheKey]={status:'error',textStatus:textStatus,xhr:xhr};}
if(isActive){if(optionError){optionError.call(link,xhr,textStatus,$cluetip,$cluetipInner);}else{$cluetipInner.html('<i>sorry, the contents could not be loaded</i>');}}},success:function(data,textStatus,xhr){if(options.ajaxCache&&!caches[cacheKey]){caches[cacheKey]={status:'success',data:data,textStatus:textStatus,xhr:xhr};}
cluetipContents=opts.ajaxProcess.call(link,data);if(typeof cluetipContents=='object'&&cluetipContents!==null){tipTitle=cluetipContents.title;cluetipContents=cluetipContents.content;}
if(isActive){if(optionSuccess){optionSuccess.call(link,data,textStatus,$cluetip,$cluetipInner);}
$cluetipInner.html(cluetipContents);}},complete:function(xhr,textStatus){if(optionComplete){optionComplete.call(link,xhr,textStatus,$cluetip,$cluetipInner);}
var imgs=$cluetipInner[0].getElementsByTagName('img');imgCount=imgs.length;for(var i=0,l=imgs.length;i<l;i++){if(imgs[i].complete){imgCount--;}}
if(imgCount&&!$.browser.opera){$(imgs).bind('load.ct error.ct',function(){imgCount--;if(imgCount===0){$cluetipWait.hide();$(imgs).unbind('.ct');if(isActive){cluetipShow(pY);}}});}else{$cluetipWait.hide();if(isActive){cluetipShow(pY);}}}};ajaxMergedSettings=$.extend(true,{},opts.ajaxSettings,ajaxSettings);if(caches[cacheKey]){cachedAjax(caches[cacheKey],ajaxMergedSettings);}else{$.ajax(ajaxMergedSettings);}}}else if(opts.local){var $localContent=$(tipAttribute+(/^#\S+$/.test(tipAttribute)?'':':eq('+index+')')).clone(true).show();if(opts.localIdSuffix){$localContent.attr('id',$localContent[0].id+opts.localIdSuffix);}
$cluetipInner.html($localContent);cluetipShow(pY);}};var cluetipShow=function(bpY){var $closeLink,dynamicClasses,heightDiff,titleHTML=tipTitle||opts.showTitle&&'&nbsp;',bgY='',direction='';$cluetip.addClass('cluetip-'+ctClass);if(opts.truncate){var $truncloaded=$cluetipInner.text().slice(0,opts.truncate)+'...';$cluetipInner.html($truncloaded);}
if(titleHTML){$cluetipTitle.show().html(titleHTML);}else{$cluetipTitle.hide();}
if(opts.sticky){$closeLink=$('<div class="cluetip-close"><a href="#">'+opts.closeText+'</a></div>');(opts.closePosition=='bottom')?$closeLink.appendTo($cluetipInner):(opts.closePosition=='title')?$closeLink.prependTo($cluetipTitle):$closeLink.prependTo($cluetipInner);$closeLink.bind('click.cluetip',function(){cluetipClose();return false;});if(opts.mouseOutClose){$cluetip.bind('mouseleave.cluetip',function(){cluetipClose();});}else{$cluetip.unbind('mouseleave.cluetip');}}
$cluetipOuter.css({zIndex:$link.data('cluetip').zIndex,overflow:defHeight=='auto'?'visible':'auto',height:defHeight});tipHeight=defHeight=='auto'?Math.max($cluetip.outerHeight(),$cluetip.height()):parseInt(defHeight,10);tipY=posY;baseline=sTop+wHeight;if(opts.positionBy=='fixed'){tipY=posY-opts.dropShadowSteps+tOffset;}else if((posX<mouseX&&Math.max(posX,0)+tipWidth>mouseX)||opts.positionBy=='bottomTop'){if(posY+tipHeight+tOffset>baseline&&mouseY-sTop>tipHeight+tOffset){tipY=mouseY-tipHeight-tOffset;direction='top';}else{tipY=mouseY+tOffset;direction='bottom';}}else if(posY+tipHeight+tOffset>baseline){tipY=(tipHeight>=wHeight)?sTop:baseline-tipHeight-tOffset;}else if($link.css('display')=='block'||link.tagName.toLowerCase()=='area'||opts.positionBy=="mouse"){tipY=bpY-tOffset;}else{tipY=posY-opts.dropShadowSteps;}
if(direction===''){direction=posX<linkLeft?'left':'right';}
dynamicClasses=' clue-'+direction+'-'+ctClass+' cluetip-'+ctClass;if(ctClass=='rounded'){dynamicClasses+=' ui-corner-all';}
$cluetip.css({top:tipY+'px'}).attrProp({'className':standardClasses+dynamicClasses});if(opts.arrows){if(/(left|right)/.test(direction)){heightDiff=$cluetip.height()-$cluetipArrows.height();bgY=posX>=0&&bpY>0?(posY-tipY-opts.dropShadowSteps):0;bgY=heightDiff>bgY?bgY:heightDiff;bgY+='px';}
$cluetipArrows.css({top:bgY}).show();}else{$cluetipArrows.hide();}
$dropShadow=createDropShadows($cluetip,opts);if($dropShadow&&$dropShadow.length){$dropShadow.hide().css({height:tipHeight,width:tipInnerWidth,zIndex:$link.data('cluetip').zIndex-1}).show();}
$cluetip.hide()[opts.fx.open](opts.fx.openSpeed||0);if($.fn.bgiframe){$cluetip.bgiframe();}
if(opts.delayedClose>0){closeOnDelay=setTimeout(cluetipClose,opts.delayedClose);}
opts.onShow.call(link,$cluetip,$cluetipInner);};var inactivate=function(event){isActive=false;$cluetipWait.hide();if(!opts.sticky||(/click|toggle/).test(opts.activation)){cluetipClose();clearTimeout(closeOnDelay);}
if(opts.hoverClass){$link.removeClass(opts.hoverClass);}};var cluetipClose=function(el){var $closer=el&&el.data('cluetip')?el:$link,ct=$closer.data('cluetip')&&$closer.data('cluetip').selector,ctSelector=ct||'div.cluetip',$cluetip=$(ctSelector),$cluetipInner=$cluetip.find(prefix+'cluetip-inner'),$cluetipArrows=$cluetip.find(prefix+'cluetip-arrows');$cluetip.hide().removeClass();opts.onHide.call($closer[0],$cluetip,$cluetipInner);if(ct){$closer.removeClass('cluetip-clicked');$closer.css('cursor','');}
if(ct&&tipTitle){$closer.attrProp(opts.titleAttribute,tipTitle);}
if(opts.arrows){$cluetipArrows.css({top:''});}};$(document).unbind('hideCluetip.cluetip').bind('hideCluetip.cluetip',function(e){cluetipClose($(e.target));});if((/click|toggle/).test(opts.activation)){$link.bind('click.cluetip',function(event){if($cluetip.is(':hidden')||!$link.is('.cluetip-clicked')){activate(event);$('.cluetip-clicked').removeClass('cluetip-clicked');$link.addClass('cluetip-clicked');}else{inactivate(event);}
return false;});}else if(opts.activation=='focus'){$link.bind('focus.cluetip',function(event){$link.attrProp('title','');activate(event);});$link.bind('blur.cluetip',function(event){$link.attrProp('title',$link.data('cluetip').title);inactivate(event);});}else{$link[opts.clickThrough?'unbind':'bind']('click.cluetip',returnFalse);var mouseTracks=function(evt){if(opts.tracking){var trackX=posX-evt.pageX;var trackY=tipY?tipY-evt.pageY:posY-evt.pageY;$link.bind('mousemove.cluetip',function(evt){$cluetip.css({left:evt.pageX+trackX,top:evt.pageY+trackY});});}};if($.fn.hoverIntent&&opts.hoverIntent){$link.hoverIntent({sensitivity:opts.hoverIntent.sensitivity,interval:opts.hoverIntent.interval,over:function(event){activate(event);mouseTracks(event);},timeout:opts.hoverIntent.timeout,out:function(event){inactivate(event);$link.unbind('mousemove.cluetip');}});}else{$link.bind('mouseenter.cluetip',function(event){activate(event);mouseTracks(event);}).bind('mouseleave.cluetip',function(event){inactivate(event);$link.unbind('mousemove.cluetip');});}
$link.bind('mouseover.cluetip',function(event){$link.attrProp('title','');}).bind('mouseleave.cluetip',function(event){$link.attrProp('title',$link.data('cluetip').title);});}
function cachedAjax(info,settings){var status=info.status;settings.beforeSend(info.xhr,settings);if(status=='error'){settings[status](info.xhr,info.textStatus);}else if(status=='success'){settings[status](info.data,info.textStatus,info.xhr);}
settings.complete(info.xhr,settings.textStatus);}});function doNothing(){}
function getCacheKey(url,data){var cacheKey=url||'';data=data||'';if(typeof data=='object'){$.each(data,function(key,val){cacheKey+='-'+key+'-'+val;});}else if(typeof data=='string'){cacheKey+=data;}
return cacheKey;}
function createDropShadows($cluetip,options,newDropShadow){var dsStyle='',dropShadowSteps=(options.dropShadow&&options.dropShadowSteps)?+options.dropShadowSteps:0;if($.support.boxShadow){if(dropShadowSteps){dsStyle='1px 1px '+dropShadowSteps+'px rgba(0,0,0,0.5)';}
var dsOffsets=dropShadowSteps===0?'0 0 ':'1px 1px ';$cluetip.css($.support.boxShadow,dsStyle);return false;}
var oldDropShadow=$cluetip.find('.cluetip-drop-shadow');if(dropShadowSteps==oldDropShadow.length){return oldDropShadow;}
oldDropShadow.remove();var dropShadows=[];for(var i=0;i<dropShadowSteps;){dropShadows[i++]='<div style="top:'+i+'px;left:'+i+'px;"></div>';}
newDropShadow=$(dropShadows.join('')).css({position:'absolute',backgroundColor:'#000',zIndex:cluezIndex-1,opacity:0.1}).addClass('cluetip-drop-shadow').prependTo($cluetip);return newDropShadow;}
return this;};(function(){$.support=$.support||{};var div=document.createElement('div'),divStyle=div.style,styleProps=['boxShadow'],prefixes=['moz','Moz','webkit','o'];for(var i=0,sl=styleProps.length;i<sl;i++){var prop=styleProps[i],uProp=prop.charAt(0).toUpperCase()+prop.slice(1);if(typeof divStyle[prop]!=='undefined'){$.support[prop]=prop;}else{for(var j=0,pl=prefixes.length;j<pl;j++){if(typeof divStyle[prefixes[j]+uProp]!=='undefined'){$.support[prop]=prefixes[j]+uProp;break;}}}}
div=null;})();$.fn.cluetip.defaults=$.cluetip.defaults;})(jQuery);(function($){$.fn.editable=function(target,options){if('disable'==target){$(this).data('disabled.editable',true);return;}
if('enable'==target){$(this).data('disabled.editable',false);return;}
if('destroy'==target){$(this).unbind($(this).data('event.editable')).removeData('disabled.editable').removeData('event.editable');return;}
var settings=$.extend({},$.fn.editable.defaults,{target:target},options);var plugin=$.editable.types[settings.type].plugin||function(){};var submit=$.editable.types[settings.type].submit||function(){};var buttons=$.editable.types[settings.type].buttons||$.editable.types['defaults'].buttons;var content=$.editable.types[settings.type].content||$.editable.types['defaults'].content;var element=$.editable.types[settings.type].element||$.editable.types['defaults'].element;var reset=$.editable.types[settings.type].reset||$.editable.types['defaults'].reset;var callback=settings.callback||function(){};var onedit=settings.onedit||function(){};var onsubmit=settings.onsubmit||function(){};var onreset=settings.onreset||function(){};var onerror=settings.onerror||reset;if(settings.tooltip){$(this).attr('title',settings.tooltip);}
settings.autowidth='auto'==settings.width;settings.autoheight='auto'==settings.height;return this.each(function(){var self=this;var savedwidth=$(self).width();var savedheight=$(self).height();$(this).data('event.editable',settings.event);if(!$.trim($(this).html())){$(this).html(settings.placeholder);}
$(this).bind(settings.event,function(e){if(true===$(this).data('disabled.editable')){return;}
if(self.editing){return;}
if(false===onedit.apply(this,[settings,self])){return;}
e.preventDefault();e.stopPropagation();if(settings.tooltip){$(self).removeAttr('title');}
if(0==$(self).width()){settings.width=savedwidth;settings.height=savedheight;}else{if(settings.width!='none'){settings.width=settings.autowidth?$(self).width():settings.width;}
if(settings.height!='none'){settings.height=settings.autoheight?$(self).height():settings.height;}}
if($(this).html().toLowerCase().replace(/(;|")/g,'')==settings.placeholder.toLowerCase().replace(/(;|")/g,'')){$(this).html('');}
self.editing=true;self.revert=$(self).html();$(self).html('');var form=$('<form />');if(settings.cssclass){if('inherit'==settings.cssclass){form.attr('class',$(self).attr('class'));}else{form.attr('class',settings.cssclass);}}
if(settings.style){if('inherit'==settings.style){form.attr('style',$(self).attr('style'));form.css('display',$(self).css('display'));}else{form.attr('style',settings.style);}}
var input=element.apply(form,[settings,self]);var input_content;if(settings.loadurl){var t=setTimeout(function(){input.disabled=true;content.apply(form,[settings.loadtext,settings,self]);},100);var loaddata={};loaddata[settings.id]=self.id;if($.isFunction(settings.loaddata)){$.extend(loaddata,settings.loaddata.apply(self,[self.revert,settings]));}else{$.extend(loaddata,settings.loaddata);}
$.ajax({type:settings.loadtype,url:settings.loadurl,data:loaddata,async:false,success:function(result){window.clearTimeout(t);input_content=result;input.disabled=false;}});}else if(settings.data){input_content=settings.data;if($.isFunction(settings.data)){input_content=settings.data.apply(self,[self.revert,settings]);}}else{input_content=self.revert;}
content.apply(form,[input_content,settings,self]);input.attr('name',settings.name);buttons.apply(form,[settings,self]);$(self).append(form);plugin.apply(form,[settings,self]);$(':input:visible:enabled:first',form).focus();if(settings.select){input.select();}
input.keydown(function(e){if(e.keyCode==27){e.preventDefault();reset.apply(form,[settings,self]);}});var t;if('cancel'==settings.onblur){input.blur(function(e){t=setTimeout(function(){reset.apply(form,[settings,self]);},500);});}else if('submit'==settings.onblur){input.blur(function(e){t=setTimeout(function(){form.submit();},200);});}else if($.isFunction(settings.onblur)){input.blur(function(e){settings.onblur.apply(self,[input.val(),settings]);});}else{input.blur(function(e){});}
form.submit(function(e){if(t){clearTimeout(t);}
e.preventDefault();if(false!==onsubmit.apply(form,[settings,self])){if(false!==submit.apply(form,[settings,self])){if($.isFunction(settings.target)){var str=settings.target.apply(self,[input.val(),settings]);$(self).html(str);self.editing=false;callback.apply(self,[self.innerHTML,settings]);if(!$.trim($(self).html())){$(self).html(settings.placeholder);}}else{var submitdata={};submitdata[settings.name]=input.val();submitdata[settings.id]=self.id;if($.isFunction(settings.submitdata)){$.extend(submitdata,settings.submitdata.apply(self,[self.revert,settings]));}else{$.extend(submitdata,settings.submitdata);}
if('PUT'==settings.method){submitdata['_method']='put';}
$(self).html(settings.indicator);var ajaxoptions={type:'POST',data:submitdata,dataType:'html',url:settings.target,success:function(result,status){if(ajaxoptions.dataType=='html'){$(self).html(result);}
self.editing=false;callback.apply(self,[result,settings]);if(!$.trim($(self).html())){$(self).html(settings.placeholder);}},error:function(xhr,status,error){onerror.apply(form,[settings,self,xhr]);}};$.extend(ajaxoptions,settings.ajaxoptions);$.ajax(ajaxoptions);}}}
$(self).attr('title',settings.tooltip);return false;});});this.reset=function(form){if(this.editing){if(false!==onreset.apply(form,[settings,self])){$(self).html(self.revert);self.editing=false;if(!$.trim($(self).html())){$(self).html(settings.placeholder);}
if(settings.tooltip){$(self).attr('title',settings.tooltip);}}}};});};$.editable={types:{defaults:{element:function(settings,original){var input=$('<input type="hidden"></input>');$(this).append(input);return(input);},content:function(string,settings,original){$(':input:first',this).val(string);},reset:function(settings,original){original.reset(this);},buttons:function(settings,original){var form=this;if(settings.submit){if(settings.submit.match(/>$/)){var submit=$(settings.submit).click(function(){if(submit.attr("type")!="submit"){form.submit();}});}else{var submit=$('<button type="submit" />');submit.html(settings.submit);}
$(this).append(submit);}
if(settings.cancel){if(settings.cancel.match(/>$/)){var cancel=$(settings.cancel);}else{var cancel=$('<button type="cancel" />');cancel.html(settings.cancel);}
$(this).append(cancel);$(cancel).click(function(event){if($.isFunction($.editable.types[settings.type].reset)){var reset=$.editable.types[settings.type].reset;}else{var reset=$.editable.types['defaults'].reset;}
reset.apply(form,[settings,original]);return false;});}}},text:{element:function(settings,original){var input=$('<input type="text" />');if(settings.width!='none'){input.width(settings.width);}
if(settings.height!='none'){input.height(settings.height);}
input.attr('autocomplete','off');$(this).append(input);return(input);}},textarea:{element:function(settings,original){var textarea=$('<textarea />');if(settings.rows){textarea.attr('rows',settings.rows);}else if(settings.height!="none"){textarea.height(settings.height);}
if(settings.cols){textarea.attr('cols',settings.cols);}else if(settings.width!="none"){textarea.width(settings.width);}
$(this).append(textarea);return(textarea);}},select:{element:function(settings,original){var select=$('<select />');$(this).append(select);return(select);},content:function(data,settings,original){if(String==data.constructor){var json=JSON.parse(data);}else{var json=data;}
var option,options=[];for(var key in json){if(!json.hasOwnProperty(key)){continue;}
if('selected'==key){continue;}
options.push({'val':key,'repr':json[key]});}
options.sort(function(a,b){return a.repr>b.repr;});for(var i=0;i<options.length;i++){option=options[i];$('select',this).append($('<option />').val(option['val']).append(option['repr']));}
$('select',this).children().each(function(){if($(this).val()==json['selected']||$(this).text()==$.trim(original.revert)){$(this).prop('selected',true);}});}}},addInputType:function(name,input){$.editable.types[name]=input;}};$.fn.editable.defaults={name:'value',id:'id',type:'text',width:'auto',height:'auto',event:'click.editable',onblur:'cancel',loadtype:'GET',loadtext:'Loading...',placeholder:'Click to edit',loaddata:{},submitdata:{},ajaxoptions:{}};})(jQuery);jQuery.fn.labelOver=function(overClass){return $(this).each(function(){var label=jQuery(this);var f=label.attr('for');if(f){var input=jQuery('#'+f);this.hide=function(){label.css({textIndent:-10000});}
this.show=function(){if(input.val()=='')label.css({textIndent:0});}
input.focus(this.hide);input.blur(this.show);label.addClass(overClass).click(function(){input.focus()});if(input.val()!='')this.hide();}});};;(function(factory){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],factory);}else{factory(jQuery);}}(function($){"use strict";var STR_REPLACE_REG=/<%=\s*(\w+)\s*%>/g;function isUndefined(target){return typeof target==="undefined";}
function replace(str,value){return str.replace(STR_REPLACE_REG,function(match,key){return value[key];});}
function RangePicker(container,options){if(isUndefined(options.startValue)||isUndefined(options.endValue)){throw new Error("startValue and endValue is need");}
if(isUndefined(options.translateSelectLabel)){throw new Error(" RangePicker: translateSelectLabel is need");}
this.__init(container,options);}
RangePicker.prototype={constructor:RangePicker,__defaultOptions:{type:"single"},__template:"<div class='range-picker-wrapper'>"+"<div class='range-picker'>"+"<span class='not-select-process'></span>"+"<span class='label range-label'><%= startValue %></span>"+"<span class='label range-label end-label'><%= endValue %></span>"+"</div>"+"</div>",__init:function(container,options){this.__$containerElement=container;options=$.extend({},this.__defaultOptions,options);this.refresh(options);},refresh:function(options){if(!isUndefined(this.__selectCursors)){if(this.__selectCursors.length>1){this.__selectCursors[1].getJQueryElement().remove();}
this.__selectCursors[0].getJQueryElement().remove();delete this.__selectCursors;this.__processBar.getJQueryElement().remove();delete this.__processBar;}
this.__options=$.extend({},this.__options,options);this.__render();this.__$rangepickerElement=this.__$containerElement.find(".range-picker");this.__addWidget();this.__setContainerToWrapperWidget();this.__setCursorInitialPosition();this.__updateProcessBarView();},__render:function(){var templateValue={startValue:this.__options.startValue,endValue:this.__options.endValue},viewStr=replace(this.__template,templateValue);this.__$containerElement.html(viewStr);},__addWidget:function(){var positionChangeCallback=$.proxy(this.__handleLabelPositionChange,this);this.__selectCursors=[];this.__selectCursors.push(new Cursor({positionChange:positionChangeCallback}));if(this.__options.type==="double"){this.__selectCursors.push(new Cursor({positionChange:positionChangeCallback}));}
this.__processBar=new ProcessBar();this.__$rangepickerElement.append(this.__processBar.getJQueryElement());for(var i=0;i<this.__selectCursors.length;i++){this.__$rangepickerElement.append(this.__selectCursors[i].getJQueryElement());}
this.__setWidgetInitialValue();},__setWidgetInitialValue:function(){var totalWidth=this.__$rangepickerElement.width();this.__selectCursors[0].render(this.__options.translateSelectLabel(totalWidth,totalWidth));if(!isUndefined(this.__selectCursors[1])){var cursor=this.__selectCursors[1];cursor.render(this.__options.translateSelectLabel(0,totalWidth));}},__setCursorInitialPosition:function(){var totalWidth=this.__$rangepickerElement.width(),cursors=this.__selectCursors;cursors[0].updateArrowPosition(totalWidth);cursors[0].setTotalWidth(totalWidth);if(!isUndefined(cursors[1])){cursors[1].updateArrowPosition(0);cursors[1].setTotalWidth(totalWidth);}},__setContainerToWrapperWidget:function(){var wrapperElement=this.__$containerElement.find(".range-picker-wrapper"),cursors=this.__selectCursors,totalWidth=this.__$rangepickerElement.width(),cursorHeight=-(cursors[0].getJQueryElement().position().top);if(!isUndefined(cursors[1])&&-(cursors[1].getJQueryElement().position().top)>cursorHeight){cursorHeight=-(cursors[1].getJQueryElement().position().top);}
wrapperElement.css("paddingTop",cursorHeight+"px");var endCursorElement=cursors[0].getJQueryElement(),paddingRight=endCursorElement.outerWidth()/2,paddingLeft=null;cursors[0].render(this.__options.translateSelectLabel(0,totalWidth));paddingLeft=endCursorElement.outerWidth()/2;cursors[0].render(this.__options.translateSelectLabel(totalWidth,totalWidth));wrapperElement.css({paddingLeft:paddingLeft+"px",paddingRight:paddingRight+"px"});},__handleLabelPositionChange:function(position){this.__updateView(position.left);this.__$containerElement.trigger("update");},__updateView:function(){this.__updateCursorView();this.__updateProcessBarView();},__updateCursorView:function(){var i=0,labelText="",position=null;for(;i<this.__selectCursors.length;i++){position=this.__selectCursors[i].getArrowPosition();labelText=this.__options.translateSelectLabel(position.left,this.__$rangepickerElement.width());this.__selectCursors[i].render(labelText);}},__updateProcessBarView:function(){var cursorPosition=this.__getCursorPosition(),processBarPosition={left:cursorPosition.start,right:this.__$rangepickerElement.width()-cursorPosition.end};this.__processBar.updatePosition(processBarPosition);},__getCursorPosition:function(){var position={start:0,startLabel:""},tmpPosition=this.__selectCursors[0].getArrowPosition();position.end=tmpPosition.left;position.endLabel=tmpPosition.positionLabel;if(!isUndefined(this.__selectCursors[1])){tmpPosition=this.__selectCursors[1].getArrowPosition();if(tmpPosition.left>position.end){position.start=position.end;position.startLabel=position.endLabel;position.end=tmpPosition.left;position.endLabel=tmpPosition.positionLabel;}else{position.start=tmpPosition.left;position.startLabel=tmpPosition.positionLabel;}}
return position;},__formatPositionValue:function(value,cursorLeftPosition){var totalWidth=this.__$rangepickerElement.width(),offset=0;value=value.replace(/\s+/,"");if(value[value.length-1]==="%"){offset=totalWidth*parseInt(value,10)/100;}else{offset=cursorLeftPosition+parseInt(value,10);}
return offset;},getSelectValue:function(){var position=this.__getCursorPosition();position.totalWidth=this.__$rangepickerElement.width();return position;},updatePosition:function(endValue,startValue){var cursors=this.__selectCursors;cursors[0].updateArrowPosition(this.__formatPositionValue(endValue,cursors[0].getArrowPosition().left));if(!isUndefined(cursors[1])&&!isUndefined(startValue)){cursors[1].updateArrowPosition(this.__formatPositionValue(startValue,cursors[1].getArrowPosition().left));}
this.__updateView();}};function Cursor(options){this.__init(options);}
Cursor.prototype={constructor:Cursor,__defaultOptions:{positionChange:$.loop},__template:"<span class='label select-label'></span>",__init:function(options){this.__options=$.extend({},this.__defaultOptions,options);this.__$element=$(this.__template);this.__bindDragEventHandler();},__bindDragEventHandler:function(){var self=this;this.__$element.on("mousedown",function(event){this.__rangepicker={isMouseDown:true,mouseStartX:event.clientX,previousMoveDistance:0};$(this).css("zIndex",1000);}).on("mouseup",function(){this.__rangepicker=null;$(this).css("zIndex",1);}).on("mousemove",function(event){if(this.__rangepicker&&this.__rangepicker.isMouseDown){self.__handleDragEvent(event.clientX,this.__rangepicker);}}).on("mouseout",function(){$(this).css("zIndex",1);this.__rangepicker=null;});},__handleDragEvent:function(clientX,elementData){var distance=clientX-elementData.mouseStartX-elementData.previousMoveDistance;elementData.previousMoveDistance=clientX-elementData.mouseStartX;var position=this.__calculatePosition(distance);this.updateArrowPosition(position);this.__options.positionChange(this.getArrowPosition(),this.__$element);},__calculatePosition:function(offset){var newPosition=this.__arrowPosition+offset;if(newPosition>this.__totalWidth){newPosition=this.__totalWidth;}else if(newPosition<0){newPosition=0;}
return newPosition;},__updatePosition:function(position){for(var key in position){if(position.hasOwnProperty(key)){this.__$element.css(key,position[key]+"px");}}},render:function(textValue){this.__$element.text(textValue);},updateArrowPosition:function(position){this.__arrowPosition=position;this.__updatePosition({left:position-this.__$element.outerWidth()/2});},getJQueryElement:function(){return this.__$element;},getArrowPosition:function(){return{left:this.__arrowPosition,positionLabel:this.__$element.text()};},setTotalWidth:function(totalWidth){this.__totalWidth=totalWidth;}};function ProcessBar(options){this.__init(options);}
ProcessBar.prototype={constructor:ProcessBar,__template:"<span class='process'></span>",__init:function(){this.__$element=$(this.__template);},updatePosition:function(position){for(var key in position){if(position.hasOwnProperty(key)){this.__$element.css(key,position[key]+"px");}}},getJQueryElement:function(){return this.__$element;}};$.fn.rangepicker=function(options){return new RangePicker(this,options);};}));(function(){S3.autocomplete={};S3.autocomplete.normal=function(fieldname,module,resourcename,input,filter,link,postprocess,delay,min_length){var dummy='dummy_'+input;var dummy_input=$('#'+dummy);if(!dummy_input.length){return;}
var url=S3.Ap.concat('/',module,'/',resourcename,'/search_ac.json?field=',fieldname);if(filter){url+='&'+filter;}
if(link){url+='&link='+link;}
var real_input=$('#'+input);real_input.hide();var value=real_input.val();if(value){var existing={value:value,label:dummy_input.val()};}else{var existing;}
real_input.data('existing',existing);real_input.data('url',url);if(real_input.parent().hasClass('controls')){var create=real_input.next().find('.s3_add_resource_link');}else{var create=real_input.parent().next().find('.s3_add_resource_link');}
var throbber=$('#'+dummy+'_throbber');if(delay==undefined){delay=800;}
if(min_length==undefined){min_length=2;}
var datastore={val:dummy_input.val(),accept:false};dummy_input.autocomplete({delay:delay,minLength:min_length,source:function(request,response){$.ajax({url:real_input.data('url'),data:{term:request.term}}).done(function(data){if(data.length==0){real_input.val('').change();var extra={id:0};extra[fieldname]=i18n.no_matching_records;data.push(extra);}else{var extra={id:0};extra[fieldname]=i18n.none_of_the_above;data.push(extra);}
response(data);});},search:function(event,ui){throbber.removeClass('hide').show();return true;},response:function(event,ui,content){throbber.hide();return content;},focus:function(event,ui){return false;},select:function(event,ui){var item=ui.item;if(item.id){dummy_input.val(item[fieldname]);real_input.val(item.id).change();existing={value:item.id,label:item[fieldname]};}else{dummy_input.val('');real_input.val('').change();}
if(postprocess){eval(postprocess);}
return false;}}).data('ui-autocomplete')._renderItem=function(ul,item){if(item.label){var label=item.label;}else{var label=item[fieldname];}
return $('<li>').data('item.autocomplete',item).append('<a>'+label+'</a>').appendTo(ul);};dummy_input.blur(function(){if(existing&&existing.label!=dummy_input.val()){real_input.val('').change();}});};S3.autocomplete.generic=function(url,input,postprocess,delay,min_length){var dummy='dummy_'+input;var dummy_input=$('#'+dummy);if(!dummy_input.length){return;}
var real_input=$('#'+input);real_input.hide();var value=real_input.val();if(value){var existing={value:value,name:dummy_input.val()};}else{var existing;}
real_input.data('existing',existing);real_input.data('url',url);if(real_input.parent().hasClass('controls')){var create=real_input.next().find('.s3_add_resource_link');}else{var create=real_input.parent().next().find('.s3_add_resource_link');}
var throbber=$('#'+dummy+'_throbber');if(delay==undefined){delay=800;}
if(min_length==undefined){min_length=2;}
dummy_input.autocomplete({delay:delay,minLength:min_length,source:function(request,response){$.ajax({url:real_input.data('url'),data:{term:request.term}}).done(function(data){if(data.length==0){real_input.val('').change();data.push({id:0,value:'',label:i18n.no_matching_records});}else{data.push({id:0,value:'',label:i18n.none_of_the_above});}
response(data);});},search:function(event,ui){throbber.removeClass('hide').show();return true;},response:function(event,ui,content){throbber.hide();return content;},focus:function(event,ui){return false;},select:function(event,ui){var item=ui.item;var id=item.id;if(id){dummy_input.val(item.name);real_input.val(id).change();existing={value:item.id,name:item.name};}else{dummy_input.val('');real_input.val('').change();}
if(postprocess){eval(postprocess);}
return false;}}).data('ui-autocomplete')._renderItem=function(ul,item){if(item.label){var label=item.label;}else if(item.matchString){var label=item.matchString+'<b>'+item.nextString+'</b>'
if(item.context){label+=' - '+item.context;}}else{var label=item.name;}
return $('<li>').data('item.autocomplete',item).append('<a>'+label+'</a>').appendTo(ul);};dummy_input.blur(function(){if(existing&&existing.name!=dummy_input.val()){real_input.val('').change();}});};var represent_location=function(item){if(item.label!=undefined){return item.label;}
if(item.name){var name;if(item.match_type){if(item.next_string){name=item.match_string+'<b>'+item.next_string+'</b>';}
else{name=item.match_string;}}
else{name=item.name;}}else{var name=''}
if(item.addr){if(name){name+=', '+item.addr;}else{name=item.addr;}}
if(item.L5){if(name){name+=', '+item.L5;}else{name=item.L5;}}
if(item.L4){if(name){name+=', '+item.L4;}else{name=item.L4;}}
if(item.L3){if(name){name+=', '+item.L3;}else{name=item.L3;}}
if(item.L2){if(name){name+=', '+item.L2;}else{name=item.L2;}}
if(item.L1){if(name){name+=', '+item.L1;}else{name=item.L1;}}
if(item.L0){if(name){name+=', '+item.L0;}else{name=item.L0;}}
return name;}
S3.autocomplete.location=function(input,level,min_length,delay,postprocess){var dummy='dummy_'+input;var dummy_input=$('#'+dummy);if(!dummy_input.length){return;}
var represent=represent_location;var url=S3.Ap.concat('/gis/location/search_ac.json');var real_input=$('#'+input);real_input.hide();var value=real_input.val();if(value){var existing={value:value,name:dummy_input.val()};}else{var existing;}
real_input.data('existing',existing);real_input.data('url',url);if(real_input.parent().hasClass('controls')){var create=real_input.next().find('.s3_add_resource_link');}else{var create=real_input.parent().next().find('.s3_add_resource_link');}
var throbber=$('#'+dummy+'_throbber');if(level){url+='?level='+level;}
if(delay==undefined){delay=800;}
if(min_length==undefined){min_length=2;}
dummy_input.autocomplete({delay:delay,minLength:min_length,source:function(request,response){$.ajax({url:real_input.data('url'),data:{term:request.term}}).done(function(data){if(data.length==0){real_input.val('').change();data.push({id:0,value:'',label:i18n.no_matching_records});}else{data.push({id:0,value:'',label:i18n.none_of_the_above});}
response(data);});},search:function(event,ui){throbber.removeClass('hide').show();return true;},response:function(event,ui,content){throbber.hide();return content;},focus:function(event,ui){return false;},select:function(event,ui){var item=ui.item;if(item.id){dummy_input.val(ui.item.name);real_input.val(item.id).change();existing={value:item.id,name:ui.item.name};}else{dummy_input.val('');real_input.val('').change();}
if(postprocess){eval(postprocess);}
return false;}}).data('ui-autocomplete')._renderItem=function(ul,item){var label=represent_location(item);return $('<li>').data('item.autocomplete',item).append('<a>'+label+'</a>').appendTo(ul);};dummy_input.blur(function(){if(existing&&existing.name!=dummy_input.val()){real_input.val('').change();}});};var represent_person=function(item){if(item.label!=undefined){return item.label;}
if(item.org||item.job){var name=represent_hr(item);}else{var name=item.name;}
return name;}
S3.autocomplete.person=function(controller,fn,input,ajax_filter,postprocess,delay,min_length){var dummy='dummy_'+input;var dummy_input=$('#'+dummy);if(!dummy_input.length){return;}
var represent=represent_person;var url=S3.Ap.concat('/',controller,'/',fn,'/search_ac.json');if(ajax_filter){url+="?"+ajax_filter;}
var real_input=$('#'+input);real_input.hide();var value=real_input.val();if(value){var existing={value:value,name:dummy_input.val()};}else{var existing;}
real_input.data('existing',existing);real_input.data('url',url);if(real_input.parent().hasClass('controls')){var create=real_input.next().find('.s3_add_resource_link');}else{var create=real_input.parent().next().find('.s3_add_resource_link');}
var throbber=$('#'+dummy+'_throbber');if(delay==undefined){delay=800;}
if(min_length==undefined){min_length=2;}
dummy_input.autocomplete({delay:delay,minLength:min_length,source:function(request,response){$.ajax({url:real_input.data('url'),data:{term:request.term}}).done(function(data){if(data.length==0){real_input.val('').change();data.push({id:0,value:'',label:i18n.no_matching_records});}else{data.push({id:0,value:'',label:i18n.none_of_the_above});}
response(data);});},search:function(event,ui){throbber.removeClass('hide').show();return true;},response:function(event,ui,content){throbber.hide();return content;},focus:function(event,ui){return false;},select:function(event,ui){var item=ui.item;if(item.id){var name=represent(item);dummy_input.val(name);real_input.val(item.id).change();existing={value:item.id,name:name};}else{dummy_input.val('');real_input.val('').change();}
if(postprocess){eval(postprocess);}
return false;}}).data('ui-autocomplete')._renderItem=function(ul,item){var label=represent(item);return $('<li>').data('item.autocomplete',item).append('<a>'+label+'</a>').appendTo(ul);};dummy_input.blur(function(){if(existing&&existing.name!=dummy_input.val()){real_input.val('').change();}});};S3.autocomplete.pentity=function(controller,fn,input,postprocess,delay,min_length,types){var dummy='dummy_'+input;var dummy_input=$('#'+dummy);if(!dummy_input.length){return;}
var url=S3.Ap.concat('/',controller,'/',fn,'/search_ac.json');var real_input=$('#'+input);real_input.hide();var value=real_input.val();if(value){var existing={value:value,name:dummy_input.val()};}else{var existing;}
real_input.data('existing',existing);real_input.data('url',url);if(real_input.parent().hasClass('controls')){var create=real_input.next().find('.s3_add_resource_link');}else{var create=real_input.parent().next().find('.s3_add_resource_link');}
var throbber=$('#'+dummy+'_throbber');if(delay==undefined){delay=800;}
if(min_length==undefined){min_length=2;}
if(types){url+='?types='+types;}
dummy_input.autocomplete({delay:delay,minLength:min_length,source:function(request,response){$.ajax({url:real_input.data('url'),data:{term:request.term}}).done(function(data){if(data.length==0){real_input.val('').change();data.push({id:0,value:'',label:i18n.no_matching_records});}else{data.push({id:0,value:'',label:i18n.none_of_the_above});}
response(data);});},search:function(event,ui){throbber.removeClass('hide').show();return true;},response:function(event,ui,content){throbber.hide();return content;},focus:function(event,ui){return false;},select:function(event,ui){var item=ui.item;if(item.id){dummy_input.val(item.name);real_input.val(item.id).change();existing={value:item.id,name:item.name};}else{dummy_input.val('');real_input.val('').change();}
if(postprocess){eval(postprocess);}
return false;}}).data('ui-autocomplete')._renderItem=function(ul,item){if(item.label){var label=item.label;}else{var label=item.name;}
return $('<li>').data('item.autocomplete',item).append('<a>'+label+'</a>').appendTo(ul);};dummy_input.blur(function(){if(existing&&existing.name!=dummy_input.val()){real_input.val('').change();}});};var represent_hr=function(item){if(item.label!=undefined){return item.label;}
var name=item.name;var org=item.org;var job=item.job;if(org||job){if(job){name+=' ('+job;if(org){name+=', '+org;}
name+=')';}else{name+=' ('+org+')';}}
return name;}
S3.autocomplete.hrm=function(group,input,postprocess,delay,min_length){var dummy='dummy_'+input;var dummy_input=$('#'+dummy);if(!dummy_input.length){return;}
if(group=='staff'){var url=S3.Ap.concat('/hrm/hr_search/search_ac?group=staff');}else if(group=='volunteer'){var url=S3.Ap.concat('/vol/hr_search/search_ac');}else if(group=='deploy'){var url=S3.Ap.concat('/deploy/hr_search/search_ac');}else{var url=S3.Ap.concat('/hrm/hr_search/search_ac');}
var real_input=$('#'+input);real_input.hide();var value=real_input.val();if(value){var existing={value:value,name:dummy_input.val()};}else{var existing;}
real_input.data('existing',existing);real_input.data('url',url);if(real_input.parent().hasClass('controls')){var create=real_input.next().find('.s3_add_resource_link');}else{var create=real_input.parent().next().find('.s3_add_resource_link');}
var throbber=$('#'+dummy+'_throbber');if(delay==undefined){delay=800;}
if(min_length==undefined){min_length=2;}
dummy_input.autocomplete({delay:delay,minLength:min_length,source:function(request,response){$.ajax({url:real_input.data('url'),data:{term:request.term}}).done(function(data){if(data.length==0){real_input.val('').change();data.push({id:0,value:'',label:i18n.no_matching_records});}else{data.push({id:0,value:'',label:i18n.none_of_the_above});}
response(data);});},search:function(event,ui){throbber.removeClass('hide').show();return true;},response:function(event,ui,content){throbber.hide();return content;},focus:function(event,ui){return false;},select:function(event,ui){var item=ui.item;if(item.id){var name=represent_person(item);dummy_input.val(name);real_input.val(item.id).change();existing={value:item.id,name:name};}else{dummy_input.val('');real_input.val('').change();}
if(postprocess){eval(postprocess);}
return false;}}).data('ui-autocomplete')._renderItem=function(ul,item){var label=represent_hr(item);return $('<li>').data('item.autocomplete',item).append('<a>'+label+'</a>').appendTo(ul);};dummy_input.blur(function(){if(existing&&existing.name!=dummy_input.val()){real_input.val('').change();}});};var represent_org=function(item){if(item.label!=undefined){return item.label;}
if(item.matchString){if(item.match=='acronym'){var label=item.name;if(item.parent){label=item.parent+' > '+label;}
label+=' - '+item.matchString+'<b>'+item.nextString+'</b>';}else{var label=item.matchString+'<b>'+item.nextString+'</b>';if(item.parent){label=item.parent+' > '+label;}else if(item.acronym){label+=' - '+item.acronym;}}}else{var label=item.name;if(item.parent){label=item.parent+' > '+item.name;}else if(item.acronym){label+=' ('+item.acronym+')';}}
return label;}
S3.autocomplete.org=function(input,postprocess,delay,min_length){var dummy='dummy_'+input;var dummy_input=$('#'+dummy);if(!dummy_input.length){return;}
var url=S3.Ap.concat('/org/organisation/search_ac.json');var real_input=$('#'+input);real_input.hide();var value=real_input.val();if(value){var existing={value:value,name:dummy_input.val()};}else{var existing;}
real_input.data('existing',existing);real_input.data('url',url);if(real_input.parent().hasClass('controls')){var create=real_input.next().find('.s3_add_resource_link');}else{var create=real_input.parent().next().find('.s3_add_resource_link');}
var throbber=$('#'+dummy+'_throbber');if(delay==undefined){delay=800;}
if(min_length==undefined){min_length=2;}
dummy_input.autocomplete({delay:delay,minLength:min_length,source:function(request,response){$.ajax({url:real_input.data('url'),data:{term:request.term}}).done(function(data){if(data.length==0){real_input.val('').change();data.push({id:0,value:'',label:i18n.no_matching_records});}else{data.push({id:0,value:'',label:i18n.none_of_the_above});}
response(data);});},search:function(event,ui){throbber.removeClass('hide').show();return true;},response:function(event,ui,content){throbber.hide();return content;},focus:function(event,ui){return false;},select:function(event,ui){var item=ui.item;if(item.id){dummy_input.val(item.name);real_input.val(item.id).change();existing={value:item.id,name:item.name};}else{dummy_input.val('');real_input.val('').change();}
if(postprocess){eval(postprocess);}
return false;}}).data('ui-autocomplete')._renderItem=function(ul,item){var label=represent_org(item);return $('<li>').data('item.autocomplete',item).append('<a>'+label+'</a>').appendTo(ul);};dummy_input.blur(function(){if(existing&&existing.name!=dummy_input.val()){real_input.val('').change();}});};var represent_site=function(item){if(item.label!=undefined){return item.label;}
if(item.match_type){var label='<b>'+item.match_string+'</b>';if(item.pre_string){label=item.pre_string+label;}
if(item.next_string){label+=item.next_string;}
if(item.match_type=='name'){var addr=item.addr;var Lx=item.L4||item.L3||item.L2||item.L1;if(addr||Lx){if(addr){label+=' ('+addr;if(Lx){label+=', '+Lx;}
label+=')';}else{label+=' ('+Lx+')';}}
var org=item.org;var instance_type=item.instance_type;if(org||instance_type){if(instance_type){label+=' ('+S3.org_site_types[instance_type];if(org){label+=', '+org;}
label+=')';}else{label+=' ('+org+')';}}}else if(item.match_type=='addr'){label=item.name+' ('+label;var Lx=item.L4||item.L3||item.L2||item.L1;if(Lx){label+=', '+Lx+')';}else{label+=')';}
var org=item.org;var instance_type=item.instance_type;if(org||instance_type){if(instance_type){label+=' ('+S3.org_site_types[instance_type];if(org){label+=', '+org;}
label+=')';}else{label+=' ('+org+')';}}}else if(item.match_type=='org'){var context=item.name;var addr=item.addr;var Lx=item.L4||item.L3||item.L2||item.L1;if(addr||Lx){if(addr){context+=' ('+addr;if(Lx){context+=', '+Lx;}
context+=')';}else{context+=' ('+Lx+')';}}
var instance_type=item.instance_type;if(instance_type){label=context+' ('+S3.org_site_types[instance_type]+', '+label+')';}else{label=context+' ('+label+')';}}else{var context=item.name;var addr=item.addr;if(addr){label=context+' ('+addr+', '+label+')';}else{label=context+' ('+label+')';}
var org=item.org;var instance_type=item.instance_type;if(org||instance_type){if(instance_type){label+=' ('+S3.org_site_types[instance_type];if(org){label+=', '+org;}
label+=')';}else{label+=' ('+org+')';}}}}else{label=item.name;}
return label;}
S3.autocomplete.site=function(input,postprocess,delay,min_length){var dummy='dummy_'+input;var dummy_input=$('#'+dummy);if(!dummy_input.length){return;}
var url=S3.Ap.concat('/org/site/search_ac.json');var real_input=$('#'+input);real_input.hide();var value=real_input.val();if(value){var existing={value:value,name:dummy_input.val()};}else{var existing;}
real_input.data('existing',existing);real_input.data('url',url);if(real_input.parent().hasClass('controls')){var create=real_input.next().find('.s3_add_resource_link');}else{var create=real_input.parent().next().find('.s3_add_resource_link');}
var throbber=$('#'+dummy+'_throbber');if(delay==undefined){delay=800;}
if(min_length==undefined){min_length=2;}
dummy_input.autocomplete({delay:delay,minLength:min_length,source:function(request,response){$.ajax({url:real_input.data('url'),data:{term:request.term}}).done(function(data){if(data.length==0){real_input.val('').change();data.push({id:0,value:'',label:i18n.no_matching_records});}else{data.push({id:0,value:'',label:i18n.none_of_the_above});}
response(data);});},search:function(event,ui){throbber.removeClass('hide').show();return true;},response:function(event,ui,content){throbber.hide();return content;},focus:function(event,ui){return false;},select:function(event,ui){var item=ui.item;if(item.id){dummy_input.val(item.name);real_input.val(item.id).change();existing={value:item.id,name:item.name};}else{dummy_input.val('');real_input.val('').change();}
if(postprocess){eval(postprocess);}
return false;}}).data('ui-autocomplete')._renderItem=function(ul,item){var label=represent_site(item);return $('<li>').data('item.autocomplete',item).append('<a>'+label+'</a>').appendTo(ul);};dummy_input.blur(function(){if(existing&&existing.name!=dummy_input.val()){real_input.val('').change();}});};}());$(document).ready(function(){$('input.date').datepicker({changeMonth:true,changeYear:true,showOn:'both',buttonText:'',dateFormat:'yy-mm-dd',isRTL:S3.rtl});$('input.time').fgtimepicker({hourText:i18n.hour,minuteText:i18n.minute,defaultTime:''});});(function($){"use strict";$.widget('s3.end_date_interval',{options:{show_clear_button:true},_create:function(){var options;options=this.options;this.namespace=".enddateinterval"
this.start_element=$(options.start_date_selector);this.default_interval=options.interval;this.start_date_prev=this.start_element.datepicker('getDate');},_init:function(){var select_start_date,default_interval,select_end_date,start_element,start_month,start_year,start_date,interval,options,element,self;options=this.options;self=this;start_element=this.start_element;element=$(this.element);interval=this.interval;default_interval=this.default_interval;element.datepicker('option',{yearRange:'c-100:c+100',showButtonPanel:true}).one('click',function(){$(this).focus()});if(options.show_clear_button){var clear_button=$('<button id="end_date_clear" class="btn date-clear-btn" type="button">'+i18n.btn_clear+'</button>').click(function(){element.val('');});element.next().after(clear_button);}
element.unbind(self.namespace).on('click'+self.namespace,function(){select_start_date=start_element.datepicker('getDate');if(select_start_date!=null){self._inputclick();}});select_end_date=element.datepicker('getDate');if(select_end_date==null){if(options.default_explicit){self.interval=default_interval;self._end_date_automate(self.interval);}
start_element.change(function(){interval=self.interval;select_end_date=element.datepicker('getDate');if(select_end_date!=null){var start_date_prev=self.start_date_prev;start_month=start_date_prev.getMonth()+1;start_year=start_date_prev.getFullYear();start_date=start_date_prev.getDate();start_date_prev=new Date(start_year,start_month,start_date);self._add_months(start_date_prev,interval-1);select_end_date=element.datepicker('getDate');if(self._equal_date(select_end_date,start_date_prev)){self._end_date_automate(interval);}}});}},_end_date_automate:function(months){var select_start_date,start_element,start_month,start_year,start_date,element,self;start_element=this.start_element;element=$(this.element);self=this;select_start_date=start_element.datepicker('getDate');start_month=select_start_date.getMonth()+1;start_year=select_start_date.getFullYear();start_date=select_start_date.getDate();select_start_date=new Date(start_year,start_month,start_date);self._add_months(select_start_date,months-1);element.datepicker('setDate',select_start_date);self.start_date_prev=start_element.datepicker('getDate');},_inputclick:function(){var select_end_date,default_interval,element,ns,self;ns=this.namespace;element=$(this.element);default_interval=this.default_interval;self=this;select_end_date=element.datepicker('getDate');if(select_end_date==null){self.interval=default_interval;self._end_date_automate(default_interval);}
var buttonPane=$('.ui-datepicker-buttonpane');$('.ui-datepicker-current').hide();$('.ui-datepicker-close').hide();var pane_heading=$('<h5>'+i18n.interval+'</h5>');pane_heading.appendTo(buttonPane);var btn_1=$('<a class="ui-datepicker-current ui-state-default ui-priority-primary" type="button">'+i18n.btn_1_label+'</a>');btn_1.unbind(ns).bind('click'+ns,function(){self.interval=6;self._end_date_automate(self.interval);});btn_1.appendTo(buttonPane);var btn_2=$('<a class="ui-datepicker-current ui-state-default ui-priority-primary" type="button">'+i18n.btn_2_label+'</a>');btn_2.unbind(ns).bind('click'+ns,function(){self.interval=12;self._end_date_automate(self.interval);});btn_2.appendTo(buttonPane);var btn_3=$('<a class="ui-datepicker-current ui-state-default ui-priority-primary" type="button">'+i18n.btn_3_label+'</a>');btn_3.unbind(ns).bind('click'+ns,function(){self.interval=24;self._end_date_automate(self.interval);});btn_3.appendTo(buttonPane);var btn_4=$('<a class="ui-datepicker-current ui-state-default ui-priority-primary" type="button">'+i18n.btn_4_label+'</a>');btn_4.unbind(ns).bind('click'+ns,function(){self.interval=60;self._end_date_automate(self.interval);});btn_4.appendTo(buttonPane);$('.ui-datepicker-buttonpane a').css('margin','.3em');$('.ui-datepicker-buttonpane a').css('font-size','1rem');$('.ui-datepicker-buttonpane').css('text-align','center');},_equal_date:function(mDate,pDate){return(mDate.getFullYear()===pDate.getFullYear()&&mDate.getMonth()===pDate.getMonth()&&mDate.getDate()===pDate.getDate());},_is_leap_year:function(year){return(((year%4===0)&&(year%100!==0))||(year%400===0));},_get_days_in_month:function(year,month){var element=$(this.element);var self=this;return[31,(self._is_leap_year(year)?29:28),31,30,31,30,31,31,30,31,30,31][month];},_get_days_in_month_big:function(mdate){var element=$(this.element);var self=this;return self._get_days_in_month(mdate.getFullYear(),mdate.getMonth());},_add_months:function(mdate,value){var self=this;var element=$(this.element);var n=mdate.getDate();mdate.setDate(1);mdate.setMonth(mdate.getMonth()+value);mdate.setDate(Math.min(n,self._get_days_in_month_big(mdate)));return mdate;}});})(jQuery);S3.search={};(function(){"use strict";var searchRewriteAjaxOptions=function(s,method){if(s.type!='GET'){return;}else{s.type='POST';}
var isFilterKey=function(k){var k0=k[0];return(k=='$filter'||k0!='_'&&(k.search(/\./)!=-1||k0=='('&&k.search(/\)/)!=-1));};var parts=s.url.split('#'),path=parts[0],fragment=null,query=null;if(parts.length>1){fragment=parts[1];}
parts=path.split('?');path=parts[0];if(parts.length>1){query=parts[1];}
var ajaxData=s.data,postData={},queryDict={},queryItem,valueCount,itemCount,i,j,k,v;var addQueryItem=function(items,key,val){if(Array.isArray(val)){for(j=0,valueCount=val.length;j<valueCount;j++){addQueryItem(items,key,val[j]);}
return;}
if(!items.hasOwnProperty(key)){items[key]=val;}else if(Array.isArray(items[key])){items[key].push(val);}else{items[key]=[items[key],val];}};if(ajaxData){for(i=0,itemCount=ajaxData.length;i<itemCount;i++){queryItem=ajaxData[i];addQueryItem(queryDict,queryItem.name,queryItem.value);}}
if(query){var items=S3.queryString.parse(query);for(k in items){v=items[k];if(isFilterKey(k)){addQueryItem(postData,k,v);}else{addQueryItem(queryDict,k,v);}}}
if(method=="ajax"){s.data=JSON.stringify(postData);}else{s.data=postData;}
s.processData=false;var ajaxURL=path+'?$search='+method;var queryString=S3.queryString.stringify(queryDict);if(queryString){ajaxURL+='&'+queryString;}
if(fragment!==null){ajaxURL+='#'+fragment;}
s.url=ajaxURL;};S3.search.searchRewriteAjaxOptions=searchRewriteAjaxOptions;var searchS3Defaults={timeout:10000,retryLimit:5,dataType:'json',contentType:'application/json; charset=utf-8',processData:false,async:true,type:'POST'};$.searchS3=function(ajaxOptions){var options=$.extend({},searchS3Defaults,ajaxOptions);searchRewriteAjaxOptions(options,'ajax');return $.ajaxS3(options);};$.searchDownloadS3=function(url,target){var options=$.extend({},searchS3Defaults,{url:url}),form=document.createElement('form');options.type='GET';searchRewriteAjaxOptions(options,'form');form.action=options.url;form.method='POST';form.target=target||'_self';form.enctype='multipart/form-data';var data=options.data;if(data){var key,input;for(key in data){input=document.createElement('textarea');input.name=key;input.value=JSON.stringify(data[key]);form.appendChild(input);}}
form.style.display='none';document.body.appendChild(form);form.submit();};var pendingTargets={};var quoteValue=function(value){if(value){var result=value.replace(/\"/,'\\"');if(result.search(/\,/)!=-1){result='"'+result+'"';}
return result;}else{return(value);}};var parseValue=function(value){if(!value){return value;}
var values=[],quote=false;for(var idx=0,i=0;i<value.length;i++){var c=value[i];values[idx]=values[idx]||'';if(c=='"'){quote=!quote;continue;}
if(c==','&&!quote){if(values[idx]=='NONE'){values[idx]=null;}
++idx;continue;}
values[idx]+=c;}
return values;};var clearFilters=function(form){if(undefined===form){form=$('body').find('form.filter-form').first();}
form.data('noAutoSubmit',1);form.find('.text-filter').val('');form.find('.options-filter, .location-filter').each(function(){var $this=$(this);if(this.tagName.toLowerCase()=='select'){$this.val('');if($this.hasClass('groupedopts-filter-widget')&&$this.groupedopts('instance')){$this.groupedopts('refresh');}else
if($this.hasClass('multiselect-filter-widget')&&$this.multiselect('instance')){$this.multiselect('refresh');}}else{var id=$this.attr('id');$("input[name='"+id+"']:checked").each(function(){$(this).click();});}
if($this.hasClass('location-filter')){hierarchical_location_change(this);}});form.find('.map-filter').each(function(){var $this=$(this);$this.val('');var widget_name=$this.attr('id'),map_id=widget_name+'-map',s3=S3.gis.maps[map_id].s3,polygonButton=s3.polygonButton;if(polygonButton.getIconClass()=='drawpolygonclear-off'){polygonButton.items[0].btnEl.dom.click();}});form.find('.range-filter-input').val('');form.find('.date-filter-input').each(function(){var $this=$(this);$this.calendarWidget('clear');var widget_name=$this.attr('id');var widget=$('#'+widget_name.slice(0,-3));widget.find('.range-picker').each(function(){$(this).trigger('clear');});});form.find('.hierarchy-filter').each(function(){var $this=$(this);if($this.hasClass('s3-cascade-select')){$this.cascadeSelect('reset');}else{$this.hierarchicalopts('reset');}});form.find('.age-filter-input').val('');form.find('.filter-manager-widget').each(function(){var that=$(this);if(that.filtermanager!==undefined){that.filtermanager('clear');}});form.data('noAutoSubmit',0);form.trigger('optionChanged');};var FILTEROP=/__(?!link\.)([a-z_]+)$/;var getCurrentFilters=function(form){if(typeof form=='undefined'){form=$('body').find('form.filter-form').first();}
var i,id,queries=[],$this,urlVar,value,values,subString,operator;form.find('.text-filter:visible').each(function(){$this=$(this);id=$this.attr('id');urlVar=$('#'+id+'-data').val();value=$this.val().trim();if(value){values=value.split(' ');var match=$this.data('match'),quoted,anyValue=[];for(i=0;i<values.length;i++){subString=$.trim(values[i]);if(subString===""){continue;}
quoted=quoteValue('*'+subString+'*');if(match=="any"){anyValue.push(quoted);}else{queries.push([urlVar,quoted]);}}
if(match=="any"){queries.push([urlVar,anyValue.join(',')]);}}else{queries.push([urlVar,null]);}});form.find('.s3-groupedopts-widget:visible').prev('.options-filter.groupedopts-filter-widget').add(form.find('.ui-multiselect:visible').prev('.options-filter.multiselect-filter-widget')).add(form.find('.options-filter:visible,'+'.options-filter.multiselect-filter-widget.active')).each(function(){$this=$(this);id=$this.attr('id');urlVar=$('#'+id+'-data').val();operator=$("input:radio[name='"+id+"_filter']:checked").val();switch(operator){case'any':urlVar=urlVar.replace(/__contains$|__belongs$/,'__anyof');break;case'all':urlVar=urlVar.replace(/__anyof$|__belongs$/,'__contains');break;default:break;}
if(this.tagName.toLowerCase()=='select'){value='';values=$this.val();if(values){if(!(values instanceof Array)){values=values.split(',');}
var v;for(i=0;i<values.length;i++){v=quoteValue(values[i]);if(value===''){value=v;}else{value=value+','+v;}}}}else{value='';$("input[name='"+id+"']:checked").each(function(){if(value===''){value=quoteValue($(this).val());}else{value=value+','+quoteValue($(this).val());}});}
if((value==='')||(value=='*')){queries.push([urlVar,null]);}else{queries.push([urlVar,value]);}});form.find('.map-filter').each(function(){$this=$(this);id=$this.attr('id');urlVar=$('#'+id+'-data').val();value=$this.val();if(value){queries.push([urlVar,value]);}else{queries.push([urlVar,null]);}});form.find('.range-filter-input:visible').each(function(){$this=$(this);id=$this.attr('id');urlVar=$('#'+id+'-data').val();value=$this.val();if(value){queries.push([urlVar,value]);}else{queries.push([urlVar,null]);}});form.find('.date-filter-input:visible').each(function(){$this=$(this);id=$this.attr('id');urlVar=$('#'+id+'-data').val();value=$this.val();operator=id.split('-').pop();var isoFormat;if($this.hasClass('datetimepicker')){isoFormat=function(dt){return dt.getFullYear()+'-'+
('0'+(dt.getMonth()+1)).slice(-2)+'-'+
('0'+dt.getDate()).slice(-2)+'T'+
('0'+dt.getHours()).slice(-2)+':'+
('0'+dt.getMinutes()).slice(-2)+':'+
('0'+dt.getSeconds()).slice(-2);};}else{var timeStr='';if($this.hasClass('hide-time')){if(operator=='le'){timeStr='T23:59:59';}else{timeStr='T00:00:00';}}
isoFormat=function(dt){return dt.getFullYear()+'-'+
('0'+(dt.getMonth()+1)).slice(-2)+'-'+
('0'+dt.getDate()).slice(-2)+
timeStr;};}
if(value){var end=false;if(operator=='le'){end=true;}
var jsDate=$this.calendarWidget('getJSDate',end),urlValue=isoFormat(jsDate);if(end&&$this.hasClass('end_date')){var selector=urlVar.replace(FILTEROP,'');queries.push(['$filter','('+selector+' '+operator+' "'+urlValue+'") or ('+selector+' eq None)']);}else{queries.push([urlVar,urlValue]);}}else{queries.push([urlVar,null]);}});form.find('.s3-groupedopts-widget:visible').prev('.location-filter.groupedopts-filter-widget').add(form.find('.ui-multiselect:visible').prev('.location-filter.multiselect-filter-widget').add(form.find('.location-filter:visible,'+'.location-filter.multiselect-filter-widget.active'))).each(function(){$this=$(this);id=$this.attr('id');urlVar=$('#'+id+'-data').val();value='';if(this.tagName.toLowerCase()=='select'){values=$(this).val();var v;if(values){for(i=0;i<values.length;i++){v=quoteValue(values[i]);if(value===''){value=v;}else{value=value+','+v;}}}}else{$("input[name='"+id+"']:checked").each(function(){if(value===''){value=quoteValue($(this).val());}else{value=value+','+quoteValue($(this).val());}});}
if(value===''){queries.push([urlVar,null]);}else{queries.push([urlVar,value]);}});form.find('.hierarchy-filter:visible').each(function(){$this=$(this);id=$this.attr('id');urlVar=$('#'+id+'-data').val();value='';if($this.hasClass('s3-cascade-select')){values=$this.cascadeSelect('get');}else{values=$this.hierarchicalopts('get');}
if(values){for(i=0;i<values.length;i++){if(value===''){value+=values[i];}else{value=value+','+values[i];}}}
if(value===''){queries.push([urlVar,null]);}else{queries.push([urlVar,value]);}});form.find('.age-filter-input:visible').each(function(){$this=$(this);id=$this.attr('id');urlVar=$('#'+id+'-data').val();value=$this.val();var years=value-0;if(value&&!isNaN(years)){var m=urlVar.match(FILTEROP);if(m&&m[1]=='gt'){years+=1;}
var dt=new Date();dt.setYear(dt.getFullYear()-years);dt=dt.getFullYear()+'-'+
('0'+(dt.getMonth()+1)).slice(-2)+'-'+
('0'+dt.getDate()).slice(-2);queries.push([urlVar,dt]);}else{queries.push([urlVar,null]);}});$('.value-filter:visible',form).each(function(){$this=$(this);id=$this.attr('id');urlVar=$('#'+id+'-data').val();if($this.prop('checked')){queries.push([urlVar,'None']);}else{queries.push([urlVar,null]);}});return queries;};S3.search.getCurrentFilters=getCurrentFilters;var setCurrentFilters=function(form,queries){if(undefined===form){form=$('body').find('form.filter-form').first();}
form.data('noAutoSubmit',1);var expression,i,id,q={},len,$this,value,values;for(i=0,len=queries.length;i<len;i++){var query=queries[i];expression=query[0];if(typeof query[1]=='string'){values=parseValue(query[1]);}else{values=query[1];}
if(q.hasOwnProperty(expression)){q[expression]=q[expression].concat(values);}else{q[expression]=values;}}
form.find('.text-filter').each(function(){$this=$(this);id=$this.attr('id');expression=$('#'+id+'-data').val();if(q.hasOwnProperty(expression)){if(!$this.is(':visible')&&!$this.hasClass('active')){toggleAdvanced(form);}
values=q[expression];value='';if(values){var v;for(i=0,len=values.length;i<len;i++){v=values[i];if(!v){continue;}
if(i>0){value+=' ';}
if(v[0]=='*'){v=v.slice(1);}
if(v.slice(-1)=='*'){v=v.slice(0,-1);}
value+=v;}}
$this.val(value);}});form.find('.options-filter').each(function(){$this=$(this);id=$this.attr('id');expression=$('#'+id+'-data').val();var operator=$('input:radio[name="'+id+'_filter"]:checked').val();if(this.tagName&&this.tagName.toLowerCase()=='select'){var refresh=false,selector=expression.replace(FILTEROP,'');if(q.hasOwnProperty(selector+'__eq')){values=q[selector+'__eq'];refresh=true;}else if(q.hasOwnProperty(selector)){values=q[selector];refresh=true;}else if(q.hasOwnProperty(expression)){values=q[expression];refresh=true;}else if(operator=='any'||operator=='all'){if(q.hasOwnProperty(selector+'__anyof')){values=q[selector+'__anyof'];refresh=true;$('input:radio[name="'+id+'_filter"][value="any"]').prop('checked',true);}else if(q.hasOwnProperty(selector+'__contains')){values=q[selector+'__contains'];refresh=true;$('input:radio[name="'+id+'_filter"][value="all"]').prop('checked',true);}}
if(refresh){if(!$this.is(':visible')&&!$this.hasClass('active')){toggleAdvanced(form);}
$this.val(values);if($this.hasClass('groupedopts-filter-widget')&&$this.groupedopts('instance')){$this.groupedopts('refresh');}else
if($this.hasClass('multiselect-filter-widget')&&$this.multiselect('instance')){$this.multiselect('refresh');}}}});form.find('.map-filter').each(function(){$this=$(this);id=$this.attr('id');expression=$('#'+id+'-data').val();if(q.hasOwnProperty(expression)){if(!$this.is(':visible')&&!$this.hasClass('active')){toggleAdvanced(form);}
values=q[expression];var map_id;if(values){$this.val(values[0]);map_id=id+'-map';S3.gis.maps[map_id].s3.polygonButtonLoaded();}else{$this.val('');map_id=id+'-map';S3.gis.maps[map_id].s3.layerRefreshed();}}});form.find('.range-filter-input').each(function(){$this=$(this);id=$this.attr('id');expression=$('#'+id+'-data').val();if(q.hasOwnProperty(expression)){if(!$this.is(':visible')&&!$this.hasClass('active')){toggleAdvanced(form);}
values=q[expression];if(values){$this.val(values[0]);}else{$this.val('');}}});form.find('.date-filter-input').each(function(){var $this=$(this),expression=$('#'+$this.attr('id')+'-data').val(),selector=expression.replace(FILTEROP,''),values=false;if(q.hasOwnProperty(expression)){values=q[expression];}else if(q.hasOwnProperty(selector)){values=q[selector];}
if(values!==false){if(!$this.is(':visible')&&!$this.hasClass('active')){toggleAdvanced(form);}
if(values){var dtString=values[0].replace(' ','T');$this.calendarWidget('setJSDate',new Date(dtString));}else{$this.calendarWidget('clear');}
$this.trigger('change');}});form.find('.location-filter').each(function(){$this=$(this);id=$this.attr('id');expression=$('#'+id+'-data').val();var operator=$('input:radio[name="'+id+'_filter"]:checked').val();if(this.tagName&&this.tagName.toLowerCase()=='select'){var refresh=false;if(q.hasOwnProperty(expression)){values=q[expression];refresh=true;}else
if(operator=='any'||operator=='all'){var selector=expression.replace(FILTEROP,'');if(q.hasOwnProperty(selector+'__anyof')){values=q[selector+'__anyof'];refresh=true;$('input:radio[name="'+id+'_filter"][value="any"]').prop('checked',true);}else if(q.hasOwnProperty(selector+'__contains')){values=q[selector+'__contains'];refresh=true;$('input:radio[name="'+id+'_filter"][value="all"]').prop('checked',true);}}
if(refresh){if(!$this.is(':visible')&&!$this.hasClass('active')){toggleAdvanced(form);}
$this.val(values);if($this.hasClass('groupedopts-filter-widget')&&$this.groupedopts('instance')){$this.groupedopts('refresh');}else
if($this.hasClass('multiselect-filter-widget')&&$this.multiselect('instance')){$this.multiselect('refresh');}
hierarchical_location_change(this);}}});form.find('.hierarchy-filter:visible').each(function(){$this=$(this);id=$this.attr('id');expression=$('#'+id+'-data').val();if(q.hasOwnProperty(expression)){if(!$this.is(':visible')&&!$this.hasClass('active')){toggleAdvanced(form);}
values=q[expression];if($this.hasClass('s3-cascade-select')){$this.cascadeSelect('set',values);}else{$this.hierarchicalopts('set',values);}}});form.data('noAutoSubmit',0);form.trigger('optionChanged');};S3.search.setCurrentFilters=setCurrentFilters;var updateFilterSubmitURL=function(form,name,value){var submit_url=$('#'+form).find('input.filter-submit-url[type="hidden"]');if(submit_url.length){submit_url=submit_url.first();var url=$(submit_url).val();var url_parts=url.split('?'),update_url,query,vars=[];if(url_parts.length>1){var qstr=url_parts[1];var a=qstr.split('&'),b,c;for(var i=0;i<a.length;i++){b=a[i].split('=');if(b.length>1){c=decodeURIComponent(b[0]);if(c!=name){vars.push(b[0]+'='+b[1]);}}}
vars.push(name+'='+value);query=vars.join('&');update_url=url_parts[0];if(query){update_url=update_url+'?'+query;}}else{update_url=url+'?'+name+'='+value;}
$(submit_url).val(update_url);}};var filterURL=function(url,queries){if(undefined===queries){queries=getCurrentFilters();}
var url_parts=url.split('?'),update={},reset={},i,len,q,k,v;for(i=0,len=queries.length;i<len;i++){q=queries[i];k=q[0];v=q[1];if(v===null){if(!update.hasOwnProperty(k)){reset[k]=true;}}else{if(reset.hasOwnProperty(k)){reset[k]=false;}
update[k]=true;}}
var query=[];if(S3.search.stripFilters==1){}else if(url_parts.length>1){var qstr=url_parts[1];var url_vars=qstr.split('&');for(i=0,len=url_vars.length;i<len;i++){q=url_vars[i].split('=');if(q.length>1){k=decodeURIComponent(q[0]);if(reset[k]||update[k]){continue;}else{query.push(url_vars[i]);}}}}
for(i=0,len=queries.length;i<len;i++){q=queries[i];k=q[0];v=q[1];if(update[k]){query.push(k+'='+encodeURIComponent(v));}}
var url_query=query.join('&'),filtered_url=url_parts[0];if(url_query){filtered_url=filtered_url+'?'+url_query;}
return filtered_url;};S3.search.filterURL=filterURL;var updateOptions=function(options){var filter_id;for(filter_id in options){var widget=$('#'+filter_id);if(widget.length){var newopts=options[filter_id];if(widget.hasClass('options-filter')){if(widget[0].tagName.toLowerCase()=='select'){var noopt=widget.siblings('.no-options-available');if(newopts.hasOwnProperty('empty')){widget.html('');if(widget.hasClass('multiselect-filter-widget')&&widget.multiselect('instance')){widget.multiselect('refresh');widget.multiselect('instance').button.hide();}else if(widget.hasClass('groupedopts-filter-widget')&&widget.groupedopts('instance')){widget.groupedopts('refresh');}else{widget.hide();}
if(noopt.length){noopt.html(newopts.empty);noopt.removeClass('hide').show();}}else{var selected=widget.val(),s=[],opts='',group,item,value,label,tooltip,i,len;if(newopts.hasOwnProperty('groups')){for(i=0,len=newopts.groups.length;i<len;i++){group=newopts.groups[i];if(group.label){opts+='<optgroup label="'+group.label+'">';}
for(var j=0,lenj=group.items.length;j<lenj;j++){item=group.items[j];value=item[0].toString();if(selected&&$.inArray(value,selected)>=0){s.push(value);}
opts+='<option value="'+value+'"';tooltip=item[3];if(tooltip){opts+=' title="'+tooltip+'"';}
label=item[1];opts+='>'+label+'</option>';}
if(group.label){opts+='</optgroup>';}}}else{for(i=0,len=newopts.length;i<len;i++){item=newopts[i];value=item[0];if(null===value){value='None';}else{value=value.toString();}
label=item[1];if(selected&&$.inArray(value,selected)>=0){s.push(value);}
opts+='<option value="'+value+'">'+label+'</option>';}}
widget.html(opts);if(s){widget.val(s);}
if(noopt.length){noopt.hide();}
if(widget.hasClass('groupedopts-filter-widget')&&widget.groupedopts('instance')){widget.groupedopts('refresh');}else if(widget.hasClass('multiselect-filter-widget')&&widget.multiselect('instance')){widget.multiselect('refresh');widget.multiselect('instance').button.show();}else{widget.removeClass('hide').show();}}}else{}}else if(widget.hasClass('date-filter')){var min=newopts.min,max=newopts.max;$('#'+filter_id+'-ge').calendarWidget('instance').option('minDateTime',min).option('maxDateTime',max).refresh();$('#'+filter_id+'-le').calendarWidget('instance').option('minDateTime',min).option('maxDateTime',max).refresh();widget.find('.range-picker').trigger('resize',[min,max,newopts.ts]);}else{}}}};S3.search.ajaxUpdateOptions=function(form,callback){var $form=$(form);var ajaxurl=$form.find('input.filter-ajax-url');if(ajaxurl.length){ajaxurl=$(ajaxurl[0]).val();}
$.ajax({'url':ajaxurl,'dataType':'json'}).done(function(data){$form.data('noAutoSubmit',1);updateOptions(data);$form.data('noAutoSubmit',0);if(callback){callback.apply();}}).fail(function(jqXHR,textStatus,errorThrown){var msg;if(errorThrown=='UNAUTHORIZED'){msg=i18n.gis_requires_login;}else{msg=jqXHR.responseText;}
console.log(msg);});};var updateFormatURLs=function(dt,queries){$('#'+dt[0].id).closest('.dt-wrapper').find('.dt-export').each(function(){var $this=$(this);var url=$this.data('url');if(url){$this.data('url',filterURL(url,queries));}});};var updatePendingTargets=function(form){var url=$('#'+form).find('input.filter-submit-url[type="hidden"]').first().val(),targets=pendingTargets[form],target_id,target_data,needs_reload,queries,t,visible;pendingTargets[form]={};for(target_id in targets){t=$('#'+target_id);if(!t.is(':visible')){visible=false;}else{visible=true;}
target_data=targets[target_id];needs_reload=target_data.needs_reload;if(visible){if(needs_reload){queries=getCurrentFilters($('#'+form));url=filterURL(url,queries);window.location.href=url;}}else{pendingTargets[form][target_id]=target_data;}}
for(target_id in targets){t=$('#'+target_id);if(!t.is(':visible')){continue;}
target_data=targets[target_id];t=$('#'+target_id);if(t.hasClass('dataTable')){var dt=t.dataTable(),dtAjaxURL=target_data.ajaxurl;dt.fnReloadAjax(dtAjaxURL);updateFormatURLs(dt,queries);$('#'+dt[0].id+'_dataTable_filterURL').val(dtAjaxURL);}else if(t.hasClass('dl')){t.datalist('ajaxReload',target_data.queries);}else if(t.hasClass('map_wrapper')){S3.gis.refreshLayer('search_results',target_data.queries);}else if(t.hasClass('gi-container')){t.groupedItems('reload',null,target_data.queries);}else if(t.hasClass('pt-container')){t.pivottable('reload',null,target_data.queries);}else if(t.hasClass('tp-container')){t.timeplot('reload',null,target_data.queries);}else if(t.hasClass('s3-organizer')){t.organizer('reload');}}};S3.search.filterFormAutoSubmit=function(form_id,timeout){var filter_form=$('#'+form_id);if(!filter_form.length||!timeout){return;}
filter_form.on('optionChanged',function(){var $this=$(this);if($this.data('noAutoSubmit')){return;}
var timer=$this.data('autoSubmitTimeout');if(timer){clearTimeout(timer);}
timer=setTimeout(function(){filterSubmit($this);},timeout);$this.data('autoSubmitTimeout',timer);});};var jsLoaded=function(){var dfd=new jQuery.Deferred();setTimeout(function working(){if(S3.gis.maps!=undefined){dfd.resolve('loaded');}else if(dfd.state()==='pending'){dfd.notify('waiting for JS to load...');setTimeout(working,500);}else{}},1);return dfd.promise();};var setup_hidden_widget=function(form,widget,queries){var ajaxurl;if(undefined===queries){queries=getCurrentFilters($('#'+form));}
if(!pendingTargets.hasOwnProperty(form)){pendingTargets[form]={};}
if(pendingTargets[form].hasOwnProperty(widget)){return;}
var t=$('#'+widget);if(t.hasClass('dl')||t.hasClass('gi-container')||t.hasClass('pt-container')||t.hasClass('tp-container')||t.hasClass('map_wrapper')||t.hasClass('s3-organizer')){ajaxurl=null;}else if(t.hasClass('dataTable')){var config=$('input#'+widget+'_configurations');if(config.length){var settings=JSON.parse($(config).val());ajaxurl=settings.ajaxUrl;if(typeof ajaxurl!='undefined'){ajaxurl=filterURL(ajaxurl,queries);}else{return;}}}else{return;}
pendingTargets[form][widget]={needs_reload:false,ajaxurl:ajaxurl,queries:queries};};S3.search.setup_hidden_widget=setup_hidden_widget;var recalcResponsive=function(datatable){var dt=$(datatable);if(dt.hasClass('responsive')){var instance=dt.DataTable();if(instance&&instance.responsive){instance.responsive.recalc();}}else if(dt.hasClass('doublescroll')){try{dt.dataTableS3('doubleScroll');}catch(e){}}};var unhide_section=function(form,section){var maps=section.find('.map_wrapper');var maps_len=maps.length;if(maps_len){$.when(jsLoaded()).then(function(){var gis=S3.gis;for(var i=0;i<maps_len;i++){var map_id=maps[i].attributes.id.value;if(undefined===gis.maps[map_id]){var options=gis.options[map_id];gis.show_map(map_id,options);}}
updatePendingTargets(form);},function(status){s3_debug(status);},function(status){s3_debug(status);});}else{updatePendingTargets(form);}
section.find('table.dataTable.display').each(function(){recalcResponsive(this);});};S3.search.unhide_section=unhide_section;S3.search.summary_tabs=function(form,active_tab,pending){if(pending){var queries=getCurrentFilters($('#'+form)),widget,targets=pending.split(',');for(var i=0,len=targets.length;i<len;i++){widget=targets[i];setup_hidden_widget(form,widget,queries);}}
if(active_tab!=undefined){$('#summary-tabs').tabs({active:active_tab,activate:function(event,ui){var newPanel=$(ui.newPanel);newPanel.removeClass('hide');if(ui.newTab.length){updateFilterSubmitURL(form,'t',$(ui.newTab).index());}
unhide_section(form,newPanel);}}).css({visibility:'visible'});$('.ui-tabs-panel[aria-hidden="false"]').first().removeClass('hide').find('table.dataTable.display').each(function(){recalcResponsive(this);});}else{$('#summary-tabs').css({visibility:'visible'}).find('table.dataTable.display').each(function(){recalcResponsive(this);});}};S3.search.summary_maps=function(form){var maps=$('#summary-common, #summary-sections').find('.map_wrapper');for(var i=0;i<maps.length;i++){var map=maps[i];if(!map.hidden){var gis=S3.gis;var map_id=map.attributes.id.value;if(undefined===gis.maps[map_id]){var options=gis.options[map_id];if(undefined!=options){gis.show_map(map_id,options);var queries=getCurrentFilters($('#'+form));gis.refreshLayer('search_results',queries);}}}}};S3.search.s3map=function(map_id){var gis=S3.gis;if(map_id===undefined){map_id='default_map';}
var options=gis.options[map_id];gis.show_map(map_id,options);var queries=getCurrentFilters();gis.refreshLayer('search_results',queries);};var hierarchical_location_change=function(widget){var name=widget.name,base=name.slice(0,-1),level=parseInt(name.slice(-1)),$widget=$('#'+name),values=$widget.val(),next_widget,select,l;if(!values){for(l=level+1;l<=5;l++){select=$('#'+base+l);if(select.length){select.html('');if(select.hasClass('groupedopts-filter-widget')&&select.groupedopts('instance')){try{select.groupedopts('refresh');}catch(e){}}else
if(select.hasClass('multiselect-filter-widget')&&select.multiselect('instance')){select.multiselect('refresh');}}}
next_widget=$widget.next('.ui-multiselect').next('.location-filter').next('.ui-multiselect');if(next_widget.length){next_widget.hide();next_widget=next_widget.next('.location-filter').next('.ui-multiselect');if(next_widget.length){next_widget.hide();next_widget=next_widget.next('.location-filter').next('.ui-multiselect');if(next_widget.length){next_widget.hide();next_widget=next_widget.next('.location-filter').next('.ui-multiselect');if(next_widget.length){next_widget.hide();next_widget=next_widget.next('.location-filter').next('.ui-multiselect');if(next_widget.length){next_widget.hide();}}}}}}else{var new_level=level+1,next=base+new_level,$next=$('#'+next);if(!$next.length){new_level=level+2;next=base+new_level;$next=$('#'+next);}
if(!$next.length){return;}
var fn=next.replace(/-/g,'_');S3[fn]();$next.next('.ui-multiselect').show();var hierarchy=S3.location_filter_hierarchy,location_name_l10n,translate;if(S3.location_name_l10n!=undefined){translate=true;location_name_l10n=S3.location_name_l10n;}else{translate=false;}
widget.options1=[];widget.options2=[];widget.options3=[];widget.options4=[];widget.options5=[];var hierarchy_level;for(hierarchy_level=level;hierarchy_level>=0;hierarchy_level--){if(hierarchy.hasOwnProperty('L'+hierarchy_level)){break;}}
var showSubOptions=function(thisHierarchy){var thisOpt,thatOpt,thatHierarchy;for(thisOpt in thisHierarchy){if(thisHierarchy.hasOwnProperty(thisOpt)){if(thisOpt&&thisOpt!='null'){widget['options'+new_level].push(thisOpt);}
thatHierarchy=thisHierarchy[thisOpt];if(typeof(thatHierarchy)==='object'){next=new_level+1;if(!$('#'+base+next).length){next=new_level+2;}
if($('#'+base+next).length){for(thatOpt in thatHierarchy){if(thatHierarchy.hasOwnProperty(thatOpt)){if(thatOpt&&thatOpt!='null'){widget['options'+next].push(thatOpt);}}}}}}}};var showOptions=function(thisHierarchy,thisLevel){var i,nextLevel,thisOpt,theseValues=$('#'+base+thisLevel).val();for(thisOpt in thisHierarchy){if(thisHierarchy.hasOwnProperty(thisOpt)){if(theseValues===null){if(thisLevel===level){showSubOptions(thisHierarchy[thisOpt]);}else{nextLevel=thisLevel+1;if(!$('#'+base+nextLevel).length){nextLevel++;}
showOptions(thisHierarchy[thisOpt],nextLevel);}}else{for(i in theseValues){if(theseValues[i]===thisOpt){if(thisLevel===level){showSubOptions(thisHierarchy[thisOpt]);}else{nextLevel=thisLevel+1;if(!$('#'+base+nextLevel).length){nextLevel++;}
showOptions(thisHierarchy[thisOpt],nextLevel);}}}}}}};var _hierarchy=hierarchy['L'+hierarchy_level];showOptions(_hierarchy,hierarchy_level);var name_l10n,options,htmlOptions;for(l=new_level;l<=5;l++){select=$('#'+base+l);if(select.length){options=widget['options'+l];options.sort();htmlOptions='';for(var i in options){if(options.hasOwnProperty(i)){name=options[i];if(translate){name_l10n=location_name_l10n[name]||name;}else{name_l10n=name;}
htmlOptions+='<option value="'+name+'">'+name_l10n+'</option>';}}
select.html(htmlOptions);if(select.hasClass('groupedopts-filter-widget')&&select.groupedopts('instance')){try{select.groupedopts('refresh');}catch(e){}}else
if(select.hasClass('multiselect-filter-widget')&&select.multiselect('instance')){select.multiselect('refresh');}
if(l===(new_level)){select.next('button').removeClass('hidden').show();next_widget=$widget.next('.ui-multiselect').next('.location-filter').next('.ui-multiselect');if(next_widget.length){next_widget=next_widget.next('.location-filter').next('.ui-multiselect');if(next_widget.length){next_widget.hide();next_widget=next_widget.next('.location-filter').next('.ui-multiselect');if(next_widget.length){next_widget.hide();next_widget=next_widget.next('.location-filter').next('.ui-multiselect');if(next_widget.length){next_widget.hide();next_widget=next_widget.next('.location-filter').next('.ui-multiselect');if(next_widget.length){next_widget.hide();}}}}}}}}}};var filterSubmit=function(filter_form){S3.hideAlerts('warning');var form_id=filter_form.attr('id'),url=filter_form.find('input.filter-submit-url[type="hidden"]').val(),queries=getCurrentFilters(filter_form);if(filter_form.hasClass('filter-ajax')){var target=filter_form.find('input.filter-submit-target[type="hidden"]').val();pendingTargets[form_id]={};var targets=target.split(' '),needs_reload,dt_ajaxurl={},ajaxurl,settings,config,i,t,target_id,visible;for(i=0;i<targets.length;i++){target_id=targets[i];t=$('#'+target_id);if(!t.is(':visible')){visible=false;}else{visible=true;}
needs_reload=false;ajaxurl=null;if(t.hasClass('dataTable')){config=$('input#'+targets[i]+'_configurations');if(config.length){settings=JSON.parse($(config).val());ajaxurl=settings.ajaxUrl;if(typeof ajaxurl!='undefined'){ajaxurl=filterURL(ajaxurl,queries);}else{ajaxurl=null;}}
if(ajaxurl){dt_ajaxurl[targets[i]]=ajaxurl;needs_reload=false;}else{needs_reload=true;}}else if(t.hasClass('dl')||t.hasClass('map_wrapper')||t.hasClass('cms_content')||t.hasClass('gi-container')||t.hasClass('pt-container')||t.hasClass('tp-container')||t.hasClass('s3-organizer')){needs_reload=false;}else{if(visible){url=filterURL(url,queries);window.location.href=url;}else{needs_reload=true;}}
if(!visible){pendingTargets[form_id][target_id]={needs_reload:needs_reload,ajaxurl:ajaxurl,queries:queries};}}
for(i=0;i<targets.length;i++){target_id=targets[i];t=$('#'+target_id);if(!t.is(':visible')){continue;}else if(t.hasClass('dataTable')){var dt=t.dataTable(),dtAjaxURL=dt_ajaxurl[target_id];dt.fnReloadAjax(dtAjaxURL);updateFormatURLs(dt,queries);$('#'+dt[0].id+'_dataTable_filterURL').val(dtAjaxURL);}else if(t.hasClass('dl')){t.datalist('ajaxReload',queries);}else if(t.hasClass('map_wrapper')){S3.gis.refreshLayer('search_results',queries);}else if(t.hasClass('gi-container')){t.groupedItems('reload',null,queries);}else if(t.hasClass('pt-container')){t.pivottable('reload',null,queries);}else if(t.hasClass('tp-container')){t.timeplot('reload',null,queries);}else if(t.hasClass('s3-organizer')){t.organizer('reload');}}}else{url=filterURL(url,queries);window.location.href=url;}};var toggleAdvanced=function(form){var $form=$(form),hidden;$form.find('.advanced').each(function(){var widget=$(this);var selectors='.multiselect-filter-widget,.groupedopts-filter-widget';if(widget.hasClass('hide')){widget.removeClass('hide').show().find(selectors).each(function(){var selector=$(this);selector.addClass('active');if(selector.hasClass('groupedopts-filter-widget')&&selector.groupedopts('instance')){selector.groupedopts('refresh');}else
if(selector.hasClass('multiselect-filter-widget')&&selector.multiselect('instance')){selector.multiselect('refresh');}});hidden=true;}else{widget.addClass('hide').hide().find(selectors).removeClass('active');hidden=false;}});var $btn=$($form.find('.filter-advanced-label'));if(hidden){$btn.text($btn.data('off')).siblings().toggle();}else{$btn.text($btn.data('on')).siblings().toggle();}};var dataChanged=function(targetID,callback){if(targetID){var target=$(this).find('input.filter-submit-target').val();if(target){var targets=target.split(' ');if(targets.length&&$.inArray(targetID+'',targets)!=-1){S3.search.ajaxUpdateOptions(this,callback);}}}};$(document).ready(function(){$('.groupedopts-filter-widget:visible,.multiselect-filter-widget:visible').addClass('active');$('.filter-clear').click(function(){var form=$(this).closest('.filter-form');clearFilters(form);});$('.show-filter-manager').click(function(){$('.filter-manager-row').removeClass('hide').show();$('.show-filter-manager').hide();});$('.filter-submit').click(function(){filterSubmit($(this).closest('.filter-form'));});$('.filter-form').on('dataChanged',function(e,targetID,callback){dataChanged.call(this,targetID,callback);return false;});$('.filter-advanced').on('click',function(){toggleAdvanced($(this).closest('form'));});$('.location-filter').on('change',function(){hierarchical_location_change(this);});$('.text-filter, .range-filter-input').on('input.autosubmit',function(){$(this).closest('form').trigger('optionChanged');});$('.options-filter, .location-filter, .date-filter-input, .age-filter-input, .map-filter, .value-filter').on('change.autosubmit',function(){$(this).closest('form').trigger('optionChanged');});$('.s3-options-filter-anyall input[type="radio"]').on('change.autosubmit',function(){$(this).closest('form').trigger('optionChanged');});$('.hierarchy-filter').on('select.s3hierarchy',function(){$(this).closest('form').trigger('optionChanged');});$('.map-filter').each(function(){var $this=$(this);$.when(jsLoaded()).then(function(){var widget_name=$this.attr('id'),widget=$('#'+widget_name),map_id=widget_name+'-map',wkt,gis=S3.gis,map=gis.maps[map_id],s3=map.s3;s3.pointPlaced=function(feature){var out_options={'internalProjection':map.getProjectionObject(),'externalProjection':gis.proj4326};wkt=new OpenLayers.Format.WKT(out_options).write(feature);widget.val('"'+wkt+'"').trigger('change');};s3.polygonButtonOff=function(){widget.val('').trigger('change');};s3.layerRefreshed=function(){var polygonButton=s3.polygonButton;if(polygonButton&&polygonButton.getIconClass()=='drawpolygonclear-off'){if(s3.lastDraftFeature){s3.lastDraftFeature.destroy();}else if(s3.draftLayer.features.length>1){s3.draftLayer.features[0].destroy();}
polygonButton.control.deactivate();polygonButton.items[0].pressed=true;}};s3.polygonButtonLoaded=function(){wkt=widget.val();if(wkt){s3.polygonButton.items[0].btnEl.dom.click();var geometry=OpenLayers.Geometry.fromWKT(wkt);geometry.transform(gis.proj4326,map.getProjectionObject());var feature=new OpenLayers.Feature.Vector(geometry,{},null);var draftLayer=s3.draftLayer;draftLayer.addFeatures([feature]);s3.lastDraftFeature=feature;map.zoomToExtent(draftLayer.getDataExtent());}};s3.polygonButtonLoaded();},function(status){s3_debug(status);},function(status){s3_debug(status);});});$('.date-filter').find('.range-picker').each(function(){var $this=$(this);var fmt=$this.data('fmt');var minValue=$this.data('min');var minDate;if(minValue){minDate=moment(minValue);}else{minDate=moment().subtract(5,'minutes');$this.data('min',minDate.format());}
var maxValue=$this.data('max'),maxDate;if(maxValue){maxDate=moment(maxValue);}else{maxDate=moment().subtract(5,'minutes');$this.data('max',maxDate.format());}
var widget_name=$this.parent().attr('id');var cfmt='MMM YYYY',year=minDate.format('YYYY'),optDate=moment(minDate),optgroups='',years=[{'year':year,'months':[]}],i=0,j,months,new_year;while(maxDate>optDate||optDate.format('M')===maxDate.format('M')){new_year=optDate.format('YYYY');if(new_year!=year){years.push({'year':new_year,'months':[]});year=new_year;i++;}
years[i].months.push(optDate.format(cfmt));optDate.add(1,'month');}
for(i=0;i<years.length;i++){year=years[i];months=year.months;year=year.year;optgroups+='<optgroup label="'+year+'">';for(j=0;j<months.length;j++){optgroups+='<option value="'+months[j]+'">'+months[j]+'</option>';}
optgroups+='</optgroup>';}
$this.before('<div class="range-coarse"><div class="range-coarse-start"><label for="'+widget_name+'-cs">From:</label><select id="'+widget_name+'-cs">'+optgroups+'</select></div><div class="range-coarse-end"><label for="'+widget_name+'-ce">to:</label><select id="'+widget_name+'-ce">'+optgroups+'</select></div></div>');var coarseStart=$('#'+widget_name+'-cs');var coarseEnd=$('#'+widget_name+'-ce');coarseStart.val(minDate.format(cfmt));coarseEnd.val(maxDate.format(cfmt));function slotsData(){var v,label,values=[],ts=$this.data('ts');for(var i=0;i<ts.length;i++){v=ts[i];label=moment(v[0]);values.push({x:label,y:v[1]});}
$this.data('slots',values);return[{values:values,key:'',color:'#3b6596',area:true},];}
slotsData();$this.before('<a class="button secondary tiny play"><i class="fa fa-play"></i> Play</a><a class="button secondary tiny hide pause"><i class="fa fa-pause"></i> Pause</a><a class="button secondary tiny hide stop"><i class="fa fa-stop"></i> Stop</a>');var play=$('#'+widget_name+' .play'),pause=$('#'+widget_name+' .pause'),stop=$('#'+widget_name+' .stop'),slots=$this.data('slots');if(slots.length<3){play.hide();}
var offset,timeOffset,currentDate;var rangePicker=$this.rangepicker({type:'double',startValue:minDate.format(fmt),endValue:maxDate.format(fmt),translateSelectLabel:function(currentPosition,totalPosition){minDate=new Date($this.data('min'));maxDate=new Date($this.data('max'));offset=maxDate-minDate;timeOffset=offset*(currentPosition/totalPosition);currentDate=new Date(+minDate+parseInt(timeOffset));return moment(currentDate).format(fmt);}});$this.before('<div id="'+widget_name+'-chart"><svg></svg></div>');var tooltipContent=function(data){var point=data.point;var tooltip='<div class="pt-tooltip">'+'<div class="pt-tooltip-label" style="color:'+point.color+'">'+point.x.format(fmt)+'</div>'+'<div class="pt-tooltip-text">'+point.y+'</div>'+'</div>';return tooltip;};rangePicker.graph=function(){nv.addGraph(function(){var chart=nv.models.lineChart().margin({left:0,right:0}).showLegend(false).showYAxis(false).showXAxis(false);chart.tooltip.contentGenerator(tooltipContent);var myData=slotsData();d3.select('#'+widget_name+'-chart svg').datum(myData).call(chart);nv.utils.windowResize(function(){chart.update();});return chart;});};rangePicker.graph();var startField=$('#'+widget_name+'-ge'),endField=$('#'+widget_name+'-le'),values,totalPosition,startValue,endValue,startDate,endDate;$this.on('update',function(){values=rangePicker.getSelectValue();totalPosition=values.totalWidth;startValue=values.start;endValue=values.end;minDate=new Date($this.data('min'));maxDate=new Date($this.data('max'));offset=maxDate-minDate;timeOffset=offset*(startValue/totalPosition);startDate=new Date(+minDate+parseInt(timeOffset));startField.val(moment(startDate).format(fmt));timeOffset=offset*(endValue/totalPosition);endDate=new Date(+minDate+parseInt(timeOffset));endField.val(moment(endDate).format(fmt));$this.closest('form').trigger('optionChanged');});coarseStart.on('change',function(){minDate=moment($(this).val(),cfmt);$this.data('min',minDate.format());startDate=minDate.format(fmt);rangePicker.refresh({'startValue':startDate});startField.val(startDate);$this.closest('form').trigger('optionChanged');});coarseEnd.on('change',function(){maxDate=moment($(this).val(),cfmt).endOf('month');$this.data('max',maxDate.format());endDate=maxDate.format(fmt);rangePicker.refresh({'endValue':endDate});endField.val(endDate);$this.closest('form').trigger('optionChanged');});function updatePosition(){startValue=startField.val();endValue=endField.val();minDate=new Date($this.data('min'));maxDate=new Date($this.data('max'));offset=maxDate-minDate;if(startValue){startDate=moment(startValue,fmt);timeOffset=startDate-minDate;startValue=((timeOffset/offset)*100)+'%';}else{startValue='0%';}
if(endValue){endDate=moment(endValue,fmt);timeOffset=endDate-minDate;endValue=((timeOffset/offset)*100)+'%';}else{endValue='100%';}
rangePicker.updatePosition(endValue,startValue);}
startField.on('change',function(){updatePosition();});endField.on('change',function(){updatePosition();});$this.on('clear',function(){rangePicker.updatePosition('100%','0%');});$this.on('resize',function(e,min,max,ts){$this.data('min',min);$this.data('max',max);rangePicker.refresh({'startValue':moment(min).format(fmt),'endValue':moment(max).format(fmt)});$this.data('ts',ts);rangePicker.graph();slots=$this.data('slots');if(slots.length>2){play.show();}else{play.hide();}});var slot_speed=4000,slot_wait=0,timers=[];function playSlot(slot){var start=slots[slot].x,end;try{end=slots[slot+1].x;}catch(e){end=moment($this.data('max'));}
var timeout=slot_wait;slot_wait=slot_wait+slot_speed;var timer=setTimeout(function(){setSlot(slot,start,end);},timeout);timers.push(timer);}
function setSlot(slot,start,end){$this.data('slot',slot);startField.val(start.format(fmt));endField.val(end.format(fmt));startField.trigger('change');}
$this.data('slot',0);play.on('click',function(){var slot=$this.data('slot');play.hide();pause.removeClass('hide').show();stop.removeClass('hide').show();slots=$this.data('slots');for(slot;slot<slots.length;slot++){playSlot(slot);}});pause.on('click',function(){for(var i=0;i<timers.length;i++){clearTimeout(timers.pop());}
slot_wait=0;pause.hide();play.show();});stop.on('click',function(){for(var i=0;i<timers.length;i++){clearTimeout(timers.pop());}
$this.data('slot',0);slot_wait=0;pause.hide();stop.hide();play.show();});});$('.text-filter').keypress(function(e){if(e.which==13){e.preventDefault();return false;}
return true;});});}());(function($,undefined){var filterManagerID=0;$.widget('s3.filtermanager',{options:{filters:{},ajaxURL:null,readOnly:false,explicitLoad:false,allowCreate:true,allowUpdate:true,allowDelete:true,createTooltip:null,loadTooltip:null,saveTooltip:null,deleteTooltip:null,selectHint:'Saved filters...',emptyHint:'No saved filters',titleHint:'Enter a title',confirmUpdate:null,confirmDelete:null,createText:null,loadText:null,saveText:null,deleteText:null,buttonClass:'action-btn'},_create:function(){this.id=filterManagerID++;},_init:function(){this.refresh();},_destroy:function(){},refresh:function(){var id=this.id,el=this.element.val(''),options=this.options;this._unbindEvents();var buttonClass=options.buttonClass;if(this.create_btn){this.create_btn.remove();}
if(options.createText){this.create_btn=$('<a class="fm-create '+buttonClass+'" id="fm-create-'+id+'">'+options.createText+'</a>');}else{this.create_btn=$('<div class="fm-create" id="fm-create-'+id+'">');}
if(options.createTooltip){this.create_btn.attr('title',options.createTooltip);}
if(this.load_btn){this.load_btn.remove();}
if(options.loadText){this.load_btn=$('<a class="fm-load '+buttonClass+'" id="fm-load-'+id+'">'+options.loadText+'</a>');}else{this.load_btn=$('<div class="fm-load" id="fm-load-'+id+'">');}
if(options.loadTooltip){this.load_btn.attr('title',options.loadTooltip);}
if(this.save_btn){this.save_btn.remove();}
if(options.saveText){this.save_btn=$('<a class="fm-save '+buttonClass+'" id="fm-save-'+id+'">'+options.saveText+'</a>');}else{this.save_btn=$('<div class="fm-save" id="fm-save-'+id+'">');}
if(options.saveTooltip){this.save_btn.attr('title',options.saveTooltip);}
if(this.delete_btn){this.delete_btn.remove();}
if(options.deleteText){this.delete_btn=$('<a class="fm-delete '+buttonClass+'" id="fm-delete-'+id+'">'+options.deleteText+'</a>');}else{this.delete_btn=$('<div class="fm-delete" id="fm-delete-'+id+'">');}
if(options.deleteTooltip){this.delete_btn.attr('title',options.deleteTooltip);}
if(this.throbber){this.throbber.remove();}
this.throbber=$('<div class="inline-throbber" id="fm-throbber-'+id+'">').css({'float':'left'});if(this.accept_btn){this.accept_btn.remove();}
this.accept_btn=$('<div class="fm-accept" id="fm-accept-'+id+'">');if(this.cancel_btn){this.cancel_btn.remove();}
this.cancel_btn=$('<div class="fm-cancel" id="fm-cancel-'+id+'">');$(el).after(this.load_btn.hide(),this.create_btn.hide(),this.save_btn.hide(),this.delete_btn.hide(),this.throbber.hide(),this.accept_btn.hide(),this.cancel_btn.hide());this._cancel();this._bindEvents();},_newFilter:function(){var el=this.element.hide(),fm=this;this._hideCRUDButtons();this.accept_btn.show();this.cancel_btn.show();var hint=this.options.titleHint;var input=$('<input type="text" id="fm-title-input-'+this.id+'">').val(hint).css({color:'grey','float':'left'}).focusin(function(){if(!$(this).hasClass('changed')){$(this).css({color:'black'}).val('');}}).change(function(){$(this).addClass('changed');}).focusout(function(){if($(this).val()===''){$(this).removeClass('changed').css({color:'grey'}).val(hint);}}).keypress(function(e){if(e.which==13){e.preventDefault();var $this=$(this);if($this.val()){$this.addClass('changed');}
fm._accept();}});this.input=input;$(el).after(input);},_accept:function(){var el=this.element,fm=this,title=this.input.val();if(!$(this.input).hasClass('changed')||!title){return;}else{$(this.input).removeClass('changed');}
this.accept_btn.hide();this.cancel_btn.hide();this.throbber.show();var filter={title:title,query:S3.search.getCurrentFilters($(el).closest('form')),url:this._getFilterURL()};$.ajaxS3({'url':this.options.ajaxURL,'type':'POST','dataType':'json','contentType':'application/json; charset=utf-8','data':JSON.stringify(filter),'success':function(data){var new_id=data.created;if(new_id){fm.options.filters[new_id]=filter.query;var new_opt=$('<option value="'+new_id+'">'+filter.title+'</option>');$(el).append(new_opt).val(new_id).change().prop('disabled',false);}
fm._cancel();},'error':function(){fm._cancel();}});},_save:function(){var el=this.element,fm=this,opts=this.options;var id=$(el).val();if(!id||opts.confirmUpdate&&!confirm(opts.confirmUpdate)){return;}
this._hideCRUDButtons();this.throbber.show();var filter={id:id,query:S3.search.getCurrentFilters($(el).closest('form')),url:this._getFilterURL()};$.ajaxS3({'url':this.options.ajaxURL,'type':'POST','dataType':'json','contentType':'application/json; charset=utf-8','data':JSON.stringify(filter),'success':function(){fm.options.filters[id]=filter.query;fm._cancel();},'error':function(){fm._cancel();}});},_delete:function(){var $el=$(this.element),opts=this.options;var id=$el.val();if(!id||opts.confirmDelete&&!confirm(opts.confirmDelete)){return;}
this._hideCRUDButtons();this.throbber.show();var filter={id:id};var url=''+this.options.ajaxURL;if(url.search(/.*\?.*/)!=-1){url+='&delete=1';}else{url+='?delete=1';}
var fm=this;$.ajaxS3({'url':url,'type':'POST','dataType':'json','contentType':'application/json; charset=utf-8','data':JSON.stringify(filter),'success':function(){$el.val('').find('option[value='+id+']').remove();delete fm.options.filters[id];fm._cancel();},'error':function(){fm._cancel();}});},_cancel:function(){this.throbber.hide();if(this.input){this.input.remove();this.input=null;}
this.accept_btn.hide();this.cancel_btn.hide();var el=this.element.show(),opts=this.options;var options=$(el).find('option');if(options.length==1&&options.first().hasClass('filter-manager-prompt')){$(el).prop('disabled',true);$(el).find('option.filter-manager-prompt').text(opts.emptyHint);}else{$(el).prop('disabled',false);$(el).find('option.filter-manager-prompt').text(opts.selectHint);}
this._showCRUDButtons();},_load:function(){var el=this.element,filters=this.options.filters;var filter_id=$(el).val();if(filter_id&&filters.hasOwnProperty(filter_id)){S3.search.setCurrentFilters($(el).closest('form'),filters[filter_id]);}else{}},clear:function(){var el=this.element;$(el).val('');this._cancel();},_showCRUDButtons:function(){var opts=this.options;this._hideCRUDButtons();if(!opts.readOnly&&opts.allowCreate){this.create_btn.show();}
if($(this.element).val()){if(opts.explicitLoad){this.load_btn.show();}
if(!opts.readOnly){if(opts.allowUpdate){this.save_btn.show();}
if(opts.allowDelete){this.delete_btn.show();}}}},_hideCRUDButtons:function(){this.create_btn.hide();this.load_btn.hide();this.delete_btn.hide();this.save_btn.hide();},_getFilterURL:function(){var url=$(this.element).closest('form').find('input.filter-submit-url[type="hidden"]');if(url.length){return url.first().val();}else{return document.URL;}},_bindEvents:function(){var fm=this;this.create_btn.click(function(){fm._newFilter();});this.accept_btn.click(function(){fm._accept();});this.cancel_btn.click(function(){fm._cancel();});this.element.change(function(){fm._showCRUDButtons();if(!fm.options.explicitLoad){fm._load();}});if(this.options.explicitLoad){this.load_btn.click(function(){fm._load();});}
this.save_btn.click(function(){fm._save();});this.delete_btn.click(function(){fm._delete();});},_unbindEvents:function(){if(this.create_btn){this.create_btn.unbind('click');}
if(this.accept_btn){this.accept_btn.unbind('click');}
if(this.cancel_btn){this.cancel_btn.unbind('click');}
if(this.load_btn&&this.options.explicitLoad){this.load_btn.unbind('click');}
if(this.save_btn){this.save_btn.unbind('click');}
if(this.delete_btn){this.delete_btn.unbind('click');}
this.element.unbind('change');}});})(jQuery);S3.supply=Object();S3.supply.fncPrepItem=function(data){for(var i=0;i<data.length;i++){if(data[i].quantity==1){return data[i].name;}}
return'';}
S3.supply.fncRepresentItem=function(record,PrepResult){if(record.quantity==1){return record.name;}else{return record.name+' ('+record.quantity+' x '+PrepResult+')';}}
$(document).ready(function(){var InvItemPackIDChange=function(){try{S3.JSONRequest[$(this).attr('id')].abort();}catch(err){}
$('#TotalQuantity').remove();if($('[name="inv_item_id"]').length>0){id=$('[name="inv_item_id"]').val();}else if($('[name="send_inv_item_id"]').length>0){id=$('[name="send_inv_item_id"]').val();}else{return;}
var url=S3.Ap.concat('/inv/inv_item_quantity.json/'+id);if($('#inv_quantity_throbber').length===0){$('[name="quantity"]').after('<div id="inv_quantity_throbber" class="throbber"/>');}
S3.JSONRequest[$(this).attr('id')]=$.getJSON(url,function(data){var InvQuantity=data.iquantity;var InvPackQuantity=data.pquantity;var PackName=$('[name="item_pack_id"] option:selected').text();var re=/\(([0-9]*)\sx/;var RegExpResult=re.exec(PackName);var PackQuantity;if(RegExpResult===null){PackQuantity=1;}else{PackQuantity=RegExpResult[1];}
var Quantity=(InvQuantity*InvPackQuantity)/PackQuantity;TotalQuantity='<span id="TotalQuantity"> / '+Quantity.toFixed(2)+' '+PackName+' ('+i18n.in_inv+')</span>';$('#inv_quantity_throbber').remove();$('[name="quantity"]').after(TotalQuantity);});}
var InvRecvTypeChange=function(){var RecvType=$("#inv_recv_type").val();if(RecvType!=undefined){if(RecvType==11){$('[id^="inv_recv_from_site_id__row"]').show();$('[id^="inv_recv_organisation_id__row"]').hide();}else if(RecvType>=32){$('[id^="inv_recv_from_site_id__row"]').hide();$('[id^="inv_recv_organisation_id__row"]').show();}else{$('[id^="inv_recv_from_site_id__row"]').hide();$('[id^="inv_recv_organisation_id__row"]').hide();}}}
$('#inv_track_item_item_pack_id').change(InvItemPackIDChange);InvRecvTypeChange();$('#inv_recv_type').change(InvRecvTypeChange);$(document).on('click','.quantity.ajax_more',function(e){e.preventDefault();var DIV=$(this);var ShipmentType;var App;if(DIV.hasClass('collapsed')){if(DIV.hasClass('fulfil')){App='inv';ShipmentType='recv';}else if(DIV.hasClass('transit')){ShipmentType='send';App='inv';}else if(DIV.hasClass('commit')){ShipmentType='commit';App='req';}
DIV.after('<div class="ajax_throbber quantity_req_ajax_throbber"/>').removeClass('collapsed').addClass('expanded');var UpdateURL=$('.action-btn',DIV.parent().parent().parent()).attr('href');var re=/req_item\/(\d*).*/i;var req_item_id=re.exec(UpdateURL)[1];var url=S3.Ap.concat('/',App,'/',ShipmentType,'_item_json.json/',req_item_id);$.ajax({url:url,dataType:'json',context:DIV}).done(function(data){RecvTable='<table class="recv_table">';for(i=0;i<data.length;i++){RecvTable+='<tr><td>';if(i===0){RecvTable+=data[0].id;}else{RecvURL=S3.Ap.concat('/',App,'/',ShipmentType,'/',data[i].id,'/track_item');RecvTable+="<a href='"+RecvURL+"'>";if(data[i].date!==null){RecvTable+=data[i].date.substring(0,10)+' - ';RecvTable+=data[i].name+'</a>';}else{RecvTable+=' - </a>';}}
RecvTable+='</td><td>'+data[i].quantity+'</td></tr>';}
RecvTable+='</table>';$('.quantity_req_ajax_throbber',this.parent()).remove();this.parent().after(RecvTable);});}else{DIV.removeClass('expanded').addClass('collapsed');$('.recv_table',DIV.parent().parent()).remove();}});});(function($,undefined){"use strict";var groupedoptsID=0;$.widget('s3.groupedopts',{options:{columns:3,emptyText:'No options available',orientation:'columns',sort:true,table:true,comment:''},_create:function(){var el=this.element.hide();this.id=groupedoptsID;groupedoptsID+=1;var multiple=el.attr('multiple');if(multiple!==undefined){this.multiple=true;}else{this.multiple=false;}
this.menu=null;},_init:function(){this.refresh();},_destroy:function(){this.menu.remove();this.element.show();},refresh:function(){var el=this.element,opts=this.options;this.index=0;this.name='s3-groupedopts-'+this.id;if(this.menu){this.menu.remove();}
this.selected=el.val();var groups=el.find('optgroup');if(!el.find('option').length){this.grouped=true;this.menu=$('<div class="s3-groupedopts-widget">'+'<span class="no-options-available">'+
opts.emptyText+'</span></div>');}else
if(groups.length){this.grouped=true;this.menu=$('<div class="s3-groupedopts-widget"/>');for(var i=0;i<groups.length;i++){this._renderGroup(groups[i]);}}else{this.grouped=false;if(opts.table){this.menu=$('<table class="s3-groupedopts-widget"/>');}else{this.menu=$('<div class="s3-groupedopts-widget"/>');}
var items=el.find('option');this._renderRows(items,this.menu);}
el.after(this.menu);this._bindEvents();},hide:function(){this.menu.hide();},show:function(){this.menu.show();},visible:function(){return this.menu.is(':visible');},_renderGroup:function(optgroup){var label=$(optgroup).attr('label'),items=$(optgroup).find('option');if(items.length){var group_label=$('<div class="s3-groupedopts-label">'+label+'</div>');this.menu.append(group_label);if(this.options.table){var group=$('<table class="s3-groupedopts-widget">');}else{var group=$('<div class="s3-groupedopts-widget">');}
this._renderRows(items,group);$(group).hide();this.menu.append(group);}},_renderRows:function(items,group){var opts=this.options,numcols=opts.columns,tail=$.makeArray(items);if(opts.sort){tail.sort(function(x,y){if($(x).text()<$(y).text()){return-1;}else{return 1;}});}
var rows=[],i,j;if(opts.orientation=='columns'){var numrows=Math.ceil(tail.length/numcols);for(i=0;i<numcols;i++){for(j=0;j<numrows;j++){if(tail.length){if(rows.length<j+1){rows.push([]);}
rows[j].push(tail.shift());}}}}else{while(tail.length){var row=[];for(i=0;i<numcols;i++){if(!tail.length){break;}
row.push(tail.shift());}
rows.push(row);}}
var table=opts.table;for(i=0;i<rows.length;i++){if(table){var tr=$('<tr/>');}else{var tr=$('<div class="s3-groupedopts-row"/>');}
for(j=0;j<rows[i].length;j++){this._renderItem(rows[i][j],tr,table);}
group.append(tr);}},_renderItem:function(item,row,table){var comment=this.options.comment,multiple=this.multiple;var $item=$(item),id='s3-groupedopts-option-'+this.id+'-'+this.index,type=multiple?'checkbox':'radio';this.index+=1;var value=$item.val(),label=$item.html(),title=$item.attr('title'),selected=this.selected;var olabel='<label for="'+id+'"';if(title&&title!==''){olabel+=' title="'+title+'"';}
if((!multiple)&&(value!=selected)){olabel+=' class="inactive"';}
olabel+='>'+label+'</label>';var oinput=$('<input '+'type="'+type+'" '+'id="'+id+'" '+'name="'+this.name+'" '+'class="s3-groupedopts-option" '+'value="'+value+'"/>'),pos;if(multiple){pos=$.inArray(value,selected);}else{pos=value==selected?1:-1;}
if(pos>=0){$(oinput).prop('checked',true);}
if(table){var widget=$('<td>').append(oinput).append($(olabel));}else{var widget=$('<div class="s3-groupedopts-item">').append(oinput).append($(olabel));}
if(comment){_.templateSettings={interpolate:/\{(.+?)\}/g};var template=_.template(comment);var ocomment=template({v:value});widget.append($(ocomment));}
row.append(widget);},_bindEvents:function(){var self=this;self.menu.find('.s3-groupedopts-option').click(function(){var $this=$(this);var value=$this.val(),el=self.element,multiple=self.multiple;var selected=el.val();if(selected===null&&multiple){selected=[];}
if(multiple){var pos=$.inArray(value,selected);if($this.is(':checked')){if(pos<0){selected.push(value);}}else{if(pos>=0){selected.splice(pos,1);}}}else{if($this.is(':checked')){selected=value;self.menu.find('.s3-groupedopts-option').each(function(){$this=$(this);if($this.is(':checked')){$this.next().removeClass('inactive');}else{$this.next().addClass('inactive');}});}}
this.selected=selected;el.val(selected).change();});self.menu.find('label[title]').cluetip({splitTitle:'|',showTitle:false});self.menu.find('.s3-groupedopts-label').click(function(){var div=$(this);div.next('table').toggle();div.toggleClass('expanded');});}});})(jQuery);(function($,undefined){"use strict";var inlinecomponentID=0;$.widget('s3.inlinecomponent',{options:{implicitCancelEdit:'ask',confirmCancelEdit:'Discard changes?'},_create:function(){this.id=inlinecomponentID;inlinecomponentID+=1;this.eventNamespace='.inlinecomponent';},_init:function(){var el=$(this.element);this.formname=el.attr('id').split('-').pop();this.input=$('#'+el.attr('field'));var layout=this._layout;if($.inlineComponentLayout){layout=$.inlineComponentLayout;}
this._renderReadRow=layout.renderReadRow;this._appendReadRow=layout.appendReadRow;this._appendError=layout.appendError;this._updateColumn=layout.updateColumn;this.refresh();},_destroy:function(){$.Widget.prototype.destroy.call(this);},refresh:function(){this._unbindEvents();this._openSingleRowSubforms();this._enforceRequired();this.labelRow=$('#sub-'+this.formname+' .label-row:not(.static)');if(!$(this.element).find('.inline-open-add').length){$('#add-row-'+this.formname+' .inline-dsc').hide();}
this._showHeaders();this._bindEvents();},_openSingleRowSubforms:function(){var el=$(this.element),self=this;el.find('.inline-form.read-row.single').each(function(){var names=$(this).attr('id').split('-'),rowindex=names.pop();self._editRow(rowindex);});el.find('.inline-form.add-row.single').each(function(){var $row=$(this),defaults=false;$row.find('input[type!="hidden"], select, textarea').each(function(){var $this=$(this),visible=$this.css('display')!='none';if(visible&&$this.val()&&$this.attr('type')!='checkbox'){defaults=true;}});if(defaults){self._markChanged($row);self._catchSubmit();}});},_enforceRequired:function(){var el=$(this.element),self=this;el.find('.inline-form.add-row.required').each(function(){self._markChanged(this);self._catchSubmit();});},_layout:{renderReadRow:function(formname,rowindex,items){var columns='';for(var i=0,len=items.length;i<len;i++){columns+='<td>'+items[i]+'</td>';}
if($('#edt-'+formname+'-none').length!==0){columns+='<td><div><div id="edt-'+formname+'-'+rowindex+'" class="inline-edt"></div></div></td>';}else{columns+='<td></td>';}
if($('#rmv-'+formname+'-none').length!==0){columns+='<td><div><div id="rmv-'+formname+'-'+rowindex+'" class="inline-rmv"></div></div></td>';}else{columns+='<td></td>';}
var rowID='read-row-'+formname+'-'+rowindex,row=$('#'+rowID);if(!row.length){row=$('<tr id="'+rowID+'" class="read-row">');}
row.empty().html(columns);return row;},appendReadRow:function(formname,row){$('#sub-'+formname+' > table.embeddedComponent > tbody').append(row);},appendError:function(formname,rowindex,fieldname,message){var errorClass=formname+'_error',target,msg='<div class="error">'+message+'</div>',colspan=function(t){var columns=$(t+'> td'),total=0;for(var i,len=columns.len,width;i<len;i++){width=columns[i].attr('colspan');if(width){total+=parseInt(width);}else{total+=1;}}
return total;},rowname=function(){if('none'==rowindex){return'#add-row-'+formname;}else{return'#edit-row-'+formname;}};if(null===fieldname){target=rowname();msg=$('<tr><td colspan="'+colspan(target)+'">'+msg+'</td></tr>');}else{target='#sub_'+formname+'_'+formname+'_i_'+fieldname+'_edit_'+rowindex;if($(target).is('[type="hidden"]')){target=rowname();msg='<tr><td colspan="'+colspan(target)+'">'+msg+'</td></tr>';}
msg=$(msg);}
msg.addClass(errorClass).hide().insertAfter(target);},updateColumn:function(row,colIndex,contents){$(row).find('td').eq(colIndex).html(contents);}},_markChanged:function(element){var subForm=$(element).closest('.inline-form');subForm.addClass('changed');if(subForm.hasClass('add-row')){subForm.find('.inline-dsc').show();}},_deserialize:function(){var input=this.input,data=JSON.parse(input.val());input.data('data',data);return data;},_serialize:function(){var input=this.input,json=JSON.stringify(input.data('data'));input.val(json);return json;},_displayErrors:function(){$('.'+this.formname+'_error').show();},_removeErrors:function(){$('.'+this.formname+'_error').remove();},_disableAddRow:function(){var addRow=$('#add-row-'+this.formname);addRow.find('input, select, textarea').prop('disabled',true);addRow.find('.inline-add, .action-lnk').hide();},_enableAddRow:function(){var addRow=$('#add-row-'+this.formname);addRow.find('input, select, textarea').prop('disabled',false);addRow.find('.inline-add, .action-lnk').removeClass('hide').show();},_showHeaders:function(){var labelRow=this.labelRow;if(labelRow&&labelRow.length){var formname=this.formname;var visibleReadRows=$('#sub-'+formname+' .read-row:visible');if(visibleReadRows.length){labelRow.show();}else{labelRow.hide();}}},_catchSubmit:function(){var form=$(this.element).closest('form'),ns=this.eventNamespace+this.id,self=this;var pendingValidations=form.data('pendingValidations');if(!pendingValidations){pendingValidations={};form.data('pendingValidations',pendingValidations);form.off('submit'+ns).on('submit'+ns,function(event){event.preventDefault();if(!self.submitInProgress){form.find('input[type="submit"]').prop('disabled',true);self.submitInProgress=true;form.trigger('validateInline');self._deferredSubmit(form);}});}
if(!pendingValidations[ns]){pendingValidations[ns]=$.Deferred();form.off('validateInline'+ns).on('validateInline'+ns,function(){self._validateAll();});}},_deferredSubmit:function(form){var pendingValidations=form.data('pendingValidations'),validations=[];for(var key in pendingValidations){validations.push(pendingValidations[key]);}
var ns=this.eventNamespace+this.id,self=this;$.when.apply(null,validations).then(function(){self.submitInProgress=false;form.off(ns).submit();},function(){self.submitInProgress=false;form.find('input[type="submit"]').prop('disabled',false);});},_collectData:function(data,rowindex,editIndex){var formname=this.formname,formRow,rows=data.data,row={},original=null;if(rowindex=='none'){formRow=$('#add-row-'+formname);}else{formRow=$('#edit-row-'+formname);var originalIndex=formRow.data('rowindex');if(typeof originalIndex!='undefined'){original=rows[originalIndex];}}
if(formRow.length){var event=new $.Event('validate');formRow.triggerHandler(event);if(event.isDefaultPrevented()){return null;}}
if(original!==null){var record_id=original._id;if(typeof record_id!='undefined'){row._id=record_id;}}
var fieldname,selector,input,value,cssClass,intvalue,fields=data.fields,upload_index;for(var i=0;i<fields.length;i++){fieldname=fields[i].name;selector='#sub_'+formname+'_'+formname+'_i_'+fieldname+'_edit_'+rowindex;input=$(selector);if(input.length){value=input.val();if(input.attr('type')=='file'){if(!value&&original){var dflag=$('#'+formname+'_i_'+fieldname+'_edit_'+rowindex+'__delete');if(!dflag.prop("checked")){value=original[fieldname].value;}}
input.clone().insertAfter(input);var add_button=$('#add-'+formname+'-none'),multiple=!!add_button.length;if(!multiple&&rowindex=='none'){upload_index='0';}else{upload_index=editIndex||rowindex;}
var upload_id='upload_'+formname+'_'+fieldname+'_'+upload_index;$('#'+upload_id).remove();var form=input.closest('form');input.css({display:'none'}).attr('id',upload_id).attr('name',upload_id).appendTo(form);if(value.match(/fakepath/)){value=value.replace(/(c:\\)*fakepath\\/i,'');}}else if(input.attr('type')=='checkbox'){value=input.prop('checked');}else if(input.hasClass('s3-hierarchy-input')){if(value){value=JSON.parse(value);}else{value=null;}}else{cssClass=input.attr('class');if(cssClass=='generic-widget'){intvalue=parseInt(value,10);if(!isNaN(intvalue)&&value==''+intvalue){value=intvalue;}}}}else{if(original!==null){value=original[fieldname].value;}else if(data.defaults&&(typeof(data.defaults[fieldname])!='undefined')){value=data.defaults[fieldname].value;}else{value='';}}
row[fieldname]=value;}
var single=$('#read-row-'+formname+'-'+rowindex).hasClass('single');if(single){var deleteRow=true;for(fieldname in row){if((fieldname!='_id')&&(row[fieldname]!=='')){deleteRow=false;break;}}
if(deleteRow){var required=$('#edit-row-'+formname).hasClass('required');if(required){this._appendError(formname,'0',fieldname,i18n.enter_value);row._error=true;}else{row._delete=true;}}else{delete row._error;}}else{var subformRequired=false;if($('#add-row-'+formname).hasClass('required')||$('#edit-row-'+formname).hasClass('required')){subformRequired=true;}
if(subformRequired){delete row._error;var empty=true;for(fieldname in row){if((fieldname!='_id')&&(row[fieldname]!=='')){empty=false;}}
if(empty){var errorIndex='none';if(rowindex!='none'){errorIndex='0';}
if($('#add-'+formname+'-'+rowindex).length){if(!$('#read-row-'+formname+'-0').length){this._appendError(formname,errorIndex,fieldname,i18n.enter_value);row._error=true;}}else{this._appendError(formname,errorIndex,fieldname,i18n.enter_value);row._error=true;}}}}
var defaults=data.defaults;for(fieldname in defaults){if(!row.hasOwnProperty(fieldname)){value=defaults[fieldname].value;row[fieldname]=value;}}
return row;},_validate:function(data,rowindex,row){var formname=this.formname,dfd=$.Deferred();if(row._error){this._displayErrors();return dfd.reject();}
var c=data.controller,f=data['function'],resource=data.resource,component=data.component,url=S3.Ap.concat('/'+c+'/'+f+'/validate.json'),concat;if(null!==resource&&typeof resource!='undefined'){url+='?resource='+resource;concat='&';}else{concat='?';}
if(null!==component&&typeof component!='undefined'){url+=concat+'component='+component;}
var rowJSON=JSON.stringify(row),self=this;$.ajaxS3({type:'POST',url:url,data:rowJSON,dataType:'json',contentType:'application/json; charset=utf-8',success:function(response){var hasErrors=false;if(!response){hasErrors=true;self._appendError(formname,rowindex,null,"validation failed");}else if(response.hasOwnProperty('_error')){hasErrors=true;self._appendError(formname,rowindex,null,response._error);}
var item,error;for(var field in response){item=response[field];if(item.hasOwnProperty('_error')){error=item._error;if(error=="invalid field"){item.text=item.value;}else{hasErrors=true;self._appendError(formname,rowindex,field,error);}}}
if(hasErrors){self._displayErrors();dfd.reject();}else{dfd.resolve(response);}}});return dfd.promise();},_updateUploadWidget:function(input,value){var pendingUpload=input.val(),widget=input.closest('.s3-upload-widget'),baseURL=widget.data('base'),fileURL;if(baseURL){fileURL=baseURL.concat('/',value);}else{fileURL=S3.Ap.concat('/default/download',value);}
widget.find('.s3-upload-link').each(function(){var $this=$(this),anchor=$this.find('a');if(value&&!pendingUpload){anchor.attr('href',fileURL);$this.removeClass('hide').show();}else{anchor.removeAttr('href');$this.hide();}});var isImage=false;if(value){var ext=value.substr(value.lastIndexOf('.')+1).toLowerCase();if(['gif','png','jpg','jpeg','bmp'].indexOf(ext)!=-1){isImage=true;}}
widget.find('.s3-upload-preview').each(function(){var $this=$(this),img=$this.find('img');if(isImage&&!pendingUpload){img.attr('src',fileURL);$this.removeClass('hide').show();}else{img.attr('src','');$this.hide();}});},_ensureSelectable:function(select,option){var checkOpts;if(option){if(option.constructor===Array){checkOpts=option;}else{checkOpts=[option];}}else{checkOpts=[];}
checkOpts.forEach(function(optValue){var optElement=select.find('option[value="'+optValue+'"]');if(!optElement.length){select.append('<option value="'+optValue+'">-</option>');}});},_editRow:function(rowindex){var opts=this.options,formname=this.formname,rowname=formname+'-'+rowindex;this._removeErrors();var data=this._deserialize(),row=data.data[rowindex];if(row._readonly){return;}
var editRow=$('#edit-row-'+formname),editIndex=editRow.data('rowindex');if(editIndex&&editRow.hasClass('changed')){var discard=false;switch(opts.implicitCancelEdit){case'refuse':break;case'submit':var self=this;this._updateRow(editIndex).then(function(){self._editRow(rowindex);});break;case'cancel':discard=true;break;default:if(confirm(opts.confirmCancelEdit)){discard=true;}
break;}
if(!discard){return;}}
$('#sub-'+formname+' .read-row').removeClass('hide').show();if(formname!='imageimage'){$('#read-row-'+rowname).hide();}
var fields=data.fields,fieldname,element,input,text,value,i;for(i=0;i<fields.length;i++){fieldname=fields[i].name;value=row[fieldname].value;element='#sub_'+formname+'_'+formname+'_i_'+fieldname+'_edit_0';var select=$('select'+element);if(select.length){this._ensureSelectable(select,value);}
input=$(element);if(!input.length){this._updateColumn($('#edit-row-'+formname),i,row[fieldname].text);}else{if(input.attr('type')=='file'){var upload=$('#upload_'+formname+'_'+fieldname+'_'+rowindex);if(upload.length){var id=input.attr('id');var name=input.attr('name');input.replaceWith(upload);upload.attr('id',id).attr('name',name).css({display:''});input=upload;}
this._updateUploadWidget(input,value);var dflag=$('#'+formname+'_i_'+fieldname+'_edit_0__delete');dflag.prop("checked",false);}else if(input.attr('type')=='checkbox'){input.prop('checked',value);}else{input.val(value);if(input.hasClass('multiselect-widget')&&input.multiselect('instance')){input.multiselect('refresh');}else if(input.hasClass('groupedopts-widget')&&input.groupedopts('instance')){input.groupedopts('refresh');}else if(input.hasClass('location-selector')&&input.locationselector('instance')){input.locationselector('refresh');}else if(input.hasClass('s3-hierarchy-input')){var parent=input.parent();if(parent.hierarchicalopts('instance')){if(value){value=JSON.parse(value);if(value.constructor!==Array){value=[value];}
parent.hierarchicalopts('set',value);}else{parent.hierarchicalopts('reset');}}}else if(S3.rtl&&input.hasClass('phone-widget')){if(value&&(value.charAt(0)!='\u200E')){input.val('\u200E'+value);}}else{element='#dummy_sub_'+formname+'_'+formname+'_i_'+fieldname+'_edit_0';text=row[fieldname].text;$(element).val(text);}}}}
editRow.data('rowindex',rowindex).insertAfter('#read-row-'+rowname).removeClass('hide').show();$('select:not(".lx-select")',editRow).change();this._disableAddRow();this._showHeaders();},_cancelEdit:function(rowindex){var formname=this.formname;var rowname=formname+'-'+rowindex;this._removeErrors();var edit_row=$('#edit-row-'+formname);edit_row.hide().data('rowindex',null).removeClass('changed');$('#read-row-'+rowname).removeClass('hide').show();this._enableAddRow();this._showHeaders();},_resetAddRow:function(){var self=this,data=this._deserialize(),formName=this.formname,formPrefix='sub_'+formName+'_'+formName+'_i_';this._removeErrors();var fields=data.fields,fieldName,fieldPrefix,defaultField,defaultValue,currentField,emptyWidget,container;var changeHandler=function(){self._markChanged(this);self._catchSubmit();};for(var i=fields.length;i--;){fieldName=fields[i].name;fieldPrefix=formPrefix+fieldName;defaultField=$('#'+fieldPrefix+'_edit_default');currentField=$('#'+fieldPrefix+'_edit_none');if(currentField.attr('type')=='file'){emptyWidget=defaultField.clone();emptyWidget.attr('id',currentField.attr('id')).attr('name',currentField.attr('name')).change(changeHandler);currentField.replaceWith(emptyWidget);}else{defaultValue=defaultField.val();currentField.val(defaultValue).change();if(currentField.attr('type')=='checkbox'){currentField.prop('checked',defaultField.prop('checked'));}else if(currentField.hasClass('multiselect-widget')&&currentField.multiselect('instance')){currentField.multiselect('refresh');}else if(currentField.hasClass('groupedopts-widget')&&currentField.groupedopts('instance')){currentField.groupedopts('refresh');}else if(currentField.hasClass('location-selector')&&currentField.locationselector('instance')){currentField.locationselector('refresh');}else if(currentField.hasClass('s3-hierarchy-input')){container=currentField.parent();if(container.hierarchicalopts('instance')){if(defaultValue){defaultValue=JSON.parse(defaultValue);if(defaultValue.constructor!==Array){defaultValue=[defaultValue];}
container.hierarchicalopts('set',defaultValue);}else{container.hierarchicalopts('reset');}}}}
defaultValue=$('#dummy_'+fieldPrefix+'_edit_default').val();$('#dummy_'+fieldPrefix+'_edit_none').val(defaultValue);}
var addRow=$('#add-row-'+formName);addRow.removeClass('changed');var explicitAdd=$(this.element).find('.inline-open-add');if(explicitAdd.length){addRow.hide();explicitAdd.show();}else{addRow.find('.inline-dsc').hide();}},_addRow:function(){var formName=this.formname,rowindex='none',throbber,add_button=$('#add-'+formName+'-'+rowindex),multiple;if(add_button.length){multiple=true;}else{multiple=false;}
if(multiple){add_button.hide();throbber=$('#throbber-'+formName+'-'+rowindex).removeClass('hide').show();this._removeErrors();}
var data=this._deserialize(),row_data=this._collectData(data,'none');if(null===row_data){if(multiple){throbber.hide();add_button.removeClass('hide').show();}
return $.Deferred().reject();}
var add_required=$('#add-row-'+formName).hasClass('required'),empty,fieldname;if(add_required){empty=true;for(fieldname in row_data){if((fieldname!='_id')&&(row_data[fieldname]!=='')){empty=false;}}
if(empty){if($('#add-'+formName+'-'+rowindex).length){if($('#read-row-'+formName+'-0').length){throbber.hide();add_button.removeClass('hide').show();return $.Deferred().resolve();}}}}
var validated=this._validate(data,rowindex,row_data),self=this;return validated.then(function(newRow){if(null!==newRow){newRow._changed=true;var newIndex=data.data.push(newRow)-1;newRow._index=newIndex;self._serialize();if(multiple){var items=[],fields=data.fields,fieldName,upload,uploadID;for(var i=0,len=fields.length;i<len;i++){fieldName=fields[i].name;upload=$('#upload_'+formName+'_'+fieldName+'_none');if(upload.length){uploadID='upload_'+formName+'_'+fieldName+'_'+newIndex;$('#'+uploadID).remove();upload.attr({'id':uploadID,'name':uploadID});}
items.push(newRow[fieldName].text);}
self._resetAddRow();var readRow=self._renderReadRow(formName,newIndex,items);self._appendReadRow(formName,readRow);self._showHeaders();}}
if(multiple){throbber.hide();add_button.removeClass('hide').show();}},function(){if(multiple){throbber.hide();add_button.removeClass('hide').show();}});},_updateRow:function(rowindex){var formname=this.formname,rdy_button=$('#rdy-'+formname+'-0'),multiple,throbber;if(rdy_button.length){multiple=true;}else{multiple=false;}
if(multiple){rdy_button.hide();throbber=$('#throbber-'+formname+'-0').removeClass('hide').show();this._removeErrors();}
var data=this._deserialize(),row_data=this._collectData(data,'0',rowindex);if(null===row_data){if(multiple){throbber.hide();rdy_button.removeClass('hide').show();}
return $.Deferred().reject();}
if(row_data._delete){data.data[rowindex]._delete=true;this._serialize();return $.Deferred().resolve();}else{var validated=this._validate(data,'0',row_data),self=this;return validated.then(function(new_row){if(null!==new_row){new_row._id=data.data[rowindex]._id;new_row._changed=true;new_row._index=rowindex;data.data[rowindex]=new_row;self._serialize();if(multiple){var items=[],fields=data.fields,default_value,i;var changeHandler=function(){self._markChanged(self);self._catchSubmit();};for(i=0;i<fields.length;i++){var field=fields[i].name;items.push(new_row[field].text);var d=$('#sub_'+formname+'_'+formname+'_i_'+field+'_edit_default'),f=$('#sub_'+formname+'_'+formname+'_i_'+field+'_edit_0');if(f.attr('type')=='file'){var emptyWidget=d.clone();emptyWidget.attr('id',f.attr('id')).attr('name',f.attr('name')).change(changeHandler);f.replaceWith(emptyWidget);}else{default_value=d.val();f.val(default_value);}
default_value=$('#dummy_sub_'+formname+'_'+formname+'_i_'+field+'_edit_default').val();$('#dummy_sub_'+formname+'_'+formname+'_i_'+field+'_edit_0').val(default_value);}
var edit_row=$('#edit-row-'+formname);edit_row.removeClass('changed');var read_row=self._renderReadRow(formname,rowindex,items);edit_row.hide().data('rowindex',null);read_row.removeClass('hide').show();self._enableAddRow();self._showHeaders();}}
if(multiple){throbber.hide();rdy_button.removeClass('hide').show();}},function(){if(multiple){throbber.hide();rdy_button.removeClass('hide').show();}});}},_removeRow:function(rowindex){var formname=this.formname;var rowname=formname+'-'+rowindex;if(!confirm(i18n.delete_confirmation)){return false;}
var data=this._deserialize();data.data[rowindex]._delete=true;this._serialize();$('#read-row-'+rowname).remove();this._showHeaders();$('input[name^="'+'upload_'+formname+'_"][name$="_'+rowindex+'"]').remove();var edit_row=$('#edit-row-'+formname);if(edit_row.hasClass('required')){if(!$('#read-row-'+formname+'-0').length){$('#add-row-'+formname).addClass('required');edit_row.removeClass('required');this._catchSubmit();}}
return true;},_validateAll:function(){var self=this,validations=[];$(self.element).find('.inline-form.changed, .inline-form.required').each(function(){var row=$(this),empty=true;if(row.hasClass('required')||row.hasClass('edit-row')){empty=false;}else{var inputs=row.find('input, select, textarea'),input,tokens,defaultInput;for(var i=inputs.length;i--;){input=$(inputs[i]);if(input.is('[type="hidden"]')){if(!input.data('input')){continue;}}else if(!input.is(':visible')){continue;}
if(input.prop('tagName')=='SELECT'&&!row.hasClass('single')){tokens=input.attr('id').split('_');tokens.pop();tokens.push('default');defaultInput=$('#'+tokens.join('_'));if(defaultInput.length&&defaultInput.val()==input.val()){continue;}}
if((input.attr('type')!='checkbox'&&input.val())||input.prop('checked')){empty=false;break;}}}
if(!empty){if(row.hasClass('add-row')){validations.push(self._addRow());}else{validations.push(self._updateRow(row.data('rowindex')));}}});var form=$(this.element).closest('form'),pendingValidations=form.data('pendingValidations'),ns=this.eventNamespace+this.id;$.when.apply(null,validations).then(function(){if(pendingValidations[ns]){pendingValidations[ns].resolve();delete pendingValidations[ns];}
form.off('validateInline'+ns);},function(){if(pendingValidations[ns]){pendingValidations[ns].reject();pendingValidations[ns]=$.Deferred();}});},_bindEvents:function(){var el=$(this.element),ns=this.eventNamespace,self=this;el.on('click'+ns,'.read-row',function(e){var target=e.target;if(!target||target.tagName!="A"||!target.href){var names=$(this).attr('id').split('-'),rowindex=names.pop();e.preventDefault();self._editRow(rowindex);return false;}}).on('click'+ns,'.inline-add',function(){self._addRow();return false;}).on('click'+ns,'.inline-dsc',function(){self._resetAddRow();return false;}).on('click'+ns,'.inline-cnc',function(){var names=$(this).attr('id').split('-');names.pop();var formname=names.pop(),rowindex=$('#edit-row-'+formname).data('rowindex');self._cancelEdit(rowindex);return false;}).on('click'+ns,'.inline-rdy',function(){var names=$(this).attr('id').split('-');names.pop();var formname=names.pop(),rowindex=$('#edit-row-'+formname).data('rowindex');self._updateRow(rowindex);return false;}).on('click'+ns,'.inline-edt',function(){var names=$(this).attr('id').split('-'),rowindex=names.pop();self._editRow(rowindex);return false;}).on('click'+ns,'.inline-rmv',function(){var names=$(this).attr('id').split('-'),rowindex=names.pop();self._removeRow(rowindex);return false;}).on('click'+ns,'.error',function(){$(this).fadeOut('medium',function(){$(this).remove();});return false;});var inputs='input',textInputs='input[type="text"],input[type="file"],textarea',fileInputs='input[type="file"]',dateInputs='input.s3-calendar-widget',otherInputs='input[type!="text"][type!="file"],select',multiSelects='select.multiselect-widget',hierarchyInputs='input.s3-hierarchy-input';el.find('.add-row,.edit-row').each(function(){var $this=$(this);$this.find('div.map_wrapper').on('change'+ns,function(){self._markChanged(this);self._catchSubmit();});$this.find(textInputs).on('input'+ns,function(){self._markChanged(this);self._catchSubmit();});$this.find(fileInputs).on('change'+ns,function(){self._markChanged(this);self._catchSubmit();});$this.find(dateInputs).on('change'+ns,function(){self._markChanged(this);self._catchSubmit();});$this.find(otherInputs).on('focusin'+ns,function(){$(this).one('change'+ns,function(){self._markChanged(this);self._catchSubmit();}).one('focusout',function(){$(this).off('change'+ns);});});$this.find(multiSelects).on('multiselectopen'+ns,function(){$(this).off('change'+ns).one('change'+ns,function(){self._markChanged(this);self._catchSubmit();});});$this.find(hierarchyInputs).on('change'+ns,function(){self._markChanged(this);self._catchSubmit();});$this.find(inputs).on('keypress'+ns,function(e){if(e.which==13){e.preventDefault();return false;}
return true;});});el.find('.add-row').each(function(){$(this).find(inputs).on('keyup'+ns,function(e){switch(e.which){case 13:self._addRow();break;default:break;}});});el.find('.edit-row').each(function(){$(this).find(inputs).on('keyup'+ns,function(e){var rowIndex=$(this).closest('.edit-row').data('rowindex');switch(e.which){case 13:self._updateRow(rowIndex);break;case 27:self._cancelEdit(rowIndex);break;default:break;}});});el.find('.inline-open-add').on('click'+ns,function(e){e.preventDefault();$('#add-row-'+self.formname).removeClass('hide').show();$(this).hide();});return true;},_unbindEvents:function(){var el=$(this.element),ns=this.eventNamespace;el.find('.inline-locationselector-widget').off(ns);el.find('.add-row,.edit-row').each(function(){$(this).find('input,textarea,select').off(ns);});el.find('.inline-open-add').off(ns);el.off(ns);return true;}});})(jQuery);$(document).ready(function(){$('.inline-component').inlinecomponent(S3.inlineComponentsOpts||{});});(function(factory){if(typeof define==="function"&&define.amd){define(["jquery","./core","./widget"],factory);}else{factory(jQuery);}}(function($){return $.widget("ui.accordion",{version:"@VERSION",options:{active:0,animate:{},collapsible:false,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var options=this.options;this.prevShow=this.prevHide=$();this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist");if(!options.collapsible&&(options.active===false||options.active==null)){options.active=0;}
this._processPanels();if(options.active<0){options.active+=this.headers.length;}
this._refresh();},_getCreateEventData:function(){return{header:this.active,panel:!this.active.length?$():this.active.next()};},_createIcons:function(){var icons=this.options.icons;if(icons){$("<span>").addClass("ui-accordion-header-icon ui-icon "+icons.header).prependTo(this.headers);this.active.children(".ui-accordion-header-icon").removeClass(icons.header).addClass(icons.activeHeader);this.headers.addClass("ui-accordion-icons");}},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove();},_destroy:function(){var contents;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default "+"ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId();this._destroyIcons();contents=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom "+"ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId();if(this.options.heightStyle!=="content"){contents.css("height","");}},_setOption:function(key,value){if(key==="active"){this._activate(value);return;}
if(key==="event"){if(this.options.event){this._off(this.headers,this.options.event);}
this._setupEvents(value);}
this._super(key,value);if(key==="collapsible"&&!value&&this.options.active===false){this._activate(0);}
if(key==="icons"){this._destroyIcons();if(value){this._createIcons();}}
if(key==="disabled"){this.element.toggleClass("ui-state-disabled",!!value).attr("aria-disabled",value);this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!value);}},_keydown:function(event){if(event.altKey||event.ctrlKey){return;}
var keyCode=$.ui.keyCode,length=this.headers.length,currentIndex=this.headers.index(event.target),toFocus=false;switch(event.keyCode){case keyCode.RIGHT:case keyCode.DOWN:toFocus=this.headers[(currentIndex+1)%length];break;case keyCode.LEFT:case keyCode.UP:toFocus=this.headers[(currentIndex-1+length)%length];break;case keyCode.SPACE:case keyCode.ENTER:this._eventHandler(event);break;case keyCode.HOME:toFocus=this.headers[0];break;case keyCode.END:toFocus=this.headers[length-1];break;}
if(toFocus){$(event.target).attr("tabIndex",-1);$(toFocus).attr("tabIndex",0);toFocus.focus();event.preventDefault();}},_panelKeyDown:function(event){if(event.keyCode===$.ui.keyCode.UP&&event.ctrlKey){$(event.currentTarget).prev().focus();}},refresh:function(){var options=this.options;this._processPanels();if((options.active===false&&options.collapsible===true)||!this.headers.length){options.active=false;this.active=$();}else if(options.active===false){this._activate(0);}else if(this.active.length&&!$.contains(this.element[0],this.active[0])){if(this.headers.length===this.headers.find(".ui-state-disabled").length){options.active=false;this.active=$();}else{this._activate(Math.max(0,options.active-1));}}else{options.active=this.headers.index(this.active);}
this._destroyIcons();this._refresh();},_processPanels:function(){var prevHeaders=this.headers,prevPanels=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all");this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide();if(prevPanels){this._off(prevHeaders.not(this.headers));this._off(prevPanels.not(this.panels));}},_refresh:function(){var maxHeight,options=this.options,heightStyle=options.heightStyle,parent=this.element.parent();this.active=this._findActive(options.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all");this.active.next().addClass("ui-accordion-content-active").show();this.headers.attr("role","tab").each(function(){var header=$(this),headerId=header.uniqueId().attr("id"),panel=header.next(),panelId=panel.uniqueId().attr("id");header.attr("aria-controls",panelId);panel.attr("aria-labelledby",headerId);}).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide();if(!this.active.length){this.headers.eq(0).attr("tabIndex",0);}else{this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"});}
this._createIcons();this._setupEvents(options.event);if(heightStyle==="fill"){maxHeight=parent.height();this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");if(position==="absolute"||position==="fixed"){return;}
maxHeight-=elem.outerHeight(true);});this.headers.each(function(){maxHeight-=$(this).outerHeight(true);});this.headers.next().each(function(){$(this).height(Math.max(0,maxHeight-
$(this).innerHeight()+$(this).height()));}).css("overflow","auto");}else if(heightStyle==="auto"){maxHeight=0;this.headers.next().each(function(){maxHeight=Math.max(maxHeight,$(this).css("height","").height());}).height(maxHeight);}},_activate:function(index){var active=this._findActive(index)[0];if(active===this.active[0]){return;}
active=active||this.active[0];this._eventHandler({target:active,currentTarget:active,preventDefault:$.noop});},_findActive:function(selector){return typeof selector==="number"?this.headers.eq(selector):$();},_setupEvents:function(event){var events={keydown:"_keydown"};if(event){$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler";});}
this._off(this.headers.add(this.headers.next()));this._on(this.headers,events);this._on(this.headers.next(),{keydown:"_panelKeyDown"});this._hoverable(this.headers);this._focusable(this.headers);},_eventHandler:function(event){var options=this.options,active=this.active,clicked=$(event.currentTarget),clickedIsActive=clicked[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():clicked.next(),toHide=active.next(),eventData={oldHeader:active,oldPanel:toHide,newHeader:collapsing?$():clicked,newPanel:toShow};event.preventDefault();if((clickedIsActive&&!options.collapsible)||(this._trigger("beforeActivate",event,eventData)===false)){return;}
options.active=collapsing?false:this.headers.index(clicked);this.active=clickedIsActive?$():clicked;this._toggle(eventData);active.removeClass("ui-accordion-header-active ui-state-active");if(options.icons){active.children(".ui-accordion-header-icon").removeClass(options.icons.activeHeader).addClass(options.icons.header);}
if(!clickedIsActive){clicked.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top");if(options.icons){clicked.children(".ui-accordion-header-icon").removeClass(options.icons.header).addClass(options.icons.activeHeader);}
clicked.next().addClass("ui-accordion-content-active");}},_toggle:function(data){var toShow=data.newPanel,toHide=this.prevShow.length?this.prevShow:data.oldPanel;this.prevShow.add(this.prevHide).stop(true,true);this.prevShow=toShow;this.prevHide=toHide;if(this.options.animate){this._animate(toShow,toHide,data);}else{toHide.hide();toShow.show();this._toggleComplete(data);}
toHide.attr({"aria-hidden":"true"});toHide.prev().attr("aria-selected","false");if(toShow.length&&toHide.length){toHide.prev().attr({"tabIndex":-1,"aria-expanded":"false"});}else if(toShow.length){this.headers.filter(function(){return $(this).attr("tabIndex")===0;}).attr("tabIndex",-1);}
toShow.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"});},_animate:function(toShow,toHide,data){var total,easing,duration,that=this,adjust=0,down=toShow.length&&(!toHide.length||(toShow.index()<toHide.index())),animate=this.options.animate||{},options=down&&animate.down||animate,complete=function(){that._toggleComplete(data);};if(typeof options==="number"){duration=options;}
if(typeof options==="string"){easing=options;}
easing=easing||options.easing||animate.easing;duration=duration||options.duration||animate.duration;if(!toHide.length){return toShow.animate(this.showProps,duration,easing,complete);}
if(!toShow.length){return toHide.animate(this.hideProps,duration,easing,complete);}
total=toShow.show().outerHeight();toHide.animate(this.hideProps,{duration:duration,easing:easing,step:function(now,fx){fx.now=Math.round(now);}});toShow.hide().animate(this.showProps,{duration:duration,easing:easing,complete:complete,step:function(now,fx){fx.now=Math.round(now);if(fx.prop!=="height"){adjust+=fx.now;}else if(that.options.heightStyle!=="content"){fx.now=Math.round(total-toHide.outerHeight()-adjust);adjust=0;}}});},_toggleComplete:function(data){var toHide=data.oldPanel;toHide.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all");if(toHide.length){toHide.parent()[0].className=toHide.parent()[0].className;}
this._trigger("activate",null,data);}});}));(function(factory){if(typeof define==="function"&&define.amd){define(["jquery","./core","./mouse","./widget"],factory);}else{factory(jQuery);}}(function($){return $.widget("ui.sortable",$.ui.mouse,{version:"@VERSION",widgetEventPrefix:"sort",ready:false,options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(x,reference,size){return(x>=reference)&&(x<(reference+size));},_isFloating:function(item){return(/left|right/).test(item.css("float"))||(/inline|table-cell/).test(item.css("display"));},_create:function(){var o=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?o.axis==="x"||this._isFloating(this.items[0].item):false;this.offset=this.element.offset();this._mouseInit();this._setHandleClassName();this.ready=true;},_setOption:function(key,value){this._super(key,value);if(key==="handle"){this._setHandleClassName();}},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle");$.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle");});},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle");this._mouseDestroy();for(var i=this.items.length-1;i>=0;i--){this.items[i].item.removeData(this.widgetName+"-item");}
return this;},_mouseCapture:function(event,overrideHandle){var currentItem=null,validHandle=false,that=this;if(this.reverting){return false;}
if(this.options.disabled||this.options.type==="static"){return false;}
this._refreshItems(event);$(event.target).parents().each(function(){if($.data(this,that.widgetName+"-item")===that){currentItem=$(this);return false;}});if($.data(event.target,that.widgetName+"-item")===that){currentItem=$(event.target);}
if(!currentItem){return false;}
if(this.options.handle&&!overrideHandle){$(this.options.handle,currentItem).find("*").addBack().each(function(){if(this===event.target){validHandle=true;}});if(!validHandle){return false;}}
this.currentItem=currentItem;this._removeCurrentsFromItems();return true;},_mouseStart:function(event,overrideHandle,noActivation){var i,body,o=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(event);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(event);this.originalPageX=event.pageX;this.originalPageY=event.pageY;(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!==this.currentItem[0]){this.currentItem.hide();}
this._createPlaceholder();if(o.containment){this._setContainment();}
if(o.cursor&&o.cursor!=="auto"){body=this.document.find("body");this.storedCursor=body.css("cursor");body.css("cursor",o.cursor);this.storedStylesheet=$("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(body);}
if(o.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity");}
this.helper.css("opacity",o.opacity);}
if(o.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex");}
this.helper.css("zIndex",o.zIndex);}
if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){this.overflowOffset=this.scrollParent.offset();}
this._trigger("start",event,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions();}
if(!noActivation){for(i=this.containers.length-1;i>=0;i--){this.containers[i]._trigger("activate",event,this._uiHash(this));}}
if($.ui.ddmanager){$.ui.ddmanager.current=this;}
if($.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event);}
this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(event);return true;},_mouseDrag:function(event){var i,item,itemElement,intersection,o=this.options,scrolled=false;this.position=this._generatePosition(event);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs;}
if(this.options.scroll){if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-event.pageY<o.scrollSensitivity){this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop+o.scrollSpeed;}else if(event.pageY-this.overflowOffset.top<o.scrollSensitivity){this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop-o.scrollSpeed;}
if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-event.pageX<o.scrollSensitivity){this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft+o.scrollSpeed;}else if(event.pageX-this.overflowOffset.left<o.scrollSensitivity){this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft-o.scrollSpeed;}}else{if(event.pageY-$(document).scrollTop()<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed);}else if($(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed);}
if(event.pageX-$(document).scrollLeft()<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed);}else if($(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed);}}
if(scrolled!==false&&$.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event);}}
this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px";}
if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px";}
for(i=this.items.length-1;i>=0;i--){item=this.items[i];itemElement=item.item[0];intersection=this._intersectsWithPointer(item);if(!intersection){continue;}
if(item.instance!==this.currentContainer){continue;}
if(itemElement!==this.currentItem[0]&&this.placeholder[intersection===1?"next":"prev"]()[0]!==itemElement&&!$.contains(this.placeholder[0],itemElement)&&(this.options.type==="semi-dynamic"?!$.contains(this.element[0],itemElement):true)){this.direction=intersection===1?"down":"up";if(this.options.tolerance==="pointer"||this._intersectsWithSides(item)){this._rearrange(event,item);}else{break;}
this._trigger("change",event,this._uiHash());break;}}
this._contactContainers(event);if($.ui.ddmanager){$.ui.ddmanager.drag(this,event);}
this._trigger("sort",event,this._uiHash());this.lastPositionAbs=this.positionAbs;return false;},_mouseStop:function(event,noPropagation){if(!event){return;}
if($.ui.ddmanager&&!this.options.dropBehaviour){$.ui.ddmanager.drop(this,event);}
if(this.options.revert){var that=this,cur=this.placeholder.offset(),axis=this.options.axis,animation={};if(!axis||axis==="x"){animation.left=cur.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft);}
if(!axis||axis==="y"){animation.top=cur.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop);}
this.reverting=true;$(this.helper).animate(animation,parseInt(this.options.revert,10)||500,function(){that._clear(event);});}else{this._clear(event,noPropagation);}
return false;},cancel:function(){if(this.dragging){this._mouseUp({target:null});if(this.options.helper==="original"){this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");}else{this.currentItem.show();}
for(var i=this.containers.length-1;i>=0;i--){this.containers[i]._trigger("deactivate",null,this._uiHash(this));if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",null,this._uiHash(this));this.containers[i].containerCache.over=0;}}}
if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0]);}
if(this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove();}
$.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){$(this.domPosition.prev).after(this.currentItem);}else{$(this.domPosition.parent).prepend(this.currentItem);}}
return this;},serialize:function(o){var items=this._getItemsAsjQuery(o&&o.connected),str=[];o=o||{};$(items).each(function(){var res=($(o.item||this).attr(o.attribute||"id")||"").match(o.expression||(/(.+)[\-=_](.+)/));if(res){str.push((o.key||res[1]+"[]")+"="+(o.key&&o.expression?res[1]:res[2]));}});if(!str.length&&o.key){str.push(o.key+"=");}
return str.join("&");},toArray:function(o){var items=this._getItemsAsjQuery(o&&o.connected),ret=[];o=o||{};items.each(function(){ret.push($(o.item||this).attr(o.attribute||"id")||"");});return ret;},_intersectsWith:function(item){var x1=this.positionAbs.left,x2=x1+this.helperProportions.width,y1=this.positionAbs.top,y2=y1+this.helperProportions.height,l=item.left,r=l+item.width,t=item.top,b=t+item.height,dyClick=this.offset.click.top,dxClick=this.offset.click.left,isOverElementHeight=(this.options.axis==="x")||((y1+dyClick)>t&&(y1+dyClick)<b),isOverElementWidth=(this.options.axis==="y")||((x1+dxClick)>l&&(x1+dxClick)<r),isOverElement=isOverElementHeight&&isOverElementWidth;if(this.options.tolerance==="pointer"||this.options.forcePointerForContainers||(this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>item[this.floating?"width":"height"])){return isOverElement;}else{return(l<x1+(this.helperProportions.width/2)&&x2-(this.helperProportions.width/2)<r&&t<y1+(this.helperProportions.height/2)&&y2-(this.helperProportions.height/2)<b);}},_intersectsWithPointer:function(item){var isOverElementHeight=(this.options.axis==="x")||this._isOverAxis(this.positionAbs.top+this.offset.click.top,item.top,item.height),isOverElementWidth=(this.options.axis==="y")||this._isOverAxis(this.positionAbs.left+this.offset.click.left,item.left,item.width),isOverElement=isOverElementHeight&&isOverElementWidth,verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();if(!isOverElement){return false;}
return this.floating?(((horizontalDirection&&horizontalDirection==="right")||verticalDirection==="down")?2:1):(verticalDirection&&(verticalDirection==="down"?2:1));},_intersectsWithSides:function(item){var isOverBottomHalf=this._isOverAxis(this.positionAbs.top+this.offset.click.top,item.top+(item.height/2),item.height),isOverRightHalf=this._isOverAxis(this.positionAbs.left+this.offset.click.left,item.left+(item.width/2),item.width),verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();if(this.floating&&horizontalDirection){return((horizontalDirection==="right"&&isOverRightHalf)||(horizontalDirection==="left"&&!isOverRightHalf));}else{return verticalDirection&&((verticalDirection==="down"&&isOverBottomHalf)||(verticalDirection==="up"&&!isOverBottomHalf));}},_getDragVerticalDirection:function(){var delta=this.positionAbs.top-this.lastPositionAbs.top;return delta!==0&&(delta>0?"down":"up");},_getDragHorizontalDirection:function(){var delta=this.positionAbs.left-this.lastPositionAbs.left;return delta!==0&&(delta>0?"right":"left");},refresh:function(event){this._refreshItems(event);this._setHandleClassName();this.refreshPositions();return this;},_connectWith:function(){var options=this.options;return options.connectWith.constructor===String?[options.connectWith]:options.connectWith;},_getItemsAsjQuery:function(connected){var i,j,cur,inst,items=[],queries=[],connectWith=this._connectWith();if(connectWith&&connected){for(i=connectWith.length-1;i>=0;i--){cur=$(connectWith[i]);for(j=cur.length-1;j>=0;j--){inst=$.data(cur[j],this.widgetFullName);if(inst&&inst!==this&&!inst.options.disabled){queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element):$(inst.options.items,inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),inst]);}}}}
queries.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);function addItems(){items.push(this);}
for(i=queries.length-1;i>=0;i--){queries[i][0].each(addItems);}
return $(items);},_removeCurrentsFromItems:function(){var list=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=$.grep(this.items,function(item){for(var j=0;j<list.length;j++){if(list[j]===item.item[0]){return false;}}
return true;});},_refreshItems:function(event){this.items=[];this.containers=[this];var i,j,cur,inst,targetData,_queries,item,queriesLength,items=this.items,queries=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],event,{item:this.currentItem}):$(this.options.items,this.element),this]],connectWith=this._connectWith();if(connectWith&&this.ready){for(i=connectWith.length-1;i>=0;i--){cur=$(connectWith[i]);for(j=cur.length-1;j>=0;j--){inst=$.data(cur[j],this.widgetFullName);if(inst&&inst!==this&&!inst.options.disabled){queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element[0],event,{item:this.currentItem}):$(inst.options.items,inst.element),inst]);this.containers.push(inst);}}}}
for(i=queries.length-1;i>=0;i--){targetData=queries[i][1];_queries=queries[i][0];for(j=0,queriesLength=_queries.length;j<queriesLength;j++){item=$(_queries[j]);item.data(this.widgetName+"-item",targetData);items.push({item:item,instance:targetData,width:0,height:0,left:0,top:0});}}},refreshPositions:function(fast){if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset();}
var i,item,t,p;for(i=this.items.length-1;i>=0;i--){item=this.items[i];if(item.instance!==this.currentContainer&&this.currentContainer&&item.item[0]!==this.currentItem[0]){continue;}
t=this.options.toleranceElement?$(this.options.toleranceElement,item.item):item.item;if(!fast){item.width=t.outerWidth();item.height=t.outerHeight();}
p=t.offset();item.left=p.left;item.top=p.top;}
if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this);}else{for(i=this.containers.length-1;i>=0;i--){p=this.containers[i].element.offset();this.containers[i].containerCache.left=p.left;this.containers[i].containerCache.top=p.top;this.containers[i].containerCache.width=this.containers[i].element.outerWidth();this.containers[i].containerCache.height=this.containers[i].element.outerHeight();}}
return this;},_createPlaceholder:function(that){that=that||this;var className,o=that.options;if(!o.placeholder||o.placeholder.constructor===String){className=o.placeholder;o.placeholder={element:function(){var nodeName=that.currentItem[0].nodeName.toLowerCase(),element=$("<"+nodeName+">",that.document[0]).addClass(className||that.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");if(nodeName==="tr"){that.currentItem.children().each(function(){$("<td>&#160;</td>",that.document[0]).attr("colspan",$(this).attr("colspan")||1).appendTo(element);});}else if(nodeName==="img"){element.attr("src",that.currentItem.attr("src"));}
if(!className){element.css("visibility","hidden");}
return element;},update:function(container,p){if(className&&!o.forcePlaceholderSize){return;}
if(!p.height()){p.height(that.currentItem.innerHeight()-parseInt(that.currentItem.css("paddingTop")||0,10)-parseInt(that.currentItem.css("paddingBottom")||0,10));}
if(!p.width()){p.width(that.currentItem.innerWidth()-parseInt(that.currentItem.css("paddingLeft")||0,10)-parseInt(that.currentItem.css("paddingRight")||0,10));}}};}
that.placeholder=$(o.placeholder.element.call(that.element,that.currentItem));that.currentItem.after(that.placeholder);o.placeholder.update(that,that.placeholder);},_contactContainers:function(event){var i,j,dist,itemWithLeastDistance,posProperty,sizeProperty,cur,nearBottom,floating,axis,innermostContainer=null,innermostIndex=null;for(i=this.containers.length-1;i>=0;i--){if($.contains(this.currentItem[0],this.containers[i].element[0])){continue;}
if(this._intersectsWith(this.containers[i].containerCache)){if(innermostContainer&&$.contains(this.containers[i].element[0],innermostContainer.element[0])){continue;}
innermostContainer=this.containers[i];innermostIndex=i;}else{if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",event,this._uiHash(this));this.containers[i].containerCache.over=0;}}}
if(!innermostContainer){return;}
if(this.containers.length===1){if(!this.containers[innermostIndex].containerCache.over){this.containers[innermostIndex]._trigger("over",event,this._uiHash(this));this.containers[innermostIndex].containerCache.over=1;}}else{dist=10000;itemWithLeastDistance=null;floating=innermostContainer.floating||this._isFloating(this.currentItem);posProperty=floating?"left":"top";sizeProperty=floating?"width":"height";axis=floating?"clientX":"clientY";for(j=this.items.length-1;j>=0;j--){if(!$.contains(this.containers[innermostIndex].element[0],this.items[j].item[0])){continue;}
if(this.items[j].item[0]===this.currentItem[0]){continue;}
cur=this.items[j].item.offset()[posProperty];nearBottom=false;if(event[axis]-cur>this.items[j][sizeProperty]/2){nearBottom=true;}
if(Math.abs(event[axis]-cur)<dist){dist=Math.abs(event[axis]-cur);itemWithLeastDistance=this.items[j];this.direction=nearBottom?"up":"down";}}
if(!itemWithLeastDistance&&!this.options.dropOnEmpty){return;}
if(this.currentContainer===this.containers[innermostIndex]){if(!this.currentContainer.containerCache.over){this.containers[innermostIndex]._trigger("over",event,this._uiHash());this.currentContainer.containerCache.over=1;}
return;}
itemWithLeastDistance?this._rearrange(event,itemWithLeastDistance,null,true):this._rearrange(event,null,this.containers[innermostIndex].element,true);this._trigger("change",event,this._uiHash());this.containers[innermostIndex]._trigger("change",event,this._uiHash(this));this.currentContainer=this.containers[innermostIndex];this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[innermostIndex]._trigger("over",event,this._uiHash(this));this.containers[innermostIndex].containerCache.over=1;}},_createHelper:function(event){var o=this.options,helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event,this.currentItem])):(o.helper==="clone"?this.currentItem.clone():this.currentItem);if(!helper.parents("body").length){$(o.appendTo!=="parent"?o.appendTo:this.currentItem[0].parentNode)[0].appendChild(helper[0]);}
if(helper[0]===this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")};}
if(!helper[0].style.width||o.forceHelperSize){helper.width(this.currentItem.width());}
if(!helper[0].style.height||o.forceHelperSize){helper.height(this.currentItem.height());}
return helper;},_adjustOffsetFromHelper:function(obj){if(typeof obj==="string"){obj=obj.split(" ");}
if($.isArray(obj)){obj={left:+obj[0],top:+obj[1]||0};}
if("left"in obj){this.offset.click.left=obj.left+this.margins.left;}
if("right"in obj){this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left;}
if("top"in obj){this.offset.click.top=obj.top+this.margins.top;}
if("bottom"in obj){this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top;}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var po=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])){po.left+=this.scrollParent.scrollLeft();po.top+=this.scrollParent.scrollTop();}
if(this.offsetParent[0]===document.body||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&$.ui.ie)){po={top:0,left:0};}
return{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)};},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var p=this.currentItem.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()};}else{return{top:0,left:0};}},_cacheMargins:function(){this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)};},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};},_setContainment:function(){var ce,co,over,o=this.options;if(o.containment==="parent"){o.containment=this.helper[0].parentNode;}
if(o.containment==="document"||o.containment==="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,$(o.containment==="document"?document:window).width()-this.helperProportions.width-this.margins.left,($(o.containment==="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];}
if(!(/^(document|window|parent)$/).test(o.containment)){ce=$(o.containment)[0];co=$(o.containment).offset();over=($(ce).css("overflow")!=="hidden");this.containment=[co.left+(parseInt($(ce).css("borderLeftWidth"),10)||0)+(parseInt($(ce).css("paddingLeft"),10)||0)-this.margins.left,co.top+(parseInt($(ce).css("borderTopWidth"),10)||0)+(parseInt($(ce).css("paddingTop"),10)||0)-this.margins.top,co.left+(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt($(ce).css("borderLeftWidth"),10)||0)-(parseInt($(ce).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,co.top+(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt($(ce).css("borderTopWidth"),10)||0)-(parseInt($(ce).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top];}},_convertPositionTo:function(d,pos){if(!pos){pos=this.position;}
var mod=d==="absolute"?1:-1,scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);return{top:(pos.top+
this.offset.relative.top*mod+
this.offset.parent.top*mod-
((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop()))*mod)),left:(pos.left+
this.offset.relative.left*mod+
this.offset.parent.left*mod-
((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())*mod))};},_generatePosition:function(event){var top,left,o=this.options,pageX=event.pageX,pageY=event.pageY,scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);if(this.cssPosition==="relative"&&!(this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0])){this.offset.relative=this._getRelativeOffset();}
if(this.originalPosition){if(this.containment){if(event.pageX-this.offset.click.left<this.containment[0]){pageX=this.containment[0]+this.offset.click.left;}
if(event.pageY-this.offset.click.top<this.containment[1]){pageY=this.containment[1]+this.offset.click.top;}
if(event.pageX-this.offset.click.left>this.containment[2]){pageX=this.containment[2]+this.offset.click.left;}
if(event.pageY-this.offset.click.top>this.containment[3]){pageY=this.containment[3]+this.offset.click.top;}}
if(o.grid){top=this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1];pageY=this.containment?((top-this.offset.click.top>=this.containment[1]&&top-this.offset.click.top<=this.containment[3])?top:((top-this.offset.click.top>=this.containment[1])?top-o.grid[1]:top+o.grid[1])):top;left=this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0];pageX=this.containment?((left-this.offset.click.left>=this.containment[0]&&left-this.offset.click.left<=this.containment[2])?left:((left-this.offset.click.left>=this.containment[0])?left-o.grid[0]:left+o.grid[0])):left;}}
return{top:(pageY-
this.offset.click.top-
this.offset.relative.top-
this.offset.parent.top+
((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop())))),left:(pageX-
this.offset.click.left-
this.offset.relative.left-
this.offset.parent.left+
((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())))};},_rearrange:function(event,i,a,hardRefresh){a?a[0].appendChild(this.placeholder[0]):i.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction==="down"?i.item[0]:i.item[0].nextSibling));this.counter=this.counter?++this.counter:1;var counter=this.counter;this._delay(function(){if(counter===this.counter){this.refreshPositions(!hardRefresh);}});},_clear:function(event,noPropagation){this.reverting=false;var i,delayedTriggers=[];if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem);}
this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(i in this._storedCSS){if(this._storedCSS[i]==="auto"||this._storedCSS[i]==="static"){this._storedCSS[i]="";}}
this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");}else{this.currentItem.show();}
if(this.fromOutside&&!noPropagation){delayedTriggers.push(function(event){this._trigger("receive",event,this._uiHash(this.fromOutside));});}
if((this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!noPropagation){delayedTriggers.push(function(event){this._trigger("update",event,this._uiHash());});}
if(this!==this.currentContainer){if(!noPropagation){delayedTriggers.push(function(event){this._trigger("remove",event,this._uiHash());});delayedTriggers.push((function(c){return function(event){c._trigger("receive",event,this._uiHash(this));};}).call(this,this.currentContainer));delayedTriggers.push((function(c){return function(event){c._trigger("update",event,this._uiHash(this));};}).call(this,this.currentContainer));}}
function delayEvent(type,instance,container){return function(event){container._trigger(type,event,instance._uiHash(instance));};}
for(i=this.containers.length-1;i>=0;i--){if(!noPropagation){delayedTriggers.push(delayEvent("deactivate",this,this.containers[i]));}
if(this.containers[i].containerCache.over){delayedTriggers.push(delayEvent("out",this,this.containers[i]));this.containers[i].containerCache.over=0;}}
if(this.storedCursor){this.document.find("body").css("cursor",this.storedCursor);this.storedStylesheet.remove();}
if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity);}
if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex);}
this.dragging=false;if(!noPropagation){this._trigger("beforeStop",event,this._uiHash());}
this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(!this.cancelHelperRemoval){if(this.helper[0]!==this.currentItem[0]){this.helper.remove();}
this.helper=null;}
if(!noPropagation){for(i=0;i<delayedTriggers.length;i++){delayedTriggers[i].call(this,event);}
this._trigger("stop",event,this._uiHash());}
this.fromOutside=false;return!this.cancelHelperRemoval;},_trigger:function(){if($.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel();}},_uiHash:function(_inst){var inst=_inst||this;return{helper:inst.helper,placeholder:inst.placeholder||$([]),position:inst.position,originalPosition:inst.originalPosition,offset:inst.positionAbs,item:inst.currentItem,sender:_inst?_inst.element:null};}});}));(function($,undefined){String.prototype.reverse=function(){return this.split('').reverse().join('');};var web2py;$.web2py=web2py={popup:function(url){newwindow=window.open(url,'name','height=400,width=600');if(window.focus)newwindow.focus();return false;},collapse:function(id){$('#'+id).slideToggle();},fade:function(id,value){if(value>0)$('#'+id).hide().fadeIn('slow');else $('#'+id).show().fadeOut('slow');},ajax:function(u,s,t){query='';if(typeof s=='string'){d=$(s).serialize();if(d){query=d;}}else{pcs=[];if(s!=null&&s!=undefined)for(i=0;i<s.length;i++){q=$('[name='+s[i]+']').serialize();if(q){pcs.push(q);}}
if(pcs.length>0){query=pcs.join('&');}}
$.ajax({type:'POST',url:u,data:query,success:function(msg){if(t){if(t==':eval')eval(msg);else if(typeof t=='string')$('#'+t).html(msg);else t(msg);}}});},ajax_fields:function(target){$('button',target).addClass('btn');$('form input[type="submit"], form input[type="button"]',target).addClass('btn');$('input[type=password][data-w2p_entropy]',target).each(function(){web2py.validate_entropy($(this));});$('ul.w2p_list',target).each(function(){function pe(ul,e){var new_line=ml(ul);rel(ul);if($(e.target).parent().is(':visible')){new_line.insertAfter($(e.target).parent());}else{new_line.appendTo(ul);}
new_line.find(":text").focus();return false;}
function rl(ul,e){if($(ul).children().length>1){$(e.target).parent().remove();}}
function ml(ul){var line=$(ul).find('li:first').clone(true);line.find(':text').val('');return line;}
function rel(ul){$(ul).find('li').each(function(){var trimmed=$.trim($(this.firstChild).val());if(trimmed=='')$(this).remove();else $(this.firstChild).val(trimmed);});}
var ul=this;$(ul).find(':text').after('<a href="#">+</a>&nbsp;<a href="#">-</a>').keypress(function(e){return(e.which==13)?pe(ul,e):true;}).next().click(function(e){pe(ul,e);e.preventDefault();}).next().click(function(e){rl(ul,e);e.preventDefault();});});},ajax_init:function(target){$('.hidden',target).hide();web2py.manage_errors(target);web2py.ajax_fields(target);web2py.show_if_handler(target);web2py.component_handler(target);},manage_errors:function(target){$('.error',target).hide().slideDown('slow');},event_handlers:function(){var doc=$(document);doc.on('click','.flash',function(e){var t=$(this);if(t.css('top')=='0px')t.slideUp('slow');else t.fadeOut();});doc.on('keyup','input.integer',function(){this.value=this.value.reverse().replace(/[^0-9\-]|\-(?=.)/g,'').reverse();});doc.on('keyup','input.double, input.decimal',function(){this.value=this.value.reverse().replace(/[^0-9\-\.,]|[\-](?=.)|[\.,](?=[0-9]*[\.,])/g,'').reverse();});var confirm_message=(typeof w2p_ajax_confirm_message!='undefined')?w2p_ajax_confirm_message:"Are you sure you want to delete this object?";doc.on('click',"input[type='checkbox'].delete",function(){if(this.checked)if(!web2py.confirm(confirm_message))this.checked=false;});doc.ajaxSuccess(function(e,xhr){var redirect=xhr.getResponseHeader('web2py-redirect-location');var command=xhr.getResponseHeader('web2py-component-command');var flash=xhr.getResponseHeader('web2py-component-flash');if(redirect!==null){window.location=redirect;};if(command!==null){eval(decodeURIComponent(command));}
if(flash){web2py.flash(decodeURIComponent(flash))}});doc.ajaxError(function(e,xhr,settings,exception){switch(xhr.status){case 500:web2py.flash(i18n.ajax_500);}});},trap_form:function(action,target){$('#'+target+' form').each(function(i){var form=$(this);form.attr('data-w2p_target',target);if(!form.hasClass('no_trap')){form.find('input[type=submit]').attr('data-w2p_disable_with','Working...');form.submit(function(e){web2py.hide_flash();web2py.ajax_page('post',action,form.serialize(),target,form);e.preventDefault();});}});},trap_link:function(target){$('#'+target+' a.w2p_trap').each(function(i){var link=$(this);link.click(function(e){web2py.hide_flash();web2py.ajax_page('get',link.attr('href'),[],target);e.preventDefault();});});},ajax_page:function(method,action,data,target,element){if(element==undefined)element=$(document);if(web2py.fire(element,'ajax:before')){$.ajax({'type':method,'url':action,'data':data,'beforeSend':function(xhr,settings){xhr.setRequestHeader('web2py-component-location',document.location);xhr.setRequestHeader('web2py-component-element',target);return web2py.fire(element,'ajax:beforeSend',[xhr,settings]);},'success':function(data,status,xhr){element.trigger('ajax:success',[data,status,xhr]);},'error':function(xhr,status,error){element.trigger('ajax:error',[xhr,status,error]);},'complete':function(xhr,status){element.trigger('ajax:complete',[xhr,status]);var html=xhr.responseText;var content=xhr.getResponseHeader('web2py-component-content');var t=$('#'+target);if(content=='prepend')t.prepend(html);else if(content=='append')t.append(html);else if(content!='hide')t.html(html);web2py.trap_form(action,target);web2py.trap_link(target);web2py.ajax_init('#'+target);}});}},component:function(action,target,timeout,times,el){$(function(){var jelement=$("#"+target);var element=jelement.get(0);var statement="jQuery('#"+target+"').get(0).reload();";element.reload=function(){if(element.reload_check()){web2py.ajax_page('get',action,null,target,el);}};element.reload_check=function(){if(jelement.hasClass('w2p_component_stop')){clearInterval(this.timing);return false;}
if(this.reload_counter==Infinity){return true;}else{if(!isNaN(this.reload_counter)){this.reload_counter-=1;if(this.reload_counter<0){if(!this.run_once){clearInterval(this.timing);return false;}}else{return true;}}}
return false;};if(!isNaN(timeout)){element.timeout=timeout;element.reload_counter=times;if(times>1){web2py.ajax_page('get',action,null,target,el);element.run_once=false;element.timing=setInterval(statement,timeout);element.reload_counter-=1;}else if(times==1){element.run_once=true;element.setTimeout=setTimeout;element.timing=setTimeout(statement,timeout);}}else{element.reload_counter=Infinity;web2py.ajax_page('get',action,null,target,el);}});},calc_entropy:function(mystring){var csets=new Array('abcdefghijklmnopqrstuvwxyz','ABCDEFGHIJKLMNOPQRSTUVWXYZ','0123456789','!@#$\%^&*()','~`-_=+[]{}\|;:\'",.<>?/','0123456789abcdefghijklmnopqrstuvwxyz');var score=0,other={},seen={},lastset=null,mystringlist=mystring.split('');for(var i=0;i<mystringlist.length;i++){var c=mystringlist[i],inset=5;for(var j=0;j<csets.length;j++)
if(csets[j].indexOf(c)!=-1){inset=j;break;}
if(!(inset in seen)){seen[inset]=1;score+=csets[inset].length;}else if(!(c in other)){score+=1;other[c]=1;}
if(inset!=lastset){score+=1;lastset=inset;}}
var entropy=mystring.length*Math.log(score)/0.6931471805599453;return Math.round(entropy*100)/100},validate_entropy:function(myfield,req_entropy){if(myfield.data('w2p_entropy')!=undefined)req_entropy=myfield.data('w2p_entropy');var validator=function(){var v=(web2py.calc_entropy(myfield.val())||0)/req_entropy;var r=0,g=0,b=0,rs=function(x){return Math.round(x*15).toString(16)};if(v<=0.5){r=1.0;g=2.0*v;}else{r=(1.0-2.0*(Math.max(v,0)-0.5));g=1.0;}
var color='#'+rs(r)+rs(g)+rs(b);myfield.css('background-color',color);entropy_callback=myfield.data('entropy_callback');if(entropy_callback)entropy_callback(v);}
if(!myfield.hasClass('entropy_check'))myfield.on('keyup',validator).on('keydown',validator).addClass('entropy_check');},web2py_websocket:function(url,onmessage,onopen,onclose){if("WebSocket"in window){var ws=new WebSocket(url);ws.onopen=onopen?onopen:(function(){});ws.onmessage=onmessage;ws.onclose=onclose?onclose:(function(){});return true;}else return false;},formInputClickSelector:'input[type=submit], input[type=image], button[type=submit], button:not([type])',disableSelector:'input, button, textarea, select',enableSelector:'input:disabled, button:disabled, textarea:disabled, select:disabled',fire:function(obj,name,data){var event=$.Event(name);obj.trigger(event,data);return event.result!==false;},stopEverything:function(e){$(e.target).trigger('w2p:everythingStopped');e.stopImmediatePropagation();return false;},confirm:function(message){return confirm(message);},disableElement:function(el){el.addClass('disabled');var method=el.prop('type')=='submit'?'val':'html';el.data('w2p:enable-with',el[method]);if((el.data('w2p_disable_with')=='default')||(el.data('w2p_disable_with')===undefined)){el.data('w2p_disable_with','Working...');}
el[method](el.data('w2p_disable_with'));el.bind('click.w2pDisable',function(e){return web2py.stopEverything(e);});},enableElement:function(el){var method=el.prop('type')=='submit'?'val':'html';if(el.data('w2p:enable-with')!==undefined){el[method](el.data('w2p:enable-with'));el.removeData('w2p:enable-with');}
el.removeClass('disabled');el.unbind('click.w2pDisable');},simple_component:function(action,target,element){web2py.component(action,target,0,1,element);},flash:function(message,status){var flash=$('.flash');web2py.hide_flash();flash.html(message).addClass(status);if(flash.html())flash.append('<span id="closeflash"> &times; </span>').slideDown();},hide_flash:function(){$('.flash').hide().html('');},show_if_handler:function(target){var triggers={};var show_if=function(){var t=$(this);var id=t.attr('id');t.attr('value',t.val());for(var k=0;k<triggers[id].length;k++){var dep=$('#'+triggers[id][k],target);var tr=$('#'+triggers[id][k]+'__row',target);if(t.is(dep.attr('data-show-if')))tr.slideDown();else tr.hide();}};$('[data-show-trigger]',target).each(function(){var name=$(this).attr('data-show-trigger');if(!triggers[name])triggers[name]=[];triggers[name].push($(this).attr('id'));});for(var name in triggers){$('#'+name,target).change(show_if).keyup(show_if);show_if.call($('#'+name,target));};},component_handler:function(target){$('div[data-w2p_remote]',target).each(function(){var remote,times,timeout,target;var el=$(this);remote=el.data('w2p_remote');times=el.data('w2p_times');timeout=el.data('w2p_timeout');target=el.attr('id');web2py.component(remote,target,timeout,times,$(this));});},a_handler:function(el,e){e.preventDefault();var method=el.data('w2p_method');var action=el.attr('href');var target=el.data('w2p_target');var confirm_message=el.data('w2p_confirm');var pre_call=el.data('w2p_pre_call');if(pre_call!=undefined){eval(pre_call);}
if(confirm_message!=undefined){if(confirm_message=='default')confirm_message=i18n.delete_confirmation;if(!web2py.confirm(confirm_message)){web2py.stopEverything(e);return;}}
if(target==undefined){if(method=='GET'){web2py.simple_component(action,el.attr('id'),el);}else if(method=='POST'){web2py.ajax_page('post',action,[],'bogus',el);}}else{if(method=='GET'){web2py.simple_component(action,target,el);}else if(method=='POST'){web2py.ajax_page('post',action,[],target,el);}}},a_handlers:function(){var el=$(document);el.on('click','a[data-w2p_method]',function(e){web2py.a_handler($(this),e);});el.on('ajax:success','a[data-w2p_method][data-w2p_remove]',function(e){var el=$(this);var toremove=el.data('w2p_remove');if(toremove!=undefined){toremove=el.closest(toremove);if(!toremove.length){toremove=$(toremove);}
toremove.remove();}});el.on('ajax:beforeSend','a[data-w2p_method][data-w2p_disable_with]',function(e){web2py.disableElement($(this));});el.on('ajax:complete','a[data-w2p_method][data-w2p_disable_with]',function(e){web2py.enableElement($(this));});},disableFormElements:function(form){form.find(web2py.disableSelector).each(function(){var element=$(this),method=element.is('button')?'html':'val';var disable_with=element.data('w2p_disable_with');if(disable_with==undefined){element.data('w2p_disable_with',element[method]())}
element.data('w2p:enable-with',element[method]());element[method](element.data('w2p_disable_with'));element.prop('disabled',true);});},enableFormElements:function(form){form.find(web2py.enableSelector).each(function(){var element=$(this),method=element.is('button')?'html':'val';if(element.data('w2p:enable-with'))element[method](element.data('w2p:enable-with'));element.prop('disabled',false);});},form_handlers:function(){var el=$(document);el.on('ajax:beforeSend','form[data-w2p_target]',function(e){web2py.disableFormElements($(this));});el.on('ajax:complete','form[data-w2p_target]',function(e){web2py.enableFormElements($(this));});}}
$(function(){var flash=$('.flash');flash.hide();if(flash.html())web2py.flash(flash.html());web2py.ajax_init(document);web2py.event_handlers();web2py.a_handlers();web2py.form_handlers();});})(jQuery);ajax=$.web2py.ajax;web2py_component=$.web2py.component;web2py_websocket=$.web2py.websocket;web2py_ajax_page=$.web2py.ajax_page;web2py_validate_entropy=$.web2py.validate_entropy;web2py_ajax_fields=$.web2py.ajax_fields;web2py_trap_form=$.web2py.trap_form;popup=$.web2py.popup;collapse=$.web2py.collapse;fade=$.web2py.fade;